{"version":3,"file":"index.js","sources":["../src/decorateFindReplace.ts","../src/createFindReplacePlugin.ts"],"sourcesContent":["import {\n  DecorateEntry,\n  isText,\n  PlateEditor,\n  Value,\n  WithPlatePlugin,\n} from '@udecode/plate-common';\nimport { Range } from 'slate';\nimport { FindReplacePlugin } from './types';\n\nexport const decorateFindReplace = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  { key, type }: WithPlatePlugin<FindReplacePlugin, V, E>\n): DecorateEntry => ([node, path]) => {\n  const ranges: SearchRange[] = [];\n\n  const { search } = editor.pluginsByKey[key].options as FindReplacePlugin;\n  if (!search || !isText(node)) {\n    return ranges;\n  }\n\n  const { text } = node;\n  const parts = text.toLowerCase().split(search.toLowerCase());\n  let offset = 0;\n  parts.forEach((part, i) => {\n    if (i !== 0) {\n      ranges.push({\n        anchor: { path, offset: offset - search.length },\n        focus: { path, offset },\n        search,\n        [type]: true,\n      });\n    }\n    offset = offset + part.length + search.length;\n  });\n\n  return ranges;\n};\n\ntype SearchRange = Range & {\n  search: string;\n};\n","import { createPluginFactory } from '@udecode/plate-common';\nimport { decorateFindReplace } from './decorateFindReplace';\nimport { FindReplacePlugin } from './types';\n\nexport const MARK_SEARCH_HIGHLIGHT = 'search_highlight';\n\nexport const createFindReplacePlugin = createPluginFactory<FindReplacePlugin>({\n  key: MARK_SEARCH_HIGHLIGHT,\n  isLeaf: true,\n  decorate: decorateFindReplace,\n});\n"],"names":["decorateFindReplace","editor","key","type","node","path","ranges","search","pluginsByKey","options","isText","text","parts","toLowerCase","split","offset","forEach","part","i","push","anchor","length","focus","MARK_SEARCH_HIGHLIGHT","createFindReplacePlugin","createPluginFactory","isLeaf","decorate"],"mappings":";;;;;;AAUaA,MAAAA,mBAAmB,GAAG,CAIjCC,MAJiC,EAKjC;EAAEC,GAAF;AAAOC,EAAAA,IAAAA;AAAP,CALiC,KAMf,CAAC,CAACC,IAAD,EAAOC,IAAP,CAAD,KAAkB;EACpC,MAAMC,MAAqB,GAAG,EAA9B,CAAA;EAEA,MAAM;AAAEC,IAAAA,MAAAA;AAAF,GAAA,GAAaN,MAAM,CAACO,YAAP,CAAoBN,GAApB,EAAyBO,OAA5C,CAAA;;EACA,IAAI,CAACF,MAAD,IAAW,CAACG,kBAAM,CAACN,IAAD,CAAtB,EAA8B;AAC5B,IAAA,OAAOE,MAAP,CAAA;AACD,GAAA;;EAED,MAAM;AAAEK,IAAAA,IAAAA;AAAF,GAAA,GAAWP,IAAjB,CAAA;AACA,EAAA,MAAMQ,KAAK,GAAGD,IAAI,CAACE,WAAL,EAAA,CAAmBC,KAAnB,CAAyBP,MAAM,CAACM,WAAP,EAAzB,CAAd,CAAA;EACA,IAAIE,MAAM,GAAG,CAAb,CAAA;AACAH,EAAAA,KAAK,CAACI,OAAN,CAAc,CAACC,IAAD,EAAOC,CAAP,KAAa;IACzB,IAAIA,CAAC,KAAK,CAAV,EAAa;MACXZ,MAAM,CAACa,IAAP,CAAY;AACVC,QAAAA,MAAM,EAAE;UAAEf,IAAF;AAAQU,UAAAA,MAAM,EAAEA,MAAM,GAAGR,MAAM,CAACc,MAAAA;SAD9B;AAEVC,QAAAA,KAAK,EAAE;UAAEjB,IAAF;AAAQU,UAAAA,MAAAA;SAFL;QAGVR,MAHU;AAIV,QAAA,CAACJ,IAAD,GAAQ,IAAA;OAJV,CAAA,CAAA;AAMD,KAAA;;IACDY,MAAM,GAAGA,MAAM,GAAGE,IAAI,CAACI,MAAd,GAAuBd,MAAM,CAACc,MAAvC,CAAA;GATF,CAAA,CAAA;AAYA,EAAA,OAAOf,MAAP,CAAA;AACD;;ACpCM,MAAMiB,qBAAqB,GAAG,mBAA9B;AAEMC,MAAAA,uBAAuB,GAAGC,+BAAmB,CAAoB;AAC5EvB,EAAAA,GAAG,EAAEqB,qBADuE;AAE5EG,EAAAA,MAAM,EAAE,IAFoE;AAG5EC,EAAAA,QAAQ,EAAE3B,mBAAAA;AAHkE,CAApB;;;;;;"}
{"version":3,"file":"index.js","sources":["../src/combobox.store.ts","../src/utils/getTextFromTrigger.ts","../src/onChangeCombobox.ts","../../../../node_modules/is-hotkey/lib/index.js","../src/utils/getNextNonDisabledIndex.ts","../src/utils/getNextWrappingIndex.ts","../src/onKeyDownCombobox.ts","../src/createComboboxPlugin.ts","../src/hooks/useComboboxControls.ts"],"sourcesContent":["import { createStore, StateActions, StoreApi } from '@udecode/plate-common';\nimport { UseVirtualFloatingOptions } from '@udecode/plate-floating';\nimport { Range } from 'slate';\nimport { ComboboxOnSelectItem, NoData, TComboboxItem } from './types';\n\nexport type ComboboxStateById<TData = NoData> = {\n  /**\n   * Combobox id.\n   */\n  id: string;\n\n  /**\n   * Items filter function by text.\n   * @default (value) => value.text.toLowerCase().startsWith(search.toLowerCase())\n   */\n  filter?: (search: string) => (item: TComboboxItem<TData>) => boolean;\n\n  /**\n   * Sort filtered items before applying maxSuggestions.\n   */\n  sort?: (\n    search: string\n  ) => (a: TComboboxItem<TData>, b: TComboboxItem<TData>) => number;\n\n  /**\n   * Max number of items.\n   * @default items.length\n   */\n  maxSuggestions?: number;\n\n  /**\n   * Trigger that activates the combobox.\n   */\n  trigger: string;\n\n  /**\n   * Regular expression for search, for example to allow whitespace\n   */\n  searchPattern?: string;\n\n  /**\n   * Called when an item is selected.\n   */\n  onSelectItem: ComboboxOnSelectItem<TData> | null;\n\n  /**\n   * Is opening/closing the combobox controlled by the client.\n   */\n  controlled?: boolean;\n};\n\nexport type ComboboxStoreById<TData = NoData> = StoreApi<\n  string,\n  ComboboxStateById<TData>,\n  StateActions<ComboboxStateById<TData>>\n>;\n\nexport type ComboboxState<TData = NoData> = {\n  /**\n   * Active id (combobox id which is opened).\n   */\n  activeId: string | null;\n\n  /**\n   * Object whose keys are combobox ids and values are config stores\n   * (e.g. one for tag, one for mention,...).\n   */\n  byId: Record<string, ComboboxStoreById>;\n\n  /**\n   * Unfiltered items.\n   */\n  items: TComboboxItem<TData>[];\n\n  /**\n   * Filtered items\n   */\n  filteredItems: TComboboxItem<TData>[];\n\n  /**\n   * Highlighted index.\n   */\n  highlightedIndex: number;\n\n  /**\n   * Overrides `useFloating` options.\n   */\n  floatingOptions: Partial<UseVirtualFloatingOptions>;\n\n  /**\n   * Range from the trigger to the cursor.\n   */\n  targetRange: Range | null;\n\n  /**\n   * Text after the trigger.\n   */\n  text: string | null;\n};\n\nconst createComboboxStore = (state: ComboboxStateById) =>\n  createStore(`combobox-${state.id}`)(state);\n\nexport const comboboxStore = createStore('combobox')<ComboboxState>({\n  activeId: null,\n  byId: {},\n  floatingOptions: {},\n  highlightedIndex: 0,\n  items: [],\n  filteredItems: [],\n  targetRange: null,\n  text: null,\n})\n  .extendActions((set, get) => ({\n    setComboboxById: <TData = NoData>(state: ComboboxStateById<TData>) => {\n      if (get.byId()[state.id]) return;\n\n      set.state((draft) => {\n        draft.byId[state.id] = createComboboxStore(\n          (state as unknown) as ComboboxStateById\n        );\n      });\n    },\n    open: (state: Pick<ComboboxState, 'activeId' | 'targetRange' | 'text'>) => {\n      set.mergeState(state);\n    },\n    reset: () => {\n      set.state((draft) => {\n        draft.activeId = null;\n        draft.highlightedIndex = 0;\n        draft.filteredItems = [];\n        draft.items = [];\n        draft.text = null;\n        draft.targetRange = null;\n      });\n    },\n  }))\n  .extendSelectors((state) => ({\n    isOpen: () => !!state.activeId,\n  }));\n\nexport const useComboboxSelectors = comboboxStore.use;\nexport const comboboxSelectors = comboboxStore.get;\nexport const comboboxActions = comboboxStore.set;\n\nexport const getComboboxStoreById = (id: string | null) =>\n  id ? comboboxSelectors.byId()[id] : null;\n\nexport const useActiveComboboxStore = () => {\n  const activeId = useComboboxSelectors.activeId();\n  const comboboxes = useComboboxSelectors.byId();\n\n  return activeId ? comboboxes[activeId] : null;\n};\n","import {\n  escapeRegExp,\n  getEditorString,\n  getPointBefore,\n  getRange,\n  TEditor,\n  Value,\n} from '@udecode/plate-common';\nimport { Point } from 'slate';\n\n/**\n * Get text and range from trigger to cursor.\n * Starts with trigger and ends with non-whitespace character.\n */\nexport const getTextFromTrigger = <V extends Value>(\n  editor: TEditor<V>,\n  {\n    at,\n    trigger,\n    searchPattern = `\\\\S+`,\n  }: { at: Point; trigger: string; searchPattern?: string }\n) => {\n  const escapedTrigger = escapeRegExp(trigger);\n  const triggerRegex = new RegExp(`(?:^|\\\\s)${escapedTrigger}`);\n\n  let start: Point | undefined = at;\n  let end: Point | undefined;\n\n  while (true) {\n    end = start;\n\n    if (!start) break;\n\n    start = getPointBefore(editor, start);\n    const charRange = start && getRange(editor, start, end);\n    const charText = getEditorString(editor, charRange);\n\n    if (!charText.match(searchPattern)) {\n      start = end;\n      break;\n    }\n  }\n\n  // Range from start to cursor\n  const range = start && getRange(editor, start, at);\n  const text = getEditorString(editor, range);\n\n  if (!range || !text.match(triggerRegex)) return;\n\n  return {\n    range,\n    textAfterTrigger: text.substring(trigger.length),\n  };\n};\n\n// export const matchesTriggerAndPattern = (\n//   editor: TEditor<V>,\n//   { at, trigger, pattern }: { at: Point; trigger: string; pattern: string }\n// ) => {\n//   // Point at the start of line\n//   const lineStart = getPointBefore(editor, at, { unit: 'line' });\n//\n//   // Range from before to start\n//   const beforeRange = lineStart && getRange(editor, lineStart, at);\n//\n//   // Before text\n//   const beforeText = getEditorString(editor, beforeRange);\n//\n//   // Starts with char and ends with word characters\n//   const escapedTrigger = escapeRegExp(trigger);\n//\n//   const beforeRegex = new RegExp(`(?:^|\\\\s)${escapedTrigger}(${pattern})$`);\n//\n//   // Match regex on before text\n//   const match = !!beforeText && beforeText.match(beforeRegex);\n//\n//   // Point at the start of mention\n//   const mentionStart = match\n//     ? getPointBefore(editor, at, {\n//         unit: 'character',\n//         distance: match[1].length + trigger.length,\n//       })\n//     : null;\n//\n//   // Range from mention to start\n//   const mentionRange = mentionStart && getRange(editor, mentionStart, at);\n//\n//   return {\n//     range: mentionRange,\n//     match,\n//   };\n// };\n","import { isCollapsed, PlateEditor, Value } from '@udecode/plate-common';\nimport { Range } from 'slate';\nimport { getTextFromTrigger } from './utils/getTextFromTrigger';\nimport { comboboxActions, comboboxSelectors } from './combobox.store';\n\n/**\n * For each combobox state (byId):\n * - if the selection is collapsed\n * - if the cursor follows the trigger\n * - if there is text without whitespaces after the trigger\n * - open the combobox: set id, search, targetRange in the store\n * Close the combobox if needed\n */\nexport const onChangeCombobox = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E\n) => () => {\n  const byId = comboboxSelectors.byId();\n  const activeId = comboboxSelectors.activeId();\n\n  let shouldClose = true;\n\n  for (const store of Object.values(byId)) {\n    const id = store.get.id();\n    const controlled = store.get.controlled?.();\n\n    if (controlled) {\n      // do not close controlled comboboxes\n      if (activeId === id) {\n        shouldClose = false;\n        break;\n      } else {\n        // do not open controlled comboboxes\n        continue;\n      }\n    }\n\n    const { selection } = editor;\n    if (!selection || !isCollapsed(selection)) {\n      continue;\n    }\n\n    const trigger = store.get.trigger();\n    const searchPattern = store.get.searchPattern?.();\n\n    const isCursorAfterTrigger = getTextFromTrigger(editor, {\n      at: Range.start(selection),\n      trigger,\n      searchPattern,\n    });\n    if (!isCursorAfterTrigger) {\n      continue;\n    }\n\n    const { range, textAfterTrigger } = isCursorAfterTrigger;\n\n    comboboxActions.open({\n      activeId: id,\n      text: textAfterTrigger,\n      targetRange: range,\n    });\n\n    shouldClose = false;\n    break;\n  }\n\n  if (shouldClose && comboboxSelectors.isOpen()) {\n    comboboxActions.reset();\n  }\n};\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n/**\n * Constants.\n */\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar IS_MAC = () => typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);\n\nvar MODIFIERS = {\n  alt: 'altKey',\n  control: 'ctrlKey',\n  meta: 'metaKey',\n  shift: 'shiftKey'\n};\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar ALIASES = () => ({\n  add: '+',\n  break: 'pause',\n  cmd: 'meta',\n  command: 'meta',\n  ctl: 'control',\n  ctrl: 'control',\n  del: 'delete',\n  down: 'arrowdown',\n  esc: 'escape',\n  ins: 'insert',\n  left: 'arrowleft',\n  mod: IS_MAC() ? 'meta' : 'control',\n  opt: 'alt',\n  option: 'alt',\n  return: 'enter',\n  right: 'arrowright',\n  space: ' ',\n  spacebar: ' ',\n  up: 'arrowup',\n  win: 'meta',\n  windows: 'meta'\n});\n\nvar CODES = {\n  backspace: 8,\n  tab: 9,\n  enter: 13,\n  shift: 16,\n  control: 17,\n  alt: 18,\n  pause: 19,\n  capslock: 20,\n  escape: 27,\n  ' ': 32,\n  pageup: 33,\n  pagedown: 34,\n  end: 35,\n  home: 36,\n  arrowleft: 37,\n  arrowup: 38,\n  arrowright: 39,\n  arrowdown: 40,\n  insert: 45,\n  delete: 46,\n  meta: 91,\n  numlock: 144,\n  scrolllock: 145,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  '\\'': 222\n};\n\nfor (var f = 1; f < 20; f++) {\n  CODES['f' + f] = 111 + f;\n}\n\n/**\n * Is hotkey?\n */\n\nfunction isHotkey(hotkey, options, event) {\n  if (options && !('byKey' in options)) {\n    event = options;\n    options = null;\n  }\n\n  if (!Array.isArray(hotkey)) {\n    hotkey = [hotkey];\n  }\n\n  var array = hotkey.map(function (string) {\n    return parseHotkey(string, options);\n  });\n  var check = function check(e) {\n    return array.some(function (object) {\n      return compareHotkey(object, e);\n    });\n  };\n  var ret = event == null ? check : check(event);\n  return ret;\n}\n\nfunction isCodeHotkey(hotkey, event) {\n  return isHotkey(hotkey, event);\n}\n\nfunction isKeyHotkey(hotkey, event) {\n  return isHotkey(hotkey, { byKey: true }, event);\n}\n\n/**\n * Parse.\n */\n\nfunction parseHotkey(hotkey, options) {\n  var byKey = options && options.byKey;\n  var ret = {};\n\n  // Special case to handle the `+` key since we use it as a separator.\n  hotkey = hotkey.replace('++', '+add');\n  var values = hotkey.split('+');\n  var length = values.length;\n\n  // Ensure that all the modifiers are set to false unless the hotkey has them.\n\n  for (var k in MODIFIERS) {\n    ret[MODIFIERS[k]] = false;\n  }\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = values[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var value = _step.value;\n\n      var optional = value.endsWith('?') && value.length > 1;\n\n      if (optional) {\n        value = value.slice(0, -1);\n      }\n\n      var name = toKeyName(value);\n      var modifier = MODIFIERS[name];\n\n      if (length === 1 || !modifier) {\n        if (byKey) {\n          ret.key = name;\n        } else {\n          ret.which = toKeyCode(value);\n        }\n      }\n\n      if (modifier) {\n        ret[modifier] = optional ? null : true;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return ret;\n}\n\n/**\n * Compare.\n */\n\nfunction compareHotkey(object, event) {\n  for (var key in object) {\n    var expected = object[key];\n    var actual = void 0;\n\n    if (expected == null) {\n      continue;\n    }\n\n    if (key === 'key' && event.key != null) {\n      actual = event.key.toLowerCase();\n    } else if (key === 'which') {\n      actual = expected === 91 && event.which === 93 ? 91 : event.which;\n    } else {\n      actual = event[key];\n    }\n\n    if (actual == null && expected === false) {\n      continue;\n    }\n\n    if (actual !== expected) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Utils.\n */\n\nfunction toKeyCode(name) {\n  name = toKeyName(name);\n  var code = CODES[name] || name.toUpperCase().charCodeAt(0);\n  return code;\n}\n\nfunction toKeyName(name) {\n  name = name.toLowerCase();\n  name = ALIASES()[name] || name;\n  return name;\n}\n\n/**\n * Export.\n */\n\nexports.default = isHotkey;\nexports.isHotkey = isHotkey;\nexports.isCodeHotkey = isCodeHotkey;\nexports.isKeyHotkey = isKeyHotkey;\nexports.parseHotkey = parseHotkey;\nexports.compareHotkey = compareHotkey;\nexports.toKeyCode = toKeyCode;\nexports.toKeyName = toKeyName;","/**\n * Returns the next index in the list of an item that is not disabled.\n *\n * @param {number} moveAmount Number of positions to move. Negative to move backwards, positive forwards.\n * @param {number} baseIndex The initial position to move from.\n * @param {number} itemCount The total number of items.\n * @param {Function} getItemNodeFromIndex Used to check if item is disabled.\n * @param {boolean} circular Specify if navigation is circular. Default is true.\n * @returns {number} The new index. Returns baseIndex if item is not disabled. Returns next non-disabled item otherwise. If no non-disabled found it will return -1.\n */\nexport const getNextNonDisabledIndex = (\n  moveAmount: number,\n  baseIndex: number,\n  itemCount: number,\n  getItemNodeFromIndex: any,\n  circular: boolean\n): number => {\n  const currentElementNode = getItemNodeFromIndex(baseIndex);\n  if (!currentElementNode || !currentElementNode.hasAttribute('disabled')) {\n    return baseIndex;\n  }\n\n  if (moveAmount > 0) {\n    for (let index = baseIndex + 1; index < itemCount; index++) {\n      if (!getItemNodeFromIndex(index).hasAttribute('disabled')) {\n        return index;\n      }\n    }\n  } else {\n    for (let index = baseIndex - 1; index >= 0; index--) {\n      if (!getItemNodeFromIndex(index).hasAttribute('disabled')) {\n        return index;\n      }\n    }\n  }\n\n  if (circular) {\n    return moveAmount > 0\n      ? getNextNonDisabledIndex(1, 0, itemCount, getItemNodeFromIndex, false)\n      : getNextNonDisabledIndex(\n          -1,\n          itemCount - 1,\n          itemCount,\n          getItemNodeFromIndex,\n          false\n        );\n  }\n\n  return -1;\n};\n","import { getNextNonDisabledIndex } from './getNextNonDisabledIndex';\n\n/**\n * Returns the new index in the list, in a circular way. If next value is out of bonds from the total,\n * it will wrap to either 0 or itemCount - 1.\n *\n * @param {number} moveAmount Number of positions to move. Negative to move backwards, positive forwards.\n * @param {number} baseIndex The initial position to move from.\n * @param {number} itemCount The total number of items.\n * @param {Function} getItemNodeFromIndex Used to check if item is disabled.\n * @param {boolean} circular Specify if navigation is circular. Default is true.\n * @returns {number} The new index after the move.\n */\nexport const getNextWrappingIndex = (\n  moveAmount: number,\n  baseIndex: number,\n  itemCount: number,\n  getItemNodeFromIndex: any,\n  circular = true\n) => {\n  if (itemCount === 0) {\n    return -1;\n  }\n\n  const itemsLastIndex = itemCount - 1;\n\n  // noinspection SuspiciousTypeOfGuard\n  if (\n    typeof baseIndex !== 'number' ||\n    baseIndex < 0 ||\n    baseIndex >= itemCount\n  ) {\n    baseIndex = moveAmount > 0 ? -1 : itemsLastIndex + 1;\n  }\n\n  let newIndex = baseIndex + moveAmount;\n\n  if (newIndex < 0) {\n    newIndex = circular ? itemsLastIndex : 0;\n  } else if (newIndex > itemsLastIndex) {\n    newIndex = circular ? 0 : itemsLastIndex;\n  }\n\n  const nonDisabledNewIndex = getNextNonDisabledIndex(\n    moveAmount,\n    newIndex,\n    itemCount,\n    getItemNodeFromIndex,\n    circular\n  );\n\n  if (nonDisabledNewIndex === -1) {\n    return baseIndex >= itemCount ? -1 : baseIndex;\n  }\n\n  return nonDisabledNewIndex;\n};\n","import {\n  Hotkeys,\n  KeyboardHandlerReturnType,\n  PlateEditor,\n  Value,\n} from '@udecode/plate-common';\nimport isHotkey from 'is-hotkey';\nimport { getNextWrappingIndex } from './utils/getNextWrappingIndex';\nimport {\n  comboboxActions,\n  comboboxSelectors,\n  getComboboxStoreById,\n} from './combobox.store';\n\n/**\n * If the combobox is open, handle:\n * - down (next item)\n * - up (previous item)\n * - escape (reset combobox)\n * - tab, enter (select item)\n */\nexport const onKeyDownCombobox = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E\n): KeyboardHandlerReturnType => (event) => {\n  const {\n    highlightedIndex,\n    filteredItems,\n    activeId,\n  } = comboboxSelectors.state();\n  const isOpen = comboboxSelectors.isOpen();\n\n  if (!isOpen) return;\n\n  const store = getComboboxStoreById(activeId);\n  if (!store) return;\n\n  const onSelectItem = store.get.onSelectItem();\n\n  if (isHotkey('down', event)) {\n    event.preventDefault();\n\n    const newIndex = getNextWrappingIndex(\n      1,\n      highlightedIndex,\n      filteredItems.length,\n      () => {},\n      true\n    );\n    comboboxActions.highlightedIndex(newIndex);\n    return;\n  }\n  if (isHotkey('up', event)) {\n    event.preventDefault();\n\n    const newIndex = getNextWrappingIndex(\n      -1,\n      highlightedIndex,\n      filteredItems.length,\n      () => {},\n      true\n    );\n    comboboxActions.highlightedIndex(newIndex);\n    return;\n  }\n  if (isHotkey('escape', event)) {\n    event.preventDefault();\n    comboboxActions.reset();\n    return;\n  }\n\n  if (Hotkeys.isTab(editor, event) || isHotkey('enter', event)) {\n    event.preventDefault();\n    event.stopPropagation();\n    if (filteredItems[highlightedIndex]) {\n      onSelectItem?.(editor, filteredItems[highlightedIndex]);\n    }\n  }\n};\n","import { createPluginFactory } from '@udecode/plate-common';\nimport { onChangeCombobox } from './onChangeCombobox';\nimport { onKeyDownCombobox } from './onKeyDownCombobox';\n\nexport const KEY_COMBOBOX = 'combobox';\n\nexport const createComboboxPlugin = createPluginFactory({\n  key: KEY_COMBOBOX,\n  handlers: {\n    onChange: onChangeCombobox,\n    onKeyDown: onKeyDownCombobox,\n  },\n});\n","import { useMemo } from 'react';\nimport { useCombobox } from 'downshift';\nimport { useComboboxSelectors } from '../combobox.store';\n\nexport const useComboboxControls = () => {\n  const isOpen = useComboboxSelectors.isOpen();\n  const highlightedIndex = useComboboxSelectors.highlightedIndex();\n  const filteredItems = useComboboxSelectors.filteredItems();\n\n  const {\n    closeMenu,\n    getMenuProps,\n    getComboboxProps,\n    getInputProps,\n    getItemProps,\n  } = useCombobox({\n    isOpen,\n    highlightedIndex,\n    items: filteredItems,\n    circularNavigation: true,\n  });\n  getMenuProps({}, { suppressRefError: true });\n  getComboboxProps({}, { suppressRefError: true });\n  getInputProps({}, { suppressRefError: true });\n\n  return useMemo(\n    () => ({\n      closeMenu,\n      getMenuProps,\n      getItemProps,\n    }),\n    [closeMenu, getItemProps, getMenuProps]\n  );\n};\n"],"names":["createComboboxStore","state","createStore","id","comboboxStore","activeId","byId","floatingOptions","highlightedIndex","items","filteredItems","targetRange","text","extendActions","set","get","setComboboxById","draft","open","mergeState","reset","extendSelectors","isOpen","useComboboxSelectors","use","comboboxSelectors","comboboxActions","getComboboxStoreById","useActiveComboboxStore","comboboxes","getTextFromTrigger","editor","at","trigger","searchPattern","escapedTrigger","escapeRegExp","triggerRegex","RegExp","start","end","getPointBefore","charRange","getRange","charText","getEditorString","match","range","textAfterTrigger","substring","length","onChangeCombobox","shouldClose","store","Object","values","controlled","selection","isCollapsed","isCursorAfterTrigger","Range","getNextNonDisabledIndex","moveAmount","baseIndex","itemCount","getItemNodeFromIndex","circular","currentElementNode","hasAttribute","index","getNextWrappingIndex","itemsLastIndex","newIndex","nonDisabledNewIndex","onKeyDownCombobox","event","onSelectItem","isHotkey","preventDefault","Hotkeys","isTab","stopPropagation","KEY_COMBOBOX","createComboboxPlugin","createPluginFactory","key","handlers","onChange","onKeyDown","useComboboxControls","closeMenu","getMenuProps","getComboboxProps","getInputProps","getItemProps","useCombobox","circularNavigation","suppressRefError","useMemo"],"mappings":"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"}
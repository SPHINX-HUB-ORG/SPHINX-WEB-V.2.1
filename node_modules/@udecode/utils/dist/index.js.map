{"version":3,"file":"index.js","sources":["../src/environment.ts","../src/escapeRegexp.ts","../src/findHtmlParentElement.ts","../src/getHandler.ts","../src/hexToBase64.ts","../src/isUrl.ts","../src/mergeProps.ts","../src/sanitizeUrl.ts","../src/type-utils.ts"],"sourcesContent":["export const IS_APPLE =\n  typeof navigator !== 'undefined' && /Mac OS X/.test(navigator.userAgent);\n","export const escapeRegExp = (text: string) => {\n  return text.replace(/[-[\\]{}()*+?.,\\\\^$|#\\\\s]/g, '\\\\$&');\n};\n","export const findHtmlParentElement = (\n  el: HTMLElement | null,\n  nodeName: string\n): HTMLElement | null => {\n  if (!el || el.nodeName === nodeName) {\n    return el;\n  }\n\n  return findHtmlParentElement(el.parentElement, nodeName);\n};\n","/**\n * Call a handler if defined\n */\nexport const getHandler = <T extends (...args: any) => any>(\n  cb?: T,\n  ...args: Parameters<T>\n) => () => {\n  cb?.(...(args as any));\n};\n","export const hexToBase64 = (hex: string): string => {\n  const hexPairs = hex.match(/\\w{2}/g) || [];\n  const binary = hexPairs.map((hexPair) =>\n    String.fromCharCode(parseInt(hexPair, 16))\n  );\n  return btoa(binary.join(''));\n};\n","/**\n * RegExps.\n * A URL must match #1 and then at least one of #2/#3.\n * Use two levels of REs to avoid REDOS.\n */\n\nconst protocolAndDomainRE = /^(?:\\w+:)?\\/\\/(\\S+)$/;\nconst emailLintRE = /mailto:([^\\\\?]+)/;\n\nconst localhostDomainRE = /^localhost[:?\\d]*(?:[^:?\\d]\\S*)?$/;\nconst nonLocalhostDomainRE = /^[^\\s.]+\\.\\S{2,}$/;\n\n/**\n * Loosely validate a URL `string`.\n */\nexport const isUrl = (string: any) => {\n  if (typeof string !== 'string') {\n    return false;\n  }\n\n  const generalMatch = string.match(protocolAndDomainRE);\n  const emailLinkMatch = string.match(emailLintRE);\n\n  const match = generalMatch || emailLinkMatch;\n  if (!match) {\n    return false;\n  }\n\n  const everythingAfterProtocol = match[1];\n  if (!everythingAfterProtocol) {\n    return false;\n  }\n\n  try {\n    new URL(string);\n  } catch (err) {\n    return false;\n  }\n\n  return (\n    localhostDomainRE.test(everythingAfterProtocol) ||\n    nonLocalhostDomainRE.test(everythingAfterProtocol)\n  );\n};\n","/**\n * Merge props by composing handlers.\n */\nexport const mergeProps = <T>(\n  props?: T,\n  overrideProps?: T,\n  {\n    handlerKeys,\n    handlerQuery = (key) => key.indexOf('on') === 0,\n  }: {\n    /**\n     * The keys of the handlers to merge.\n     */\n    handlerKeys?: string[];\n    /**\n     * A function that returns true if it's a handler to merge.\n     *\n     * Default: keys having `on` prefix.\n     */\n    handlerQuery?: ((key: string) => boolean) | null;\n  } = {}\n): T => {\n  const map = new Map<string, Array<(...args: unknown[]) => void>>();\n\n  const acc: any = {};\n\n  const mapProps = (_props?: T) => {\n    if (!_props) return;\n\n    Object.entries(_props).forEach(([key, value]) => {\n      if (\n        (!handlerKeys || handlerKeys.includes(key)) &&\n        (!handlerQuery || handlerQuery(key)) &&\n        typeof value === 'function'\n      ) {\n        if (!map.has(key)) {\n          map.set(key, []);\n        }\n\n        map.get(key)?.push(value);\n\n        acc[key] = (...args: unknown[]) => {\n          map.get(key)?.forEach((fn) => fn(...args));\n        };\n      } else {\n        acc[key] = value;\n      }\n    });\n  };\n\n  mapProps(props);\n  mapProps(overrideProps);\n\n  return acc;\n};\n","export interface SanitizeUrlOptions {\n  allowedSchemes?: string[];\n  permitInvalid?: boolean;\n}\n\nexport const sanitizeUrl = (\n  url: string | undefined,\n  { allowedSchemes, permitInvalid = false }: SanitizeUrlOptions\n): string | null => {\n  if (!url) return null;\n\n  let parsedUrl: URL | null = null;\n\n  try {\n    parsedUrl = new URL(url);\n  } catch (error) {\n    return permitInvalid ? url : null;\n  }\n\n  if (\n    allowedSchemes &&\n    !allowedSchemes.includes(parsedUrl.protocol.slice(0, -1))\n  ) {\n    return null;\n  }\n\n  return parsedUrl.href;\n};\n","/**\n * @returns whether the provided parameter is undefined.\n */\nexport const isUndefined = (obj: any): obj is undefined =>\n  typeof obj === 'undefined';\n\nexport const isNull = (obj: any): obj is null => obj === null;\n\n/**\n * @returns whether the provided parameter is undefined or null.\n */\nexport const isUndefinedOrNull = (obj: any): obj is undefined | null =>\n  isUndefined(obj) || isNull(obj);\n\n/**\n * @returns whether the provided parameter is defined.\n */\nexport const isDefined = <T>(arg: T | null | undefined): arg is T =>\n  !isUndefinedOrNull(arg);\n"],"names":["IS_APPLE","navigator","test","userAgent","escapeRegExp","text","replace","findHtmlParentElement","el","nodeName","parentElement","getHandler","cb","args","hexToBase64","hex","hexPairs","match","binary","map","hexPair","String","fromCharCode","parseInt","btoa","join","protocolAndDomainRE","emailLintRE","localhostDomainRE","nonLocalhostDomainRE","isUrl","string","generalMatch","emailLinkMatch","everythingAfterProtocol","URL","err","mergeProps","props","overrideProps","handlerKeys","handlerQuery","key","indexOf","Map","acc","mapProps","_props","Object","entries","forEach","value","includes","has","set","get","push","fn","sanitizeUrl","url","allowedSchemes","permitInvalid","parsedUrl","error","protocol","slice","href","isUndefined","obj","isNull","isUndefinedOrNull","isDefined","arg"],"mappings":"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"}
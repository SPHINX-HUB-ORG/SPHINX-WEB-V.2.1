{"version":3,"file":"index.js","sources":["../src/caption/captionGlobalStore.ts","../../../node_modules/is-hotkey/lib/index.js","../src/caption/getOnKeyDownCaption.ts","../src/caption/getWithSelectionCaption.ts","../src/resizable/resizableStore.ts","../src/caption/hooks/useCaptionString.ts","../src/caption/components/TextareaAutosize.tsx","../src/caption/components/CaptionTextarea.tsx","../src/caption/components/Caption.tsx","../src/image/transforms/insertImage.ts","../src/image/utils/isImageUrl.ts","../src/image/withImageEmbed.ts","../src/image/withImageUpload.ts","../src/image/withImage.ts","../src/image/createImagePlugin.ts","../src/image/components/Image.tsx","../src/twitter/parseTwitterUrl.ts","../src/twitter/components/MediaEmbedTweet.tsx","../src/twitter/components/Tweet.tsx","../src/video/parseVideoUrl.ts","../src/video/components/MediaEmbedVideo.tsx","../src/media-embed/parseIframeUrl.ts","../src/media-embed/createMediaEmbedPlugin.ts","../src/media/mediaStore.ts","../src/media-embed/components/MediaEmbed.tsx","../src/media-embed/transforms/insertMediaEmbed.ts","../src/resizable/Resizable.tsx","../src/media/parseMediaUrl.ts","../src/media/Media.tsx","../src/media/types.ts","../src/media/FloatingMedia/floatingMediaStore.ts","../src/media/FloatingMedia/FloatingMediaEditButton.tsx","../src/media/FloatingMedia/submitFloatingMedia.ts","../src/media/FloatingMedia/FloatingMediaUrlInput.tsx","../src/media/FloatingMedia/FloatingMedia.tsx"],"sourcesContent":["import { createStore, TPath } from '@udecode/plate-common';\n\nexport const captionGlobalStore = createStore('caption')({\n  /**\n   * When defined, focus end of caption textarea with the same path.\n   */\n  focusEndCaptionPath: null as TPath | null,\n\n  /**\n   * When defined, focus start of caption textarea with the same path.\n   */\n  focusStartCaptionPath: null as TPath | null,\n});\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n/**\n * Constants.\n */\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar IS_MAC = () => typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);\n\nvar MODIFIERS = {\n  alt: 'altKey',\n  control: 'ctrlKey',\n  meta: 'metaKey',\n  shift: 'shiftKey'\n};\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar ALIASES = () => ({\n  add: '+',\n  break: 'pause',\n  cmd: 'meta',\n  command: 'meta',\n  ctl: 'control',\n  ctrl: 'control',\n  del: 'delete',\n  down: 'arrowdown',\n  esc: 'escape',\n  ins: 'insert',\n  left: 'arrowleft',\n  mod: IS_MAC() ? 'meta' : 'control',\n  opt: 'alt',\n  option: 'alt',\n  return: 'enter',\n  right: 'arrowright',\n  space: ' ',\n  spacebar: ' ',\n  up: 'arrowup',\n  win: 'meta',\n  windows: 'meta'\n});\n\nvar CODES = {\n  backspace: 8,\n  tab: 9,\n  enter: 13,\n  shift: 16,\n  control: 17,\n  alt: 18,\n  pause: 19,\n  capslock: 20,\n  escape: 27,\n  ' ': 32,\n  pageup: 33,\n  pagedown: 34,\n  end: 35,\n  home: 36,\n  arrowleft: 37,\n  arrowup: 38,\n  arrowright: 39,\n  arrowdown: 40,\n  insert: 45,\n  delete: 46,\n  meta: 91,\n  numlock: 144,\n  scrolllock: 145,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  '\\'': 222\n};\n\nfor (var f = 1; f < 20; f++) {\n  CODES['f' + f] = 111 + f;\n}\n\n/**\n * Is hotkey?\n */\n\nfunction isHotkey(hotkey, options, event) {\n  if (options && !('byKey' in options)) {\n    event = options;\n    options = null;\n  }\n\n  if (!Array.isArray(hotkey)) {\n    hotkey = [hotkey];\n  }\n\n  var array = hotkey.map(function (string) {\n    return parseHotkey(string, options);\n  });\n  var check = function check(e) {\n    return array.some(function (object) {\n      return compareHotkey(object, e);\n    });\n  };\n  var ret = event == null ? check : check(event);\n  return ret;\n}\n\nfunction isCodeHotkey(hotkey, event) {\n  return isHotkey(hotkey, event);\n}\n\nfunction isKeyHotkey(hotkey, event) {\n  return isHotkey(hotkey, { byKey: true }, event);\n}\n\n/**\n * Parse.\n */\n\nfunction parseHotkey(hotkey, options) {\n  var byKey = options && options.byKey;\n  var ret = {};\n\n  // Special case to handle the `+` key since we use it as a separator.\n  hotkey = hotkey.replace('++', '+add');\n  var values = hotkey.split('+');\n  var length = values.length;\n\n  // Ensure that all the modifiers are set to false unless the hotkey has them.\n\n  for (var k in MODIFIERS) {\n    ret[MODIFIERS[k]] = false;\n  }\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = values[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var value = _step.value;\n\n      var optional = value.endsWith('?') && value.length > 1;\n\n      if (optional) {\n        value = value.slice(0, -1);\n      }\n\n      var name = toKeyName(value);\n      var modifier = MODIFIERS[name];\n\n      if (length === 1 || !modifier) {\n        if (byKey) {\n          ret.key = name;\n        } else {\n          ret.which = toKeyCode(value);\n        }\n      }\n\n      if (modifier) {\n        ret[modifier] = optional ? null : true;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return ret;\n}\n\n/**\n * Compare.\n */\n\nfunction compareHotkey(object, event) {\n  for (var key in object) {\n    var expected = object[key];\n    var actual = void 0;\n\n    if (expected == null) {\n      continue;\n    }\n\n    if (key === 'key' && event.key != null) {\n      actual = event.key.toLowerCase();\n    } else if (key === 'which') {\n      actual = expected === 91 && event.which === 93 ? 91 : event.which;\n    } else {\n      actual = event[key];\n    }\n\n    if (actual == null && expected === false) {\n      continue;\n    }\n\n    if (actual !== expected) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Utils.\n */\n\nfunction toKeyCode(name) {\n  name = toKeyName(name);\n  var code = CODES[name] || name.toUpperCase().charCodeAt(0);\n  return code;\n}\n\nfunction toKeyName(name) {\n  name = name.toLowerCase();\n  name = ALIASES()[name] || name;\n  return name;\n}\n\n/**\n * Export.\n */\n\nexports.default = isHotkey;\nexports.isHotkey = isHotkey;\nexports.isCodeHotkey = isCodeHotkey;\nexports.isKeyHotkey = isKeyHotkey;\nexports.parseHotkey = parseHotkey;\nexports.compareHotkey = compareHotkey;\nexports.toKeyCode = toKeyCode;\nexports.toKeyName = toKeyName;","import {\n  getBlockAbove,\n  getPluginType,\n  KeyboardHandler,\n} from '@udecode/plate-common';\nimport isHotkey from 'is-hotkey';\nimport { captionGlobalStore } from './captionGlobalStore';\n\nexport const getOnKeyDownCaption = (pluginKey: string): KeyboardHandler => (\n  editor\n) => (e) => {\n  if (e.defaultPrevented) return;\n\n  // focus caption from image\n  if (isHotkey('down', e)) {\n    const entry = getBlockAbove(editor, {\n      match: { type: getPluginType(editor, pluginKey) },\n    });\n    if (!entry) return;\n\n    captionGlobalStore.set.focusEndCaptionPath(entry[1]);\n  }\n};\n","import {\n  getAboveNode,\n  getNodeString,\n  getPluginType,\n  isCollapsed,\n  PlateEditor,\n  Value,\n  WithPlatePlugin,\n} from '@udecode/plate-common';\nimport isHotkey from 'is-hotkey';\nimport { Range } from 'slate';\nimport { ImagePlugin } from '../image/index';\nimport { TMediaElement } from '../media/index';\nimport { captionGlobalStore } from './captionGlobalStore';\n\n/**\n * TODO: tests\n * https://github.com/udecode/editor-protocol/issues/79\n */\n\n/**\n * Selection table:\n * - If anchor is in table, focus in a block before: set focus to start of table\n * - If anchor is in table, focus in a block after: set focus to end of table\n * - If focus is in table, anchor in a block before: set focus to end of table\n * - If focus is in table, anchor in a block after: set focus to the point before start of table\n */\nexport const getWithSelectionCaption = (pluginKey: string) => <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  plugin: WithPlatePlugin<ImagePlugin, V, E>\n) => {\n  const { apply } = editor;\n\n  editor.apply = (operation) => {\n    if (operation.type === 'set_selection') {\n      const newSelection = {\n        ...editor.selection,\n        ...operation.newProperties,\n      } as Range | null;\n\n      if (\n        editor.currentKeyboardEvent &&\n        isHotkey('up', editor.currentKeyboardEvent)\n      ) {\n        if (newSelection && isCollapsed(newSelection)) {\n          const entry = getAboveNode<TMediaElement>(editor, {\n            at: newSelection,\n            match: { type: getPluginType(editor, pluginKey) },\n          });\n\n          if (entry) {\n            const [node] = entry;\n\n            if (\n              node.caption &&\n              getNodeString({ children: node.caption } as any).length\n            ) {\n              setTimeout(() => {\n                captionGlobalStore.set.focusEndCaptionPath(entry[1]);\n              }, 0);\n            }\n          }\n        }\n      }\n    }\n\n    apply(operation);\n  };\n\n  return editor;\n};\n","import { CSSProperties } from 'react';\nimport { createAtomStore, SCOPE_ELEMENT } from '@udecode/plate-common';\n\nexport const { resizableStore, useResizableStore } = createAtomStore(\n  {\n    width: 0 as CSSProperties['width'],\n  },\n  { name: 'resizable', scope: SCOPE_ELEMENT }\n);\n","import { useMemo } from 'react';\nimport { getNodeString, useElement } from '@udecode/plate-common';\nimport { TCaptionElement } from '../types/TCaptionElement';\n\nexport const useCaptionString = () => {\n  const {\n    caption: nodeCaption = [{ children: [{ text: '' }] }],\n  } = useElement<TCaptionElement>();\n\n  return useMemo(() => {\n    return getNodeString(nodeCaption[0] as any) || '';\n  }, [nodeCaption]);\n};\n","import React, { forwardRef, useLayoutEffect, useState } from 'react';\nimport ReactTextareaAutosize, {\n  TextareaAutosizeProps,\n} from 'react-textarea-autosize';\n\n/**\n * `<textarea />` component for React which grows with content.\n * @see https://github.com/Andarist/react-textarea-autosize\n * @see https://github.com/Andarist/react-textarea-autosize/issues/337\n */\nexport const TextareaAutosize = forwardRef<\n  HTMLTextAreaElement,\n  TextareaAutosizeProps\n>((props, ref) => {\n  const [isRerendered, setIsRerendered] = useState(false);\n\n  useLayoutEffect(() => setIsRerendered(true), []);\n\n  return isRerendered ? <ReactTextareaAutosize {...props} ref={ref} /> : null;\n});\n","import React, {\n  RefAttributes,\n  RefObject,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { TextareaAutosizeProps } from 'react-textarea-autosize';\nimport {\n  AsProps,\n  createComponentAs,\n  findNodePath,\n  focusEditor,\n  getNodeString,\n  getPointAfter,\n  setNodes,\n  TElement,\n  useComposedRef,\n  useEditorRef,\n  useElement,\n} from '@udecode/plate-common';\nimport isHotkey from 'is-hotkey';\nimport { Path } from 'slate';\nimport { useReadOnly } from 'slate-react';\nimport { captionGlobalStore } from '../captionGlobalStore';\nimport { TCaptionElement } from '../types/TCaptionElement';\nimport { TextareaAutosize } from './TextareaAutosize';\n\nexport interface CaptionTextareaProps\n  extends TextareaAutosizeProps,\n    RefAttributes<HTMLTextAreaElement>,\n    AsProps<'textarea'> {}\n\n/**\n * Focus textareaRef when focusCaptionPath is set to the image path.\n */\nexport const useCaptionTextareaFocus = (\n  textareaRef: RefObject<HTMLTextAreaElement>\n) => {\n  const editor = useEditorRef();\n  const element = useElement<TCaptionElement>();\n\n  const focusCaptionPath = captionGlobalStore.use.focusEndCaptionPath();\n\n  useEffect(() => {\n    if (focusCaptionPath && textareaRef.current) {\n      const path = findNodePath(editor, element);\n      if (path && Path.equals(path, focusCaptionPath)) {\n        textareaRef.current.focus();\n        captionGlobalStore.set.focusEndCaptionPath(null);\n      }\n    }\n  }, [editor, element, focusCaptionPath, textareaRef]);\n};\n\nexport const useCaptionTextarea = (\n  props: CaptionTextareaProps\n): TextareaAutosizeProps & RefAttributes<HTMLTextAreaElement> => {\n  const element = useElement<TCaptionElement>();\n\n  const {\n    caption: nodeCaption = [{ children: [{ text: '' }] }] as [TElement],\n  } = element;\n\n  const [captionValue, setCaptionValue] = useState<\n    TextareaAutosizeProps['value']\n  >(getNodeString(nodeCaption[0]));\n\n  const editor = useEditorRef();\n  const readOnly = useReadOnly();\n\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n  const ref = useComposedRef(textareaRef, props.ref);\n\n  useCaptionTextareaFocus(textareaRef);\n\n  const onChange: TextareaAutosizeProps['onChange'] = useCallback(\n    (e) => {\n      const newValue = e.target.value;\n\n      // local state\n      setCaptionValue(newValue);\n\n      const path = findNodePath(editor, element);\n      if (!path) return;\n\n      // saved state\n      setNodes<TCaptionElement>(\n        editor,\n        { caption: [{ text: newValue }] },\n        { at: path }\n      );\n    },\n    [editor, element]\n  );\n\n  const onKeyDown: TextareaAutosizeProps['onKeyDown'] = (e) => {\n    // select image\n    if (isHotkey('up', e)) {\n      const path = findNodePath(editor, element);\n      if (!path) return;\n\n      e.preventDefault();\n\n      focusEditor(editor, path);\n    }\n\n    // select next block\n    if (isHotkey('down', e)) {\n      const path = findNodePath(editor, element);\n      if (!path) return;\n\n      const nextNodePath = getPointAfter(editor, path);\n      if (!nextNodePath) return;\n\n      e.preventDefault();\n\n      focusEditor(editor, nextNodePath);\n    }\n  };\n\n  return {\n    value: captionValue,\n    readOnly,\n    onChange,\n    onKeyDown,\n    ...props,\n    ref,\n  };\n};\n\nexport const CaptionTextarea = createComponentAs<CaptionTextareaProps>(\n  ({ as, ...props }) => {\n    const htmlProps = useCaptionTextarea({ as: as as any, ...props });\n\n    return <TextareaAutosize {...htmlProps} />;\n  }\n);\n","import {\n  createComponentAs,\n  createElementAs,\n  HTMLPropsAs,\n} from '@udecode/plate-common';\nimport { useReadOnly, useSelected } from 'slate-react';\nimport { useResizableStore } from '../../resizable/resizableStore';\nimport { useCaptionString } from '../hooks/useCaptionString';\nimport { CaptionTextarea } from './CaptionTextarea';\n\nexport interface CaptionProps extends HTMLPropsAs<'figcaption'> {\n  readOnly?: boolean;\n}\n\nexport const useCaption = ({\n  readOnly,\n  ...props\n}: CaptionProps = {}): HTMLPropsAs<'figcaption'> => {\n  const width = useResizableStore().get.width();\n\n  return {\n    style: { width },\n    ...props,\n  };\n};\n\nexport const useCaptionState = (props: CaptionProps) => {\n  const captionString = useCaptionString();\n\n  const selected = useSelected();\n  const _readOnly = useReadOnly();\n  const readOnly = props.readOnly || _readOnly;\n\n  return {\n    captionString,\n    selected,\n    readOnly,\n  };\n};\n\nexport const CaptionRoot = createComponentAs<CaptionProps>((props) => {\n  const htmlProps = useCaption(props);\n  const { captionString, selected, readOnly } = useCaptionState(props);\n\n  if (!captionString.length && (readOnly || !selected)) {\n    return null;\n  }\n\n  return createElementAs('figcaption', htmlProps);\n});\n\nexport const Caption = {\n  Root: CaptionRoot,\n  Textarea: CaptionTextarea,\n};\n","import {\n  getPluginType,\n  insertNodes,\n  PlateEditor,\n  Value,\n} from '@udecode/plate-common';\nimport { ELEMENT_IMAGE } from '../createImagePlugin';\nimport { TImageElement } from '../types';\n\nexport const insertImage = <V extends Value>(\n  editor: PlateEditor<V>,\n  url: string | ArrayBuffer\n) => {\n  const text = { text: '' };\n  const image: TImageElement = {\n    type: getPluginType(editor, ELEMENT_IMAGE),\n    url: url as any,\n    children: [text],\n  };\n  insertNodes<TImageElement>(editor, image);\n};\n","import { isUrl } from '@udecode/plate-common';\n\nconst imageExtensions = [\n  'ase',\n  'art',\n  'bmp',\n  'blp',\n  'cd5',\n  'cit',\n  'cpt',\n  'cr2',\n  'cut',\n  'dds',\n  'dib',\n  'djvu',\n  'egt',\n  'exif',\n  'gif',\n  'gpl',\n  'grf',\n  'icns',\n  'ico',\n  'iff',\n  'jng',\n  'jpeg',\n  'jpg',\n  'jfif',\n  'jp2',\n  'jps',\n  'lbm',\n  'max',\n  'miff',\n  'mng',\n  'msp',\n  'nitf',\n  'ota',\n  'pbm',\n  'pc1',\n  'pc2',\n  'pc3',\n  'pcf',\n  'pcx',\n  'pdn',\n  'pgm',\n  'PI1',\n  'PI2',\n  'PI3',\n  'pict',\n  'pct',\n  'pnm',\n  'pns',\n  'ppm',\n  'psb',\n  'psd',\n  'pdd',\n  'psp',\n  'px',\n  'pxm',\n  'pxr',\n  'qfx',\n  'raw',\n  'rle',\n  'sct',\n  'sgi',\n  'rgb',\n  'int',\n  'bw',\n  'tga',\n  'tiff',\n  'tif',\n  'vtf',\n  'xbm',\n  'xcf',\n  'xpm',\n  '3dv',\n  'amf',\n  'ai',\n  'awg',\n  'cgm',\n  'cdr',\n  'cmx',\n  'dxf',\n  'e2d',\n  'egt',\n  'eps',\n  'fs',\n  'gbr',\n  'odg',\n  'svg',\n  'stl',\n  'vrml',\n  'x3d',\n  'sxd',\n  'v2d',\n  'vnd',\n  'wmf',\n  'emf',\n  'art',\n  'xar',\n  'png',\n  'webp',\n  'jxr',\n  'hdp',\n  'wdp',\n  'cur',\n  'ecw',\n  'iff',\n  'lbm',\n  'liff',\n  'nrrd',\n  'pam',\n  'pcx',\n  'pgf',\n  'sgi',\n  'rgb',\n  'rgba',\n  'bw',\n  'int',\n  'inta',\n  'sid',\n  'ras',\n  'sun',\n  'tga',\n];\n\nexport const isImageUrl = (url: string) => {\n  if (!isUrl(url)) return false;\n\n  const ext = new URL(url).pathname.split('.').pop() as string;\n\n  return imageExtensions.includes(ext);\n};\n","import { PlateEditor, Value, WithPlatePlugin } from '@udecode/plate-common';\nimport { insertImage } from './transforms/insertImage';\nimport { isImageUrl } from './utils/isImageUrl';\nimport { ImagePlugin } from './types';\n\n/**\n * If inserted text is image url, insert image instead.\n */\nexport const withImageEmbed = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  plugin: WithPlatePlugin<ImagePlugin, V, E>\n) => {\n  const { insertData } = editor;\n\n  editor.insertData = (dataTransfer: DataTransfer) => {\n    const text = dataTransfer.getData('text/plain');\n\n    if (isImageUrl(text)) {\n      insertImage(editor, text);\n      return;\n    }\n\n    insertData(dataTransfer);\n  };\n\n  return editor;\n};\n","import {\n  getInjectedPlugins,\n  pipeInsertDataQuery,\n  PlateEditor,\n  Value,\n  WithPlatePlugin,\n} from '@udecode/plate-common';\nimport { insertImage } from './transforms/insertImage';\nimport { ImagePlugin } from './types';\n\n/**\n * Allows for pasting images from clipboard.\n * Not yet: dragging and dropping images, selecting them through a file system dialog.\n */\nexport const withImageUpload = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  plugin: WithPlatePlugin<ImagePlugin, V, E>\n) => {\n  const {\n    options: { uploadImage },\n  } = plugin;\n  const { insertData } = editor;\n\n  editor.insertData = (dataTransfer: DataTransfer) => {\n    const text = dataTransfer.getData('text/plain');\n    const { files } = dataTransfer;\n\n    if (!text && files && files.length > 0) {\n      const injectedPlugins = getInjectedPlugins<{}, V, E>(editor, plugin);\n      if (\n        !pipeInsertDataQuery<{}, V, E>(injectedPlugins, {\n          data: text,\n          dataTransfer,\n        })\n      ) {\n        return insertData(dataTransfer);\n      }\n\n      for (const file of files) {\n        const reader = new FileReader();\n        const [mime] = file.type.split('/');\n\n        if (mime === 'image') {\n          reader.addEventListener('load', async () => {\n            if (!reader.result) {\n              return;\n            }\n            const uploadedUrl = uploadImage\n              ? await uploadImage(reader.result)\n              : reader.result;\n\n            insertImage(editor, uploadedUrl);\n          });\n\n          reader.readAsDataURL(file);\n        }\n      }\n    } else {\n      insertData(dataTransfer);\n    }\n  };\n\n  return editor;\n};\n","import { PlateEditor, Value, WithPlatePlugin } from '@udecode/plate-common';\nimport { getWithSelectionCaption } from '../caption/getWithSelectionCaption';\nimport { ELEMENT_IMAGE } from './createImagePlugin';\nimport { ImagePlugin } from './types';\nimport { withImageEmbed } from './withImageEmbed';\nimport { withImageUpload } from './withImageUpload';\n\n/**\n * @see withImageUpload\n * @see withImageEmbed\n */\nexport const withImage = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  plugin: WithPlatePlugin<ImagePlugin, V, E>\n) => {\n  const {\n    options: { disableUploadInsert, disableEmbedInsert, disableCaption },\n  } = plugin;\n\n  if (!disableUploadInsert) {\n    editor = withImageUpload(editor, plugin);\n  }\n\n  if (!disableEmbedInsert) {\n    editor = withImageEmbed(editor, plugin);\n  }\n\n  if (!disableCaption) {\n    editor = getWithSelectionCaption(ELEMENT_IMAGE)(editor, plugin);\n  }\n\n  return editor;\n};\n","import { createPluginFactory } from '@udecode/plate-common';\nimport { getOnKeyDownCaption } from '../caption/getOnKeyDownCaption';\nimport { ImagePlugin } from './types';\nimport { withImage } from './withImage';\n\nexport const ELEMENT_IMAGE = 'img';\n\n/**\n * Enables support for images.\n */\nexport const createImagePlugin = createPluginFactory<ImagePlugin>({\n  key: ELEMENT_IMAGE,\n  isElement: true,\n  isVoid: true,\n  withOverrides: withImage,\n  handlers: {\n    onKeyDown: getOnKeyDownCaption(ELEMENT_IMAGE),\n  },\n  then: (editor, { type }) => ({\n    deserializeHtml: {\n      rules: [\n        {\n          validNodeName: 'IMG',\n        },\n      ],\n      getNode: (el) => ({\n        type,\n        url: el.getAttribute('src'),\n      }),\n    },\n  }),\n});\n","import {\n  createComponentAs,\n  createElementAs,\n  HTMLPropsAs,\n  useElement,\n} from '@udecode/plate-common';\nimport { useCaptionString } from '../../caption/index';\nimport { TMediaElement } from '../../media/index';\n\nexport const useImage = (props?: HTMLPropsAs<'img'>): HTMLPropsAs<'img'> => {\n  const { url } = useElement<TMediaElement>();\n\n  const captionString = useCaptionString();\n\n  return {\n    src: url,\n    alt: captionString,\n    draggable: true,\n    ...props,\n  };\n};\n\nexport const Image = createComponentAs((props) => {\n  const htmlProps = useImage(props);\n\n  return createElementAs('img', htmlProps);\n});\n","import { EmbedUrlData } from '../media/parseMediaUrl';\n\nconst twitterRegex = /^https?:\\/\\/twitter\\.com\\/(?:#!\\/)?(\\w+)\\/status(es)?\\/(?<id>\\d+)/;\n\nexport const parseTwitterUrl = (url: string): EmbedUrlData | undefined => {\n  if (url.match(twitterRegex)) {\n    return {\n      provider: 'twitter',\n      id: twitterRegex.exec(url)?.groups?.id,\n      url,\n    };\n  }\n};\n","import React from 'react';\nimport { EmbedUrlData } from '../../media/index';\nimport { Tweet, TweetProps } from '../index';\n\nexport const useMediaEmbedTweet = ({\n  id,\n  ...props\n}: EmbedUrlData): TweetProps => {\n  return {\n    tweetId: id!,\n    ...props,\n  };\n};\n\nexport const MediaEmbedTweet = (props: EmbedUrlData) => {\n  const htmlProps = useMediaEmbedTweet(props);\n\n  return <Tweet {...htmlProps} />;\n};\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\n\nconst WIDGET_SCRIPT_URL = 'https://platform.twitter.com/widgets.js';\n\ndeclare global {\n  interface Window {\n    twttr: any;\n  }\n}\n\ntype TwitterEmbedOptions = {\n  cards?: 'hidden';\n  theme?: 'dark' | 'light';\n};\n\nexport type TweetProps = Readonly<{\n  loadingComponent?: JSX.Element | string;\n  onError?: (error: string) => void;\n  onLoad?: () => void;\n  tweetId: string;\n  twitterOptions?: TwitterEmbedOptions;\n}>;\n\nexport const Tweet = ({\n  tweetId,\n  onError,\n  onLoad,\n  loadingComponent,\n  twitterOptions = {},\n}: TweetProps) => {\n  const [isLoading, setIsLoading] = useState(true);\n  const containerRef = useRef(null);\n  const previousTweetIDRef = useRef('');\n  const { cards, theme } = twitterOptions;\n\n  const createTweet = useCallback(async () => {\n    try {\n      await window.twttr.widgets.createTweet(tweetId, containerRef.current, {\n        cards,\n        theme,\n      });\n\n      setIsLoading(false);\n\n      if (onLoad) {\n        onLoad();\n      }\n    } catch (error) {\n      if (onError) {\n        onError(String(error));\n      }\n    }\n  }, [onError, onLoad, tweetId, cards, theme]);\n\n  useEffect(() => {\n    if (tweetId !== previousTweetIDRef.current) {\n      let isComponentMounted = true;\n      const script = require('scriptjs');\n      script(WIDGET_SCRIPT_URL, 'twitter-embed', () => {\n        if (!window.twttr) {\n          return console.error('Failure to load window.twttr.');\n        }\n\n        if (isComponentMounted) createTweet();\n      });\n\n      if (previousTweetIDRef) {\n        previousTweetIDRef.current = tweetId;\n      }\n\n      return () => {\n        isComponentMounted = false;\n      };\n    }\n  }, [createTweet, onError, onLoad, tweetId]);\n\n  return (\n    <>\n      {isLoading ? loadingComponent : null}\n      <div key={tweetId} ref={containerRef} />\n    </>\n  );\n};\n","import { isUrl } from '@udecode/plate-common';\nimport videoParser from 'js-video-url-parser';\nimport { EmbedUrlData } from '../media/parseMediaUrl';\n\nconst YOUTUBE_PREFIX = 'https://www.youtube.com/embed/';\nconst VIMEO_PREFIX = 'https://player.vimeo.com/video/';\nconst DAILYMOTION_PREFIX = 'https://www.dailymotion.com/embed/video/';\nconst YOUKU_PREFIX = 'https://player.youku.com/embed/';\nconst COUB_PREFIX = 'https://coub.com/embed/';\n\nexport const parseVideoUrl = (url: string): EmbedUrlData | undefined => {\n  if (!isUrl(url)) return;\n\n  const videoData = videoParser.parse(url);\n  if (videoData?.provider && videoData.id) {\n    const { id, provider } = videoData;\n\n    const providerUrls: Record<string, string> = {\n      youtube: `${YOUTUBE_PREFIX}${id}`,\n      vimeo: `${VIMEO_PREFIX}${id}`,\n      dailymotion: `${DAILYMOTION_PREFIX}${id}`,\n      youku: `${YOUKU_PREFIX}${id}`,\n      coub: `${COUB_PREFIX}${id}`,\n    };\n\n    return {\n      id,\n      provider,\n      url: providerUrls[provider],\n    };\n  }\n};\n","import { createElementAs, HTMLPropsAs } from '@udecode/plate-common';\nimport { EmbedUrlData, useMediaStore } from '../../media/index';\n\nexport const useMediaEmbedVideo = ({\n  ...props\n}: EmbedUrlData): HTMLPropsAs<'iframe'> => {\n  const { url } = useMediaStore().get.urlData();\n\n  return {\n    title: 'embed',\n    frameBorder: '0',\n    allowFullScreen: true,\n    src: url,\n    ...props,\n  };\n};\n\nexport const MediaEmbedVideo = (props: EmbedUrlData) => {\n  const htmlProps = useMediaEmbedVideo(props);\n\n  return createElementAs('iframe', htmlProps);\n};\n","export const parseIframeUrl = (url: string) => {\n  // if not starting with http, assume pasting of full iframe embed code\n  if (url.substring(0, 4) !== 'http') {\n    const regexMatchSrc = /src=\".*?\"/;\n    const regexGroupQuotes = /\"([^\"]*)\"/;\n\n    const src = url.match(regexMatchSrc)?.[0];\n    const returnString = src?.match(regexGroupQuotes)?.[1];\n\n    if (returnString) {\n      url = returnString;\n    }\n  }\n  return url;\n};\n","import { createPluginFactory } from '@udecode/plate-common';\nimport { getOnKeyDownCaption } from '../caption/getOnKeyDownCaption';\nimport { getWithSelectionCaption } from '../caption/getWithSelectionCaption';\nimport { MediaPlugin } from '../media/index';\nimport { MediaEmbedTweet, parseTwitterUrl } from '../twitter/index';\nimport { MediaEmbedVideo, parseVideoUrl } from '../video/index';\nimport { parseIframeUrl } from './parseIframeUrl';\n\nexport const ELEMENT_MEDIA_EMBED = 'media_embed';\n\n/**\n * Enables support for embeddable media such as YouTube\n * or Vimeo videos, Instagram posts and tweets or Google Maps.\n */\nexport const createMediaEmbedPlugin = createPluginFactory<MediaPlugin>({\n  key: ELEMENT_MEDIA_EMBED,\n  isElement: true,\n  isVoid: true,\n  handlers: {\n    onKeyDown: getOnKeyDownCaption(ELEMENT_MEDIA_EMBED),\n  },\n  withOverrides: (editor, plugin) => {\n    const {\n      options: { disableCaption },\n    } = plugin;\n\n    if (!disableCaption) {\n      editor = getWithSelectionCaption(ELEMENT_MEDIA_EMBED)(editor, plugin);\n    }\n\n    return editor;\n  },\n  options: {\n    transformUrl: parseIframeUrl,\n    rules: [\n      {\n        parser: parseTwitterUrl,\n        component: MediaEmbedTweet,\n      },\n      {\n        parser: parseVideoUrl,\n        component: MediaEmbedVideo,\n      },\n    ],\n  },\n  then: (editor, { type }) => ({\n    deserializeHtml: {\n      rules: [\n        {\n          validNodeName: 'IFRAME',\n        },\n      ],\n      getNode: (el: HTMLElement) => {\n        const url = el.getAttribute('src');\n        if (url) {\n          return {\n            type,\n            url,\n          };\n        }\n      },\n    },\n  }),\n});\n","import { createAtomStore, SCOPE_ELEMENT } from '@udecode/plate-common';\nimport { EmbedUrlData } from './parseMediaUrl';\n\nexport const { mediaStore, useMediaStore } = createAtomStore(\n  {\n    urlData: {} as EmbedUrlData,\n  },\n  { name: 'media' as const, scope: SCOPE_ELEMENT }\n);\n","import React from 'react';\nimport { HTMLPropsAs } from '@udecode/plate-common';\nimport { useMediaStore } from '../../media/mediaStore';\n\nexport const MediaEmbed = (props: HTMLPropsAs<'iframe'>) => {\n  const { component: Component, ...embedData } = useMediaStore().get.urlData();\n\n  if (!Component) return null;\n\n  return <Component {...embedData} {...props} />;\n};\n","import {\n  getParentNode,\n  insertNodes,\n  PlateEditor,\n  PlatePluginKey,\n  Value,\n} from '@udecode/plate-common';\nimport { ELEMENT_MEDIA_EMBED } from '../createMediaEmbedPlugin';\nimport { TMediaEmbedElement } from '../types';\n\nexport const insertMediaEmbed = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    url = '',\n    key = ELEMENT_MEDIA_EMBED,\n  }: Partial<TMediaEmbedElement> & PlatePluginKey\n): void => {\n  if (!editor.selection) return;\n  const selectionParentEntry = getParentNode(editor, editor.selection);\n  if (!selectionParentEntry) return;\n  const [, path] = selectionParentEntry;\n  insertNodes<TMediaEmbedElement>(\n    editor,\n    {\n      type: key,\n      url,\n      children: [{ text: '' }],\n    },\n    { at: path }\n  );\n};\n","import React, { useCallback, useEffect, useRef } from 'react';\nimport {\n  AsProps,\n  createComponentAs,\n  findNodePath,\n  isDefined,\n  select,\n  setNodes,\n  useEditorRef,\n  useElement,\n} from '@udecode/plate-common';\nimport {\n  ResizeEvent,\n  ResizeLength,\n  resizeLengthClamp,\n  useResizeHandleProps,\n} from '@udecode/resizable';\nimport { useReadOnly } from 'slate-react';\nimport { TMediaElement } from '../media/types';\nimport { useResizableStore } from './resizableStore';\nimport { TResizableElement } from './TResizableElement';\n\nexport interface ResizableProps extends AsProps<'div'> {\n  /**\n   * Node alignment.\n   */\n  align?: 'left' | 'center' | 'right';\n\n  readOnly?: boolean;\n\n  minWidth?: ResizeLength;\n  maxWidth?: ResizeLength;\n\n  renderHandleLeft?: (props: AsProps<'div'>) => JSX.Element;\n  renderHandleRight?: (props: AsProps<'div'>) => JSX.Element;\n}\n\nexport const useResizable = ({\n  align = 'center',\n  readOnly,\n  minWidth = 92,\n  maxWidth = '100%',\n  renderHandleLeft,\n  renderHandleRight,\n  ...props\n}: ResizableProps) => {\n  const element = useElement<TMediaElement>();\n  const editor = useEditorRef();\n  const _readOnly = useReadOnly();\n  readOnly = isDefined(readOnly) ? readOnly : _readOnly;\n  const wrapperRef = useRef<HTMLDivElement>(null);\n\n  const nodeWidth = element?.width ?? '100%';\n\n  const [width, setWidth] = useResizableStore().use.width();\n\n  const setNodeWidth = useCallback(\n    (w: number) => {\n      const path = findNodePath(editor, element!);\n      if (!path) return;\n\n      if (w === nodeWidth) {\n        // Focus the node if not resized\n        select(editor, path);\n      } else {\n        setNodes<TResizableElement>(editor, { width: w }, { at: path });\n      }\n    },\n    [editor, element, nodeWidth]\n  );\n\n  useEffect(() => {\n    setWidth(nodeWidth);\n  }, [nodeWidth, setWidth]);\n\n  const handleResize = useCallback(\n    ({ initialSize, delta, finished, direction }: ResizeEvent) => {\n      const wrapperStaticWidth = wrapperRef.current!.offsetWidth;\n      const deltaFactor =\n        (align === 'center' ? 2 : 1) * (direction === 'left' ? -1 : 1);\n\n      const newWidth = resizeLengthClamp(\n        initialSize + delta * deltaFactor,\n        wrapperStaticWidth,\n        {\n          min: minWidth,\n          max: maxWidth,\n        }\n      );\n\n      if (finished) {\n        setNodeWidth(newWidth);\n      } else {\n        setWidth(newWidth);\n      }\n    },\n    [align, maxWidth, minWidth, setNodeWidth, setWidth]\n  );\n\n  // Remove style except for cursor\n  const handlePropsLeft = {\n    ...useResizeHandleProps({\n      direction: 'left',\n      onResize: handleResize,\n    }),\n    style: { cursor: 'ew-resize' },\n  };\n\n  const handlePropsRight = {\n    ...useResizeHandleProps({\n      direction: 'right',\n      onResize: handleResize,\n    }),\n    style: { cursor: 'ew-resize' },\n  };\n\n  const handleLeft =\n    !readOnly && align !== 'left' && renderHandleLeft?.(handlePropsLeft);\n  const handleRight =\n    !readOnly && align !== 'right' && renderHandleRight?.(handlePropsRight);\n\n  return {\n    wrapperProps: {\n      ref: wrapperRef,\n      style: {\n        position: 'relative',\n      },\n    } as AsProps<'div'>,\n    resizableProps: {\n      style: {\n        width,\n        minWidth,\n        maxWidth,\n        position: 'relative',\n      },\n    } as AsProps<'div'>,\n    handleLeft,\n    handleRight,\n    restProps: props,\n  };\n};\n\nexport const Resizable = createComponentAs<ResizableProps>(\n  ({ children, ...props }) => {\n    const {\n      wrapperProps,\n      resizableProps,\n      handleLeft,\n      handleRight,\n      restProps,\n    } = useResizable(props);\n\n    return (\n      <div {...wrapperProps}>\n        <div {...resizableProps} {...restProps}>\n          {handleLeft}\n          {children}\n          {handleRight}\n        </div>\n      </div>\n    );\n  }\n);\n","import {\n  getPluginOptions,\n  PlateEditor,\n  RenderFunction,\n  Value,\n} from '@udecode/plate-common';\nimport { MediaPlugin } from './types';\n\nexport type EmbedUrlData = {\n  url?: string;\n  provider?: string;\n  id?: string;\n  component?: RenderFunction<EmbedUrlData>;\n};\n\nexport const parseMediaUrl = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    pluginKey,\n    url,\n  }: {\n    pluginKey: string;\n    url?: string;\n  }\n): EmbedUrlData | undefined => {\n  if (!url) return;\n\n  const { rules } = getPluginOptions<MediaPlugin, V>(editor, pluginKey);\n  if (!rules) return;\n\n  for (const { parser, component } of rules) {\n    const parsed = parser(url);\n    if (parsed) {\n      return { ...parsed, component };\n    }\n  }\n};\n","import { useEffect } from 'react';\nimport {\n  createComponentAs,\n  createElementAs,\n  HTMLPropsAs,\n  PlateRenderElementProps,\n  useEditorRef,\n  useElement,\n  useElementProps,\n  Value,\n} from '@udecode/plate-common';\nimport { ELEMENT_MEDIA_EMBED } from '../media-embed/index';\nimport { Resizable } from '../resizable/Resizable';\nimport { useMediaStore } from './mediaStore';\nimport { parseMediaUrl } from './parseMediaUrl';\nimport { TMediaElement } from './types';\n\nexport type MediaRootProps = PlateRenderElementProps<Value, TMediaElement> &\n  HTMLPropsAs<'div'> & {\n    pluginKey?: string;\n  };\n\nexport const useMedia = ({\n  pluginKey = ELEMENT_MEDIA_EMBED,\n  ...props\n}: MediaRootProps): HTMLPropsAs<'iframe'> => {\n  const editor = useEditorRef();\n  const element = useElement<TMediaElement>();\n  const setUrlData = useMediaStore().set.urlData();\n  const { url: elementUrl } = element;\n\n  useEffect(() => {\n    const parsed = parseMediaUrl(editor, {\n      pluginKey,\n      url: elementUrl,\n    });\n\n    if (parsed) {\n      setUrlData(parsed);\n    }\n  }, [editor, elementUrl, pluginKey, setUrlData]);\n\n  return useElementProps(props as any);\n};\n\nexport const MediaRoot = createComponentAs<\n  PlateRenderElementProps<Value, TMediaElement> & HTMLPropsAs<'div'>\n>((props) => {\n  const htmlProps = useMedia(props);\n\n  return createElementAs('div', htmlProps);\n});\n\nexport const Media = {\n  Root: MediaRoot,\n  Resizable,\n};\n","import { RenderFunction } from '@udecode/plate-common';\nimport { TCaptionElement } from '../caption/index';\nimport { TResizableElement } from '../resizable/index';\nimport { EmbedUrlData } from './parseMediaUrl';\n\nexport interface TMediaElement extends TCaptionElement, TResizableElement {\n  url: string;\n}\n\nexport type MediaUrlParser = (url: string) => EmbedUrlData | undefined;\n\nexport type MediaPluginRule = {\n  parser: MediaUrlParser;\n  component?: RenderFunction<EmbedUrlData>;\n};\n\nexport interface MediaPlugin {\n  isUrl?: (text: string) => boolean;\n\n  /**\n   * Transforms the url.\n   */\n  transformUrl?: (url: string) => string;\n\n  /**\n   * List of rules. The first rule that matches the url will be used,\n   * i.e. its component will be used to render the media. Used by `MediaEmbed`.\n   */\n  rules?: MediaPluginRule[];\n\n  disableCaption?: boolean;\n}\n\nexport const ELEMENT_MEDIA = 'media';\n","import { createStore } from '@udecode/plate-common';\n\nexport const floatingMediaStore = createStore('floatingMedia')({\n  url: '',\n  isEditing: false,\n}).extendActions((set) => ({\n  reset: () => {\n    set.url('');\n    set.isEditing(false);\n  },\n}));\n\nexport const floatingMediaActions = floatingMediaStore.set;\nexport const floatingMediaSelectors = floatingMediaStore.get;\nexport const useFloatingMediaSelectors = () => floatingMediaStore.use;\n","import { useCallback } from 'react';\nimport {\n  AsProps,\n  createComponentAs,\n  createElementAs,\n  HTMLPropsAs,\n  useElement,\n} from '@udecode/plate-common';\nimport { TMediaElement } from '../types';\nimport { floatingMediaActions } from './floatingMediaStore';\n\nexport const useFloatingMediaEditButton = (\n  props: HTMLPropsAs<'button'>\n): HTMLPropsAs<'button'> => {\n  const element = useElement<TMediaElement>();\n\n  return {\n    onClick: useCallback(() => {\n      floatingMediaActions.url(element.url);\n      floatingMediaActions.isEditing(true);\n    }, [element.url]),\n    ...props,\n  };\n};\n\nexport const FloatingMediaEditButton = createComponentAs<AsProps<'button'>>(\n  (props) => {\n    const htmlProps = useFloatingMediaEditButton(props);\n\n    return createElementAs('button', htmlProps);\n  }\n);\n","import {\n  focusEditor,\n  getPluginOptions,\n  isUrl,\n  PlateEditor,\n  setNodes,\n  Value,\n} from '@udecode/plate-common';\nimport { ELEMENT_MEDIA, MediaPlugin, TMediaElement } from '../types';\nimport {\n  floatingMediaActions,\n  floatingMediaSelectors,\n} from './floatingMediaStore';\n\nexport const submitFloatingMedia = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    element,\n    pluginKey = ELEMENT_MEDIA,\n  }: {\n    element: TMediaElement;\n    pluginKey?: string;\n  }\n) => {\n  let url = floatingMediaSelectors.url();\n\n  if (url === element.url) {\n    floatingMediaActions.reset();\n    return true;\n  }\n\n  const { isUrl: _isUrl = isUrl, transformUrl } = getPluginOptions<\n    MediaPlugin,\n    V\n  >(editor, pluginKey);\n  const isValid = _isUrl(url);\n  if (!isValid) return;\n\n  if (transformUrl) {\n    url = transformUrl(url);\n  }\n\n  setNodes<TMediaElement>(editor, {\n    url,\n  });\n\n  floatingMediaActions.reset();\n\n  focusEditor(editor, editor.selection!);\n\n  return true;\n};\n","import { ChangeEventHandler, useCallback, useEffect } from 'react';\nimport {\n  createComponentAs,\n  createElementAs,\n  focusEditor,\n  HTMLPropsAs,\n  mergeProps,\n  useEditorRef,\n  useElement,\n  useHotkeys,\n} from '@udecode/plate-common';\nimport { TMediaElement } from '../types';\nimport {\n  floatingMediaActions,\n  floatingMediaSelectors,\n} from './floatingMediaStore';\nimport { submitFloatingMedia } from './submitFloatingMedia';\n\nexport type FloatingMediaUrlInputProps = HTMLPropsAs<'input'> & {\n  pluginKey?: string;\n};\n\nexport const useFloatingMediaUrlInput = ({\n  pluginKey,\n  ...props\n}: FloatingMediaUrlInputProps): HTMLPropsAs<'input'> => {\n  const editor = useEditorRef();\n  const element = useElement<TMediaElement>();\n\n  useEffect(() => {\n    return () => {\n      floatingMediaActions.isEditing(false);\n    };\n  }, []);\n\n  useHotkeys(\n    'enter',\n    (e) => {\n      if (submitFloatingMedia(editor, { element, pluginKey })) {\n        e.preventDefault();\n      }\n    },\n    {\n      enableOnFormTags: ['INPUT'],\n    },\n    []\n  );\n\n  useHotkeys(\n    'escape',\n    () => {\n      if (floatingMediaSelectors.isEditing()) {\n        floatingMediaActions.reset();\n        focusEditor(editor, editor.selection!);\n      }\n    },\n    {\n      enableOnFormTags: ['INPUT'],\n      enableOnContentEditable: true,\n    },\n    []\n  );\n\n  const onChange: ChangeEventHandler<HTMLInputElement> = useCallback((e) => {\n    floatingMediaActions.url(e.target.value);\n  }, []);\n\n  return mergeProps(\n    {\n      onChange,\n      autoFocus: true,\n      defaultValue: floatingMediaSelectors.url(),\n    },\n    props\n  );\n};\n\nexport const FloatingMediaUrlInput = createComponentAs<FloatingMediaUrlInputProps>(\n  (props) => {\n    const htmlProps = useFloatingMediaUrlInput(props);\n\n    return createElementAs('input', htmlProps);\n  }\n);\n","import { FloatingMediaEditButton } from './FloatingMediaEditButton';\nimport { FloatingMediaUrlInput } from './FloatingMediaUrlInput';\n\nexport const FloatingMedia = {\n  EditButton: FloatingMediaEditButton,\n  UrlInput: FloatingMediaUrlInput,\n};\n"],"names":["captionGlobalStore","createStore","focusEndCaptionPath","focusStartCaptionPath","getOnKeyDownCaption","pluginKey","editor","e","defaultPrevented","isHotkey","entry","getBlockAbove","match","type","getPluginType","set","getWithSelectionCaption","plugin","apply","operation","newSelection","selection","newProperties","currentKeyboardEvent","isCollapsed","getAboveNode","at","node","caption","getNodeString","children","length","setTimeout","resizableStore","useResizableStore","createAtomStore","width","name","scope","SCOPE_ELEMENT","useCaptionString","nodeCaption","text","useElement","useMemo","TextareaAutosize","forwardRef","props","ref","isRerendered","setIsRerendered","useState","useLayoutEffect","React","ReactTextareaAutosize","useCaptionTextareaFocus","textareaRef","useEditorRef","element","focusCaptionPath","use","useEffect","current","path","findNodePath","Path","equals","focus","useCaptionTextarea","captionValue","setCaptionValue","readOnly","useReadOnly","useRef","useComposedRef","onChange","useCallback","newValue","target","value","setNodes","onKeyDown","preventDefault","focusEditor","nextNodePath","getPointAfter","CaptionTextarea","createComponentAs","as","htmlProps","useCaption","get","style","useCaptionState","captionString","selected","useSelected","_readOnly","CaptionRoot","createElementAs","Caption","Root","Textarea","insertImage","url","image","ELEMENT_IMAGE","insertNodes","imageExtensions","isImageUrl","isUrl","ext","URL","pathname","split","pop","includes","withImageEmbed","insertData","dataTransfer","getData","withImageUpload","options","uploadImage","files","injectedPlugins","getInjectedPlugins","pipeInsertDataQuery","data","file","reader","FileReader","mime","addEventListener","result","uploadedUrl","readAsDataURL","withImage","disableUploadInsert","disableEmbedInsert","disableCaption","createImagePlugin","createPluginFactory","key","isElement","isVoid","withOverrides","handlers","then","deserializeHtml","rules","validNodeName","getNode","el","getAttribute","useImage","src","alt","draggable","Image","twitterRegex","parseTwitterUrl","provider","id","exec","groups","useMediaEmbedTweet","tweetId","MediaEmbedTweet","WIDGET_SCRIPT_URL","Tweet","onError","onLoad","loadingComponent","twitterOptions","isLoading","setIsLoading","containerRef","previousTweetIDRef","cards","theme","createTweet","window","twttr","widgets","error","String","isComponentMounted","script","require","console","YOUTUBE_PREFIX","VIMEO_PREFIX","DAILYMOTION_PREFIX","YOUKU_PREFIX","COUB_PREFIX","parseVideoUrl","videoData","videoParser","parse","providerUrls","youtube","vimeo","dailymotion","youku","coub","useMediaEmbedVideo","useMediaStore","urlData","title","frameBorder","allowFullScreen","MediaEmbedVideo","parseIframeUrl","substring","regexMatchSrc","regexGroupQuotes","returnString","ELEMENT_MEDIA_EMBED","createMediaEmbedPlugin","transformUrl","parser","component","mediaStore","MediaEmbed","Component","embedData","insertMediaEmbed","selectionParentEntry","getParentNode","useResizable","align","minWidth","maxWidth","renderHandleLeft","renderHandleRight","isDefined","wrapperRef","nodeWidth","setWidth","setNodeWidth","w","select","handleResize","initialSize","delta","finished","direction","wrapperStaticWidth","offsetWidth","deltaFactor","newWidth","resizeLengthClamp","min","max","handlePropsLeft","useResizeHandleProps","onResize","cursor","handlePropsRight","handleLeft","handleRight","wrapperProps","position","resizableProps","restProps","Resizable","parseMediaUrl","getPluginOptions","parsed","useMedia","setUrlData","elementUrl","useElementProps","MediaRoot","Media","ELEMENT_MEDIA","floatingMediaStore","isEditing","extendActions","reset","floatingMediaActions","floatingMediaSelectors","useFloatingMediaSelectors","useFloatingMediaEditButton","onClick","FloatingMediaEditButton","submitFloatingMedia","_isUrl","isValid","useFloatingMediaUrlInput","useHotkeys","enableOnFormTags","enableOnContentEditable","mergeProps","autoFocus","defaultValue","FloatingMediaUrlInput","FloatingMedia","EditButton","UrlInput"],"mappings":"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"}
{"version":3,"file":"index.js","sources":["../../../../node_modules/lodash/isArray.js","../../../../node_modules/lodash/castArray.js","../../../../node_modules/is-hotkey/lib/index.js","../src/queries/isListNested.ts","../src/queries/getListTypes.ts","../src/queries/getHighestEmptyList.ts","../src/queries/getListItemEntry.ts","../src/queries/getListRoot.ts","../src/transforms/insertTodoListItem.ts","../src/insertBreakTodoList.ts","../src/withTodoList.ts","../src/todo-list/createTodoListPlugin.ts","../src/queries/getTodoListItemEntry.ts","../src/queries/hasListChild.ts","../src/queries/isAcrossListItems.ts","../src/queries/isListRoot.ts","../src/transforms/moveListItemDown.ts","../src/transforms/moveListItemsToList.ts","../src/transforms/unwrapList.ts","../src/transforms/moveListItemUp.ts","../src/transforms/removeFirstListItem.ts","../src/transforms/moveListItems.ts","../src/transforms/indentListItems.ts","../src/transforms/insertListItem.ts","../src/transforms/moveListItemSublistItemsToListItemSublist.ts","../src/transforms/moveListSiblingsAfterCursor.ts","../src/transforms/removeListItem.ts","../src/transforms/toggleList.ts","../src/transforms/unindentListItems.ts","../src/onKeyDownList.ts","../src/deleteBackwardList.ts","../src/deleteForwardList.ts","../src/deleteFragmentList.ts","../src/insertBreakList.ts","../src/insertFragmentList.ts","../src/normalizers/normalizeListItem.ts","../src/normalizers/normalizeNestedList.ts","../src/normalizers/normalizeList.ts","../src/withList.ts","../src/createListPlugin.ts"],"sourcesContent":["/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var isArray = require('./isArray');\n\n/**\n * Casts `value` as an array if it's not one.\n *\n * @static\n * @memberOf _\n * @since 4.4.0\n * @category Lang\n * @param {*} value The value to inspect.\n * @returns {Array} Returns the cast array.\n * @example\n *\n * _.castArray(1);\n * // => [1]\n *\n * _.castArray({ 'a': 1 });\n * // => [{ 'a': 1 }]\n *\n * _.castArray('abc');\n * // => ['abc']\n *\n * _.castArray(null);\n * // => [null]\n *\n * _.castArray(undefined);\n * // => [undefined]\n *\n * _.castArray();\n * // => []\n *\n * var array = [1, 2, 3];\n * console.log(_.castArray(array) === array);\n * // => true\n */\nfunction castArray() {\n  if (!arguments.length) {\n    return [];\n  }\n  var value = arguments[0];\n  return isArray(value) ? value : [value];\n}\n\nmodule.exports = castArray;\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n/**\n * Constants.\n */\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar IS_MAC = () => typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);\n\nvar MODIFIERS = {\n  alt: 'altKey',\n  control: 'ctrlKey',\n  meta: 'metaKey',\n  shift: 'shiftKey'\n};\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar ALIASES = () => ({\n  add: '+',\n  break: 'pause',\n  cmd: 'meta',\n  command: 'meta',\n  ctl: 'control',\n  ctrl: 'control',\n  del: 'delete',\n  down: 'arrowdown',\n  esc: 'escape',\n  ins: 'insert',\n  left: 'arrowleft',\n  mod: IS_MAC() ? 'meta' : 'control',\n  opt: 'alt',\n  option: 'alt',\n  return: 'enter',\n  right: 'arrowright',\n  space: ' ',\n  spacebar: ' ',\n  up: 'arrowup',\n  win: 'meta',\n  windows: 'meta'\n});\n\nvar CODES = {\n  backspace: 8,\n  tab: 9,\n  enter: 13,\n  shift: 16,\n  control: 17,\n  alt: 18,\n  pause: 19,\n  capslock: 20,\n  escape: 27,\n  ' ': 32,\n  pageup: 33,\n  pagedown: 34,\n  end: 35,\n  home: 36,\n  arrowleft: 37,\n  arrowup: 38,\n  arrowright: 39,\n  arrowdown: 40,\n  insert: 45,\n  delete: 46,\n  meta: 91,\n  numlock: 144,\n  scrolllock: 145,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  '\\'': 222\n};\n\nfor (var f = 1; f < 20; f++) {\n  CODES['f' + f] = 111 + f;\n}\n\n/**\n * Is hotkey?\n */\n\nfunction isHotkey(hotkey, options, event) {\n  if (options && !('byKey' in options)) {\n    event = options;\n    options = null;\n  }\n\n  if (!Array.isArray(hotkey)) {\n    hotkey = [hotkey];\n  }\n\n  var array = hotkey.map(function (string) {\n    return parseHotkey(string, options);\n  });\n  var check = function check(e) {\n    return array.some(function (object) {\n      return compareHotkey(object, e);\n    });\n  };\n  var ret = event == null ? check : check(event);\n  return ret;\n}\n\nfunction isCodeHotkey(hotkey, event) {\n  return isHotkey(hotkey, event);\n}\n\nfunction isKeyHotkey(hotkey, event) {\n  return isHotkey(hotkey, { byKey: true }, event);\n}\n\n/**\n * Parse.\n */\n\nfunction parseHotkey(hotkey, options) {\n  var byKey = options && options.byKey;\n  var ret = {};\n\n  // Special case to handle the `+` key since we use it as a separator.\n  hotkey = hotkey.replace('++', '+add');\n  var values = hotkey.split('+');\n  var length = values.length;\n\n  // Ensure that all the modifiers are set to false unless the hotkey has them.\n\n  for (var k in MODIFIERS) {\n    ret[MODIFIERS[k]] = false;\n  }\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = values[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var value = _step.value;\n\n      var optional = value.endsWith('?') && value.length > 1;\n\n      if (optional) {\n        value = value.slice(0, -1);\n      }\n\n      var name = toKeyName(value);\n      var modifier = MODIFIERS[name];\n\n      if (length === 1 || !modifier) {\n        if (byKey) {\n          ret.key = name;\n        } else {\n          ret.which = toKeyCode(value);\n        }\n      }\n\n      if (modifier) {\n        ret[modifier] = optional ? null : true;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return ret;\n}\n\n/**\n * Compare.\n */\n\nfunction compareHotkey(object, event) {\n  for (var key in object) {\n    var expected = object[key];\n    var actual = void 0;\n\n    if (expected == null) {\n      continue;\n    }\n\n    if (key === 'key' && event.key != null) {\n      actual = event.key.toLowerCase();\n    } else if (key === 'which') {\n      actual = expected === 91 && event.which === 93 ? 91 : event.which;\n    } else {\n      actual = event[key];\n    }\n\n    if (actual == null && expected === false) {\n      continue;\n    }\n\n    if (actual !== expected) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Utils.\n */\n\nfunction toKeyCode(name) {\n  name = toKeyName(name);\n  var code = CODES[name] || name.toUpperCase().charCodeAt(0);\n  return code;\n}\n\nfunction toKeyName(name) {\n  name = name.toLowerCase();\n  name = ALIASES()[name] || name;\n  return name;\n}\n\n/**\n * Export.\n */\n\nexports.default = isHotkey;\nexports.isHotkey = isHotkey;\nexports.isCodeHotkey = isCodeHotkey;\nexports.isKeyHotkey = isKeyHotkey;\nexports.parseHotkey = parseHotkey;\nexports.compareHotkey = compareHotkey;\nexports.toKeyCode = toKeyCode;\nexports.toKeyName = toKeyName;","import {\n  getParentNode,\n  getPluginType,\n  PlateEditor,\n  TElement,\n  Value,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport { ELEMENT_LI } from '../createListPlugin';\n\n/**\n * Is the list nested, i.e. its parent is a list item.\n */\nexport const isListNested = <V extends Value>(\n  editor: PlateEditor<V>,\n  listPath: Path\n) => {\n  const listParentNode = getParentNode<TElement>(editor, listPath)?.[0];\n\n  return listParentNode?.type === getPluginType(editor, ELEMENT_LI);\n};\n","import { getPluginType, PlateEditor, Value } from '@udecode/plate-common';\nimport {\n  ELEMENT_LI,\n  ELEMENT_LIC,\n  ELEMENT_OL,\n  ELEMENT_UL,\n} from '../createListPlugin';\n\nexport const getUnorderedListType = <V extends Value>(\n  editor: PlateEditor<V>\n) => {\n  return getPluginType(editor, ELEMENT_UL);\n};\n\nexport const getOrderedListType = <V extends Value>(editor: PlateEditor<V>) => {\n  return getPluginType(editor, ELEMENT_OL);\n};\n\nexport const getListTypes = <V extends Value>(editor: PlateEditor<V>) => {\n  return [getOrderedListType(editor), getUnorderedListType(editor)];\n};\n\nexport const getListItemType = <V extends Value>(editor: PlateEditor<V>) => {\n  return getPluginType(editor, ELEMENT_LI);\n};\n\nexport const getListItemContentType = <V extends Value>(\n  editor: PlateEditor<V>\n) => {\n  return getPluginType(editor, ELEMENT_LIC);\n};\n","import {\n  getAboveNode,\n  getPluginType,\n  PlateEditor,\n  Value,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport { ELEMENT_LI } from '../createListPlugin';\nimport { getListTypes } from './getListTypes';\n\n/**\n * Find the highest end list that can be deleted.\n * Its path should be different to diffListPath.\n * If the highest end list 2+ items, return liPath.\n * Get the parent list until:\n * - the list has less than 2 items.\n * - its path is not equals to diffListPath.\n */\nexport const getHighestEmptyList = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    diffListPath,\n    liPath,\n  }: {\n    liPath: Path;\n    diffListPath?: Path;\n  }\n): Path | undefined => {\n  const list = getAboveNode(editor, {\n    at: liPath,\n    match: { type: getListTypes(editor) },\n  });\n  if (!list) return;\n  const [listNode, listPath] = list;\n\n  if (!diffListPath || !Path.equals(listPath, diffListPath)) {\n    if (listNode.children.length < 2) {\n      const liParent = getAboveNode(editor, {\n        at: listPath,\n        match: { type: getPluginType(editor, ELEMENT_LI) },\n      });\n\n      if (liParent) {\n        return (\n          getHighestEmptyList(editor, { liPath: liParent[1], diffListPath }) ||\n          listPath\n        );\n      }\n    }\n    return liPath;\n  }\n};\n","import {\n  getAboveNode,\n  getNode,\n  getParentNode,\n  getPluginType,\n  isCollapsed,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n} from '@udecode/plate-common';\nimport { Location, Path, Range } from 'slate';\nimport { ELEMENT_LI } from '../createListPlugin';\n\n/**\n * Returns the nearest li and ul / ol wrapping node entries for a given path (default = selection)\n */\nexport const getListItemEntry = <V extends Value>(\n  editor: PlateEditor<V>,\n  { at = editor.selection }: { at?: Location | null } = {}\n): { list: TElementEntry; listItem: TElementEntry } | undefined => {\n  const liType = getPluginType(editor, ELEMENT_LI);\n\n  let _at: Path;\n\n  if (Range.isRange(at) && !isCollapsed(at)) {\n    _at = at.focus.path;\n  } else if (Range.isRange(at)) {\n    _at = at.anchor.path;\n  } else {\n    _at = at as Path;\n  }\n\n  if (_at) {\n    const node = getNode<TElement>(editor, _at);\n    if (node) {\n      const listItem = getAboveNode<TElement>(editor, {\n        at: _at,\n        match: { type: liType },\n      });\n\n      if (listItem) {\n        const list = getParentNode<TElement>(editor, listItem[1])!;\n\n        return { list, listItem };\n      }\n    }\n  }\n};\n","import {\n  getAboveNode,\n  getPluginType,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n} from '@udecode/plate-common';\nimport { Path, Point, Range } from 'slate';\nimport { ELEMENT_OL, ELEMENT_UL } from '../createListPlugin';\n\n/**\n * Searches upward for the root list element\n */\nexport const getListRoot = <V extends Value>(\n  editor: PlateEditor<V>,\n  at: Path | Range | Point | null = editor.selection\n): TElementEntry | undefined => {\n  if (!at) return;\n\n  const parentList = getAboveNode<TElement>(editor, {\n    at,\n    match: {\n      type: [\n        getPluginType(editor, ELEMENT_UL),\n        getPluginType(editor, ELEMENT_OL),\n      ],\n    },\n  });\n\n  if (parentList) {\n    const [, parentListPath] = parentList;\n\n    return getListRoot(editor, parentListPath) ?? parentList;\n  }\n};\n","import {\n  deleteText,\n  getAboveNode,\n  getMarks,\n  getPluginType,\n  insertElements,\n  isBlockTextEmptyAfterSelection,\n  isStartPoint,\n  PlateEditor,\n  select,\n  splitNodes,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-common';\nimport { Path, Range } from 'slate';\nimport { ELEMENT_TODO_LI } from '../todo-list';\nimport { TodoListPlugin } from '../types';\n\n/**\n * Insert todo list item if selection in li>p.\n * TODO: test\n */\nexport const insertTodoListItem = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    inheritCheckStateOnLineStartBreak = false,\n    inheritCheckStateOnLineEndBreak = false,\n  }: TodoListPlugin\n): boolean => {\n  const todoType = getPluginType(editor, ELEMENT_TODO_LI);\n\n  if (!editor.selection) {\n    return false;\n  }\n\n  const todoEntry = getAboveNode(editor, { match: { type: todoType } });\n  if (!todoEntry) return false;\n  const [todo, paragraphPath] = todoEntry;\n\n  let success = false;\n\n  withoutNormalizing(editor, () => {\n    if (!Range.isCollapsed(editor.selection!)) {\n      deleteText(editor);\n    }\n\n    const isStart = isStartPoint(\n      editor,\n      editor.selection!.focus,\n      paragraphPath\n    );\n    const isEnd = isBlockTextEmptyAfterSelection(editor);\n\n    const nextParagraphPath = Path.next(paragraphPath);\n\n    /**\n     * If start, insert a list item before\n     */\n    if (isStart) {\n      insertElements(\n        editor,\n        {\n          type: todoType,\n          checked: inheritCheckStateOnLineStartBreak ? todo.checked : false,\n          children: [{ text: '' }],\n        },\n        { at: paragraphPath }\n      );\n\n      success = true;\n\n      return;\n    }\n\n    /**\n     * If not end, split the nodes\n     */\n    if (!isEnd) {\n      withoutNormalizing(editor, () => {\n        splitNodes(editor);\n      });\n    } else {\n      /**\n       * If end, insert a list item after and select it\n       */\n      const marks = getMarks(editor) || {};\n      insertElements(\n        editor,\n        {\n          type: todoType,\n          checked: inheritCheckStateOnLineEndBreak ? todo.checked : false,\n          children: [{ text: '', ...marks }],\n        },\n        { at: nextParagraphPath }\n      );\n      select(editor, nextParagraphPath);\n    }\n\n    success = true;\n  });\n\n  return success;\n};\n","import { PlateEditor, Value } from '@udecode/plate-common';\nimport { getTodoListItemEntry } from './queries/getTodoListItemEntry';\nimport { insertTodoListItem } from './transforms/insertTodoListItem';\nimport { TodoListPlugin } from './types';\n\nexport const insertBreakTodoList = <V extends Value>(\n  editor: PlateEditor<V>,\n  options: TodoListPlugin\n) => {\n  if (!editor.selection) return;\n\n  const res = getTodoListItemEntry(editor);\n\n  // If selection is in a todo li\n  if (res) {\n    const inserted = insertTodoListItem(editor, options);\n    if (inserted) return true;\n  }\n};\n","import { PlateEditor, Value, WithPlatePlugin } from '@udecode/plate-common';\nimport { insertBreakTodoList } from './insertBreakTodoList';\nimport { TodoListPlugin } from './types';\n\nexport const withTodoList = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  { options }: WithPlatePlugin<TodoListPlugin, V, E>\n) => {\n  const { insertBreak } = editor;\n\n  editor.insertBreak = () => {\n    if (insertBreakTodoList(editor, options)) return;\n    insertBreak();\n  };\n\n  return editor;\n};\n","import {\n  createPluginFactory,\n  onKeyDownToggleElement,\n} from '@udecode/plate-common';\nimport { TodoListPlugin } from '../types';\nimport { withTodoList } from '../withTodoList';\n\nexport const ELEMENT_TODO_LI = 'action_item';\n\nexport const createTodoListPlugin = createPluginFactory<TodoListPlugin>({\n  key: ELEMENT_TODO_LI,\n  isElement: true,\n  withOverrides: withTodoList,\n  handlers: {\n    onKeyDown: onKeyDownToggleElement,\n  },\n  options: {\n    hotkey: ['mod+opt+4', 'mod+shift+4'],\n  },\n});\n","import {\n  getAboveNode,\n  getNode,\n  getParentNode,\n  getPluginType,\n  isCollapsed,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n} from '@udecode/plate-common';\nimport { Location, Path, Range } from 'slate';\nimport { ELEMENT_TODO_LI } from '../todo-list/createTodoListPlugin';\n\n/**\n * Returns the nearest li and ul / ol wrapping node entries for a given path (default = selection)\n */\nexport const getTodoListItemEntry = <V extends Value>(\n  editor: PlateEditor<V>,\n  { at = editor.selection }: { at?: Location | null } = {}\n): { list: TElementEntry; listItem: TElementEntry } | undefined => {\n  const todoType = getPluginType(editor, ELEMENT_TODO_LI);\n\n  let _at: Path;\n\n  if (Range.isRange(at) && !isCollapsed(at)) {\n    _at = at.focus.path;\n  } else if (Range.isRange(at)) {\n    _at = at.anchor.path;\n  } else {\n    _at = at as Path;\n  }\n\n  if (_at) {\n    const node = getNode<TElement>(editor, _at);\n    if (node) {\n      const listItem = getAboveNode<TElement>(editor, {\n        at: _at,\n        match: { type: todoType },\n      });\n\n      if (listItem) {\n        const list = getParentNode<TElement>(editor, listItem[1])!;\n\n        return { list, listItem };\n      }\n    }\n  }\n};\n","import { match, PlateEditor, TAncestor, Value } from '@udecode/plate-common';\nimport { getListTypes } from './getListTypes';\n\n/**\n * Is there a list child in the node.\n */\nexport const hasListChild = <V extends Value>(\n  editor: PlateEditor<V>,\n  node: TAncestor\n) => node.children.some((n) => match(n, [], { type: getListTypes(editor) }));\n","import {\n  getPluginType,\n  isCollapsed,\n  isRangeAcrossBlocks,\n  PlateEditor,\n  someNode,\n  Value,\n} from '@udecode/plate-common';\nimport { ELEMENT_LI } from '../createListPlugin';\n\n/**\n * Is selection across blocks with list items\n */\nexport const isAcrossListItems = <V extends Value>(editor: PlateEditor<V>) => {\n  const { selection } = editor;\n\n  if (!selection || isCollapsed(selection)) {\n    return false;\n  }\n\n  const isAcrossBlocks = isRangeAcrossBlocks(editor);\n  if (!isAcrossBlocks) return false;\n\n  return someNode(editor, {\n    match: { type: getPluginType(editor, ELEMENT_LI) },\n  });\n};\n","import {\n  isElement,\n  PlateEditor,\n  TDescendant,\n  Value,\n} from '@udecode/plate-common';\nimport { getListTypes } from './getListTypes';\n\nexport const isListRoot = <V extends Value>(\n  editor: PlateEditor<V>,\n  node: TDescendant\n): boolean => isElement(node) && getListTypes(editor).includes(node.type);\n","import {\n  getNodeEntry,\n  match,\n  moveNodes,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n  withoutNormalizing,\n  wrapNodes,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport { getListTypes } from '../queries';\n\nexport interface MoveListItemDownOptions {\n  list: TElementEntry;\n  listItem: TElementEntry;\n}\n\nexport const moveListItemDown = <V extends Value>(\n  editor: PlateEditor<V>,\n  { list, listItem }: MoveListItemDownOptions\n) => {\n  let moved = false;\n\n  const [listNode] = list;\n  const [, listItemPath] = listItem;\n\n  let previousListItemPath: Path;\n\n  try {\n    previousListItemPath = Path.previous(listItemPath);\n  } catch (e) {\n    return;\n  }\n\n  // Previous sibling is the new parent\n  const previousSiblingItem = getNodeEntry<TElement>(\n    editor,\n    previousListItemPath\n  );\n\n  if (previousSiblingItem) {\n    const [previousNode, previousPath] = previousSiblingItem;\n\n    const sublist = (previousNode.children as TElement[]).find((n) =>\n      match(n, [], { type: getListTypes(editor) })\n    );\n    const newPath = previousPath.concat(\n      sublist ? [1, sublist.children.length] : [1]\n    );\n\n    withoutNormalizing(editor, () => {\n      if (!sublist) {\n        // Create new sublist\n        wrapNodes<TElement>(\n          editor,\n          { type: listNode.type, children: [] },\n          { at: listItemPath }\n        );\n      }\n\n      // Move the current item to the sublist\n      moveNodes(editor, {\n        at: listItemPath,\n        to: newPath,\n      });\n\n      moved = true;\n    });\n  }\n\n  return moved;\n};\n","import {\n  deleteText,\n  findDescendant,\n  getLastChildPath,\n  moveChildren,\n  MoveChildrenOptions,\n  PlateEditor,\n  TElementEntry,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport { getListTypes } from '../queries/getListTypes';\n\nexport interface MergeListItemIntoListOptions<V extends Value = Value> {\n  /**\n   * List items of the sublist of this node will be moved.\n   */\n  fromListItem?: TElementEntry;\n\n  /**\n   * List items of the list will be moved.\n   */\n  fromList?: TElementEntry;\n\n  /**\n   * List items will be moved in this list.\n   */\n  toList?: TElementEntry;\n\n  fromStartIndex?: MoveChildrenOptions<V>['fromStartIndex'];\n\n  /**\n   * List position where to move the list items.\n   */\n  toListIndex?: number | null;\n\n  to?: Path;\n\n  /**\n   * Delete `fromListItem` sublist if true.\n   * @default true\n   */\n  deleteFromList?: boolean;\n}\n\n/**\n * Move the list items of the sublist of `fromListItem` to `toList` (if `fromListItem` is defined).\n * Move the list items of `fromList` to `toList` (if `fromList` is defined).\n */\nexport const moveListItemsToList = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    fromList,\n    fromListItem,\n    fromStartIndex,\n    to: _to,\n    toList,\n    toListIndex = null,\n    deleteFromList = true,\n  }: MergeListItemIntoListOptions<V>\n) => {\n  let fromListPath: Path | undefined;\n  let moved;\n\n  withoutNormalizing(editor, () => {\n    if (fromListItem) {\n      const fromListItemSublist = findDescendant(editor, {\n        at: fromListItem[1],\n        match: {\n          type: getListTypes(editor),\n        },\n      });\n      if (!fromListItemSublist) return;\n\n      fromListPath = fromListItemSublist?.[1];\n    } else if (fromList) {\n      // eslint-disable-next-line prefer-destructuring\n      fromListPath = fromList[1];\n    } else {\n      return;\n    }\n\n    let to: Path | null = null;\n\n    if (_to) to = _to;\n    if (toList) {\n      if (toListIndex !== null) to = toList[1].concat([toListIndex]);\n      else {\n        const lastChildPath = getLastChildPath(toList);\n        to = Path.next(lastChildPath);\n      }\n    }\n    if (!to) return;\n\n    moved = moveChildren(editor, {\n      at: fromListPath,\n      to,\n      fromStartIndex,\n    });\n\n    // Remove the empty list\n    if (deleteFromList) {\n      deleteText(editor, { at: fromListPath });\n    }\n  });\n\n  return moved;\n};\n","import {\n  ELEMENT_DEFAULT,\n  getAboveNode,\n  getBlockAbove,\n  getCommonNode,\n  getPluginType,\n  isElement,\n  PlateEditor,\n  setElements,\n  unwrapNodes,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport {\n  ELEMENT_LI,\n  ELEMENT_LIC,\n  ELEMENT_OL,\n  ELEMENT_UL,\n} from '../createListPlugin';\nimport { getListTypes } from '../queries';\n\nexport const unwrapList = <V extends Value>(\n  editor: PlateEditor<V>,\n  { at }: { at?: Path } = {}\n) => {\n  const ancestorListTypeCheck = () => {\n    if (getAboveNode(editor, { match: { type: getListTypes(editor), at } })) {\n      return true;\n    }\n\n    // The selection's common node might be a list type\n    if (!at && editor.selection) {\n      const commonNode = getCommonNode(\n        editor,\n        editor.selection.anchor.path,\n        editor.selection.focus.path\n      );\n      if (\n        isElement(commonNode[0]) &&\n        getListTypes(editor).includes(commonNode[0].type)\n      ) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  withoutNormalizing(editor, () => {\n    do {\n      const licEntry = getBlockAbove(editor, {\n        at,\n        match: { type: getPluginType(editor, ELEMENT_LIC) },\n      });\n      if (licEntry) {\n        setElements(editor, {\n          at,\n          type: getPluginType(editor, ELEMENT_DEFAULT),\n        });\n      }\n\n      unwrapNodes(editor, {\n        at,\n        match: { type: getPluginType(editor, ELEMENT_LI) },\n        split: true,\n      });\n\n      unwrapNodes(editor, {\n        at,\n        match: {\n          type: [\n            getPluginType(editor, ELEMENT_UL),\n            getPluginType(editor, ELEMENT_OL),\n          ],\n        },\n        split: true,\n      });\n    } while (ancestorListTypeCheck());\n  });\n};\n","import {\n  getAboveNode,\n  getNode,\n  getPluginType,\n  insertElements,\n  isLastChild,\n  moveNodes,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport { ELEMENT_LI } from '../createListPlugin';\nimport { hasListChild } from '../queries/hasListChild';\nimport { moveListItemsToList } from './moveListItemsToList';\nimport { unwrapList } from './unwrapList';\n\nexport interface MoveListItemUpOptions {\n  list: TElementEntry;\n  listItem: TElementEntry;\n}\n\n/**\n * Move a list item up.\n */\nexport const moveListItemUp = <V extends Value>(\n  editor: PlateEditor<V>,\n  { list, listItem }: MoveListItemUpOptions\n) => {\n  const move = () => {\n    const [listNode, listPath] = list;\n    const [liNode, liPath] = listItem;\n\n    const liParent = getAboveNode<TElement>(editor, {\n      at: listPath,\n      match: { type: getPluginType(editor, ELEMENT_LI) },\n    });\n    if (!liParent) {\n      let toListPath;\n      try {\n        toListPath = Path.next(listPath);\n      } catch (err) {\n        return;\n      }\n\n      const condA = hasListChild(editor, liNode);\n      const condB = !isLastChild(list, liPath);\n\n      if (condA || condB) {\n        // Insert a new list next to `list`\n        insertElements(\n          editor,\n          {\n            type: listNode.type,\n            children: [],\n          },\n          { at: toListPath }\n        );\n      }\n\n      if (condA) {\n        const toListNode = getNode<TElement>(editor, toListPath);\n        if (!toListNode) return;\n\n        // Move li sub-lis to the new list\n        moveListItemsToList(editor, {\n          fromListItem: listItem,\n          toList: [toListNode, toListPath],\n        });\n      }\n\n      // If there is siblings li, move them to the new list\n      if (condB) {\n        const toListNode = getNode<TElement>(editor, toListPath);\n        if (!toListNode) return;\n\n        // Move next lis to the new list\n        moveListItemsToList(editor, {\n          fromList: list,\n          fromStartIndex: liPath[liPath.length - 1] + 1,\n          toList: [toListNode, toListPath],\n          deleteFromList: false,\n        });\n      }\n\n      // Finally, unwrap the list\n      unwrapList(editor, { at: liPath.concat(0) });\n\n      return true;\n    }\n    const [, liParentPath] = liParent;\n\n    const toListPath = liPath.concat([1]);\n\n    // If li has next siblings, we need to move them.\n    if (!isLastChild(list, liPath)) {\n      // If li has no sublist, insert one.\n      if (!hasListChild(editor, liNode)) {\n        insertElements(\n          editor,\n          {\n            type: listNode.type,\n            children: [],\n          },\n          { at: toListPath }\n        );\n      }\n\n      const toListNode = getNode<TElement>(editor, toListPath);\n      if (!toListNode) return;\n\n      // Move next siblings to li sublist.\n      moveListItemsToList(editor, {\n        fromListItem: liParent,\n        toList: [toListNode, toListPath],\n        fromStartIndex: liPath[liPath.length - 1] + 1,\n        deleteFromList: false,\n      });\n    }\n\n    const movedUpLiPath = Path.next(liParentPath);\n\n    // Move li one level up: next to the li parent.\n    moveNodes(editor, {\n      at: liPath,\n      to: movedUpLiPath,\n    });\n\n    return true;\n  };\n\n  let moved: boolean | undefined = false;\n\n  withoutNormalizing(editor, () => {\n    moved = move();\n  });\n\n  return moved;\n};\n","import { PlateEditor, TElementEntry, Value } from '@udecode/plate-common';\nimport { isListNested } from '../queries/isListNested';\nimport { moveListItemUp } from './moveListItemUp';\n\n/**\n * If list is not nested and if li is not the first child, move li up.\n */\nexport const removeFirstListItem = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    list,\n    listItem,\n  }: {\n    list: TElementEntry;\n    listItem: TElementEntry;\n  }\n) => {\n  const [, listPath] = list;\n\n  if (!isListNested(editor, listPath)) {\n    moveListItemUp(editor, { list, listItem });\n\n    return true;\n  }\n\n  return false;\n};\n","import {\n  createPathRef,\n  getNodeEntries,\n  GetNodeEntriesOptions,\n  getParentNode,\n  getPluginType,\n  PlateEditor,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-common';\nimport { Path, PathRef } from 'slate';\nimport { ELEMENT_LIC } from '../createListPlugin';\nimport { isListNested } from '../queries/isListNested';\nimport { moveListItemDown } from './moveListItemDown';\nimport { moveListItemUp } from './moveListItemUp';\nimport { removeFirstListItem } from './removeFirstListItem';\n\nexport type MoveListItemsOptions = {\n  increase?: boolean;\n  at?: GetNodeEntriesOptions['at'];\n  enableResetOnShiftTab?: boolean;\n};\n\nexport const moveListItems = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    increase = true,\n    at = editor.selection ?? undefined,\n    enableResetOnShiftTab,\n  }: MoveListItemsOptions = {}\n) => {\n  const _nodes = getNodeEntries(editor, {\n    at,\n    match: {\n      type: getPluginType(editor, ELEMENT_LIC),\n    },\n  });\n\n  // Get the selected lic\n  const lics = Array.from(_nodes);\n\n  if (!lics.length) return;\n\n  const highestLicPaths: Path[] = [];\n  const highestLicPathRefs: PathRef[] = [];\n\n  // Filter out the nested lic, we just need to move the highest ones\n  lics.forEach((lic) => {\n    const licPath = lic[1];\n    const liPath = Path.parent(licPath);\n\n    const isAncestor = highestLicPaths.some((path) => {\n      const highestLiPath = Path.parent(path);\n\n      return Path.isAncestor(highestLiPath, liPath);\n    });\n    if (!isAncestor) {\n      highestLicPaths.push(licPath);\n      highestLicPathRefs.push(createPathRef(editor, licPath));\n    }\n  });\n\n  const licPathRefsToMove = increase\n    ? highestLicPathRefs\n    : highestLicPathRefs.reverse();\n\n  return withoutNormalizing(editor, () => {\n    let moved = false;\n\n    licPathRefsToMove.forEach((licPathRef) => {\n      const licPath = licPathRef.unref();\n      if (!licPath) return;\n\n      const listItem = getParentNode(editor, licPath);\n      if (!listItem) return;\n\n      const parentList = getParentNode(editor, listItem[1]);\n      if (!parentList) return;\n\n      let _moved: any;\n\n      if (increase) {\n        _moved = moveListItemDown(editor, {\n          list: parentList as any,\n          listItem: listItem as any,\n        });\n      } else if (isListNested(editor, parentList[1])) {\n        // un-indent a sub-list item\n        _moved = moveListItemUp(editor, {\n          list: parentList as any,\n          listItem: listItem as any,\n        });\n      } else if (enableResetOnShiftTab) {\n        // unindenting a top level list item, effectively breaking apart the list.\n        _moved = removeFirstListItem(editor, {\n          list: parentList as any,\n          listItem: listItem as any,\n        });\n      }\n\n      moved = _moved || moved;\n    });\n\n    return moved;\n  });\n};\n","import { PlateEditor, Value } from '@udecode/plate-common';\nimport { moveListItems } from './moveListItems';\n\nexport const indentListItems = <V extends Value>(editor: PlateEditor<V>) => {\n  moveListItems(editor, { increase: true });\n};\n","import {\n  collapseSelection,\n  deleteText,\n  getAboveNode,\n  getMarks,\n  getParentNode,\n  getPluginType,\n  insertElements,\n  isBlockTextEmptyAfterSelection,\n  isStartPoint,\n  moveNodes,\n  PlateEditor,\n  select,\n  splitNodes,\n  TElement,\n  Value,\n  withoutNormalizing,\n  wrapNodes,\n} from '@udecode/plate-common';\nimport { Path, Range } from 'slate';\nimport { ELEMENT_LI, ELEMENT_LIC } from '../createListPlugin';\n\n/**\n * Insert list item if selection in li>p.\n * TODO: test\n */\nexport const insertListItem = <V extends Value>(\n  editor: PlateEditor<V>\n): boolean => {\n  const liType = getPluginType(editor, ELEMENT_LI);\n  const licType = getPluginType(editor, ELEMENT_LIC);\n\n  if (!editor.selection) {\n    return false;\n  }\n\n  const licEntry = getAboveNode(editor, { match: { type: licType } });\n  if (!licEntry) return false;\n  const [, paragraphPath] = licEntry;\n\n  const listItemEntry = getParentNode(editor, paragraphPath);\n  if (!listItemEntry) return false;\n  const [listItemNode, listItemPath] = listItemEntry;\n\n  if (listItemNode.type !== liType) return false;\n\n  let success = false;\n\n  withoutNormalizing(editor, () => {\n    if (!Range.isCollapsed(editor.selection!)) {\n      deleteText(editor);\n    }\n\n    const isStart = isStartPoint(\n      editor,\n      editor.selection!.focus,\n      paragraphPath\n    );\n    const isEnd = isBlockTextEmptyAfterSelection(editor);\n\n    const nextParagraphPath = Path.next(paragraphPath);\n    const nextListItemPath = Path.next(listItemPath);\n\n    /**\n     * If start, insert a list item before\n     */\n    if (isStart) {\n      insertElements(\n        editor,\n        {\n          type: liType,\n          children: [{ type: licType, children: [{ text: '' }] }],\n        },\n        { at: listItemPath }\n      );\n\n      success = true;\n\n      return;\n    }\n\n    /**\n     * If not end, split nodes, wrap a list item on the new paragraph and move it to the next list item\n     */\n    if (!isEnd) {\n      withoutNormalizing(editor, () => {\n        splitNodes(editor);\n        wrapNodes<TElement>(\n          editor,\n          {\n            type: liType,\n            children: [],\n          },\n          { at: nextParagraphPath }\n        );\n        moveNodes(editor, {\n          at: nextParagraphPath,\n          to: nextListItemPath,\n        });\n        select(editor, nextListItemPath);\n        collapseSelection(editor, {\n          edge: 'start',\n        });\n      });\n    } else {\n      /**\n       * If end, insert a list item after and select it\n       */\n      const marks = getMarks(editor) || {};\n      insertElements(\n        editor,\n        {\n          type: liType,\n          children: [{ type: licType, children: [{ text: '', ...marks }] }],\n        },\n        { at: nextListItemPath }\n      );\n      select(editor, nextListItemPath);\n    }\n\n    /**\n     * If there is a list in the list item, move it to the next list item\n     */\n    if (listItemNode.children.length > 1) {\n      moveNodes(editor, {\n        at: nextParagraphPath,\n        to: nextListItemPath.concat(1),\n      });\n    }\n\n    success = true;\n  });\n\n  return success;\n};\n","import {\n  deleteText,\n  findDescendant,\n  getLastChildPath,\n  getParentNode,\n  insertElements,\n  moveChildren,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport { getListTypes } from '../queries/getListTypes';\n\nexport interface MoveListItemSublistItemsToListItemSublistOptions {\n  /**\n   * The list item to merge.\n   */\n  fromListItem: TElementEntry;\n\n  /**\n   * The list item where to merge.\n   */\n  toListItem: TElementEntry;\n\n  /**\n   * Move to the start of the list instead of the end.\n   */\n  start?: boolean;\n}\n\n/**\n * Move fromListItem sublist list items to the end of `toListItem` sublist.\n * If there is no `toListItem` sublist, insert one.\n */\nexport const moveListItemSublistItemsToListItemSublist = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    fromListItem,\n    toListItem,\n    start,\n  }: MoveListItemSublistItemsToListItemSublistOptions\n) => {\n  const [, fromListItemPath] = fromListItem;\n  const [, toListItemPath] = toListItem;\n  let moved = 0;\n\n  withoutNormalizing(editor, () => {\n    const fromListItemSublist = findDescendant<TElement>(editor, {\n      at: fromListItemPath,\n      match: {\n        type: getListTypes(editor),\n      },\n    });\n    if (!fromListItemSublist) return;\n\n    const [, fromListItemSublistPath] = fromListItemSublist;\n\n    const toListItemSublist = findDescendant<TElement>(editor, {\n      at: toListItemPath,\n      match: {\n        type: getListTypes(editor),\n      },\n    });\n\n    let to: Path;\n\n    if (!toListItemSublist) {\n      const fromList = getParentNode(editor, fromListItemPath);\n      if (!fromList) return;\n      const [fromListNode] = fromList;\n\n      const fromListType = fromListNode.type;\n\n      const toListItemSublistPath = toListItemPath.concat([1]);\n\n      insertElements(\n        editor,\n        { type: fromListType as string, children: [] },\n        { at: toListItemSublistPath }\n      );\n\n      to = toListItemSublistPath.concat([0]);\n    } else if (start) {\n      const [, toListItemSublistPath] = toListItemSublist;\n      to = toListItemSublistPath.concat([0]);\n    } else {\n      to = Path.next(getLastChildPath(toListItemSublist));\n    }\n\n    moved = moveChildren(editor, {\n      at: fromListItemSublistPath,\n      to,\n    });\n\n    // Remove the empty list\n    deleteText(editor, { at: fromListItemSublistPath });\n  });\n\n  return moved;\n};\n","import {\n  getNode,\n  match,\n  moveChildren,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport { getListTypes } from '../queries/getListTypes';\n\nexport const moveListSiblingsAfterCursor = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    at,\n    to,\n  }: {\n    at: Path;\n    to: Path;\n  }\n): number => {\n  const offset = at[at.length - 1];\n  at = Path.parent(at);\n  const listNode = getNode<TElement>(editor, at)!;\n  const listEntry: TElementEntry = [listNode, at];\n\n  if (\n    !match(listNode, [], { type: getListTypes(editor) }) ||\n    Path.isParent(at, to) // avoid moving nodes within its own list\n  ) {\n    return 0;\n  }\n\n  return moveChildren(editor, {\n    at: listEntry as any,\n    to,\n    fromStartIndex: offset + 1,\n  });\n};\n","import {\n  createPathRef,\n  deleteMerge,\n  getNodeEntry,\n  getPluginType,\n  getPreviousPath,\n  insertElements,\n  isExpanded,\n  PlateEditor,\n  removeNodes,\n  TElement,\n  TElementEntry,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport { ELEMENT_LI, ELEMENT_LIC } from '../createListPlugin';\nimport { hasListChild } from '../queries/hasListChild';\nimport { moveListItemsToList } from './moveListItemsToList';\nimport { moveListItemSublistItemsToListItemSublist } from './moveListItemSublistItemsToListItemSublist';\n\nexport interface RemoveListItemOptions {\n  list: TElementEntry;\n  listItem: TElementEntry;\n  reverse?: boolean;\n}\n\n/**\n * Remove list item and move its sublist to list if any.\n */\nexport const removeListItem = <V extends Value>(\n  editor: PlateEditor<V>,\n  { list, listItem, reverse = true }: RemoveListItemOptions\n) => {\n  const [liNode, liPath] = listItem;\n\n  // Stop if the list item has no sublist\n  if (isExpanded(editor.selection) || !hasListChild(editor, liNode)) {\n    return false;\n  }\n\n  const previousLiPath = getPreviousPath(liPath);\n\n  let success = false;\n\n  withoutNormalizing(editor, () => {\n    /**\n     * If there is a previous li, we need to move sub-lis to the previous li.\n     * As we need to delete first, we will:\n     * 1. insert a temporary li: tempLi\n     * 2. move sub-lis to tempLi\n     * 3. delete\n     * 4. move sub-lis from tempLi to the previous li.\n     * 5. remove tempLi\n     */\n    if (previousLiPath) {\n      const previousLi = getNodeEntry<TElement>(editor, previousLiPath);\n      if (!previousLi) return;\n\n      // 1\n      let tempLiPath = Path.next(liPath);\n      insertElements(\n        editor,\n        {\n          type: getPluginType(editor, ELEMENT_LI),\n          children: [\n            {\n              type: getPluginType(editor, ELEMENT_LIC),\n              children: [{ text: '' }],\n            },\n          ],\n        },\n        { at: tempLiPath }\n      );\n\n      const tempLi = getNodeEntry<TElement>(editor, tempLiPath);\n      if (!tempLi) return;\n      const tempLiPathRef = createPathRef(editor, tempLi[1]);\n\n      // 2\n      moveListItemSublistItemsToListItemSublist(editor, {\n        fromListItem: listItem,\n        toListItem: tempLi,\n      });\n\n      // 3\n      deleteMerge(editor, {\n        reverse,\n      });\n\n      tempLiPath = tempLiPathRef.unref()!;\n\n      // 4\n      moveListItemSublistItemsToListItemSublist(editor, {\n        fromListItem: [tempLi[0], tempLiPath],\n        toListItem: previousLi,\n      });\n\n      // 5\n      removeNodes(editor, { at: tempLiPath });\n\n      success = true;\n      return;\n    }\n\n    // If it's the first li, move the sublist to the parent list\n    moveListItemsToList(editor, {\n      fromListItem: listItem,\n      toList: list,\n      toListIndex: 1,\n    });\n  });\n\n  return success;\n};\n","import {\n  ELEMENT_DEFAULT,\n  findNode,\n  getBlockAbove,\n  getCommonNode,\n  getNodeEntries,\n  getPluginOptions,\n  getPluginType,\n  isCollapsed,\n  isElement,\n  isRangeAcrossBlocks,\n  PlateEditor,\n  setElements,\n  TElement,\n  Value,\n  withoutNormalizing,\n  wrapNodes,\n} from '@udecode/plate-common';\nimport { Range } from 'slate';\nimport { ELEMENT_LI, ELEMENT_LIC } from '../createListPlugin';\nimport { getListItemEntry, getListTypes } from '../queries';\nimport { ListPlugin } from '../types';\nimport { unwrapList } from './unwrapList';\n\nexport const toggleList = <V extends Value>(\n  editor: PlateEditor<V>,\n  { type, pluginKey = type }: { type: string; pluginKey?: string }\n) =>\n  withoutNormalizing(editor, () => {\n    if (!editor.selection) {\n      return;\n    }\n\n    const { validLiChildrenTypes } = getPluginOptions<ListPlugin, V>(\n      editor,\n      pluginKey\n    );\n\n    if (isCollapsed(editor.selection) || !isRangeAcrossBlocks(editor)) {\n      // selection is collapsed\n      const res = getListItemEntry(editor);\n\n      if (res) {\n        const { list } = res;\n        if (list[0].type !== type) {\n          setElements(\n            editor,\n            { type },\n            {\n              at: editor.selection,\n              match: (n) =>\n                isElement(n) && getListTypes(editor).includes(n.type),\n              mode: 'lowest',\n            }\n          );\n        } else {\n          unwrapList(editor);\n        }\n      } else {\n        const list = { type, children: [] };\n        wrapNodes<TElement>(editor, list);\n\n        const _nodes = getNodeEntries(editor, {\n          match: { type: getPluginType(editor, ELEMENT_DEFAULT) },\n        });\n        const nodes = Array.from(_nodes);\n\n        const blockAbove = getBlockAbove(editor, {\n          match: { type: validLiChildrenTypes },\n        });\n        if (!blockAbove) {\n          setElements(editor, {\n            type: getPluginType(editor, ELEMENT_LIC),\n          });\n        }\n\n        const listItem = {\n          type: getPluginType(editor, ELEMENT_LI),\n          children: [],\n        };\n\n        for (const [, path] of nodes) {\n          wrapNodes<TElement>(editor, listItem, {\n            at: path,\n          });\n        }\n      }\n    } else {\n      // selection is a range\n\n      const [startPoint, endPoint] = Range.edges(editor.selection!);\n      const commonEntry = getCommonNode<TElement>(\n        editor,\n        startPoint.path,\n        endPoint.path\n      );\n\n      if (\n        getListTypes(editor).includes(commonEntry[0].type) ||\n        (commonEntry[0] as TElement).type === getPluginType(editor, ELEMENT_LI)\n      ) {\n        if ((commonEntry[0] as TElement).type !== type) {\n          const startList = findNode(editor, {\n            at: Range.start(editor.selection),\n            match: { type: getListTypes(editor) },\n            mode: 'lowest',\n          });\n          const endList = findNode(editor, {\n            at: Range.end(editor.selection),\n            match: { type: getListTypes(editor) },\n            mode: 'lowest',\n          });\n          const rangeLength = Math.min(\n            startList![1].length,\n            endList![1].length\n          );\n          setElements(\n            editor,\n            { type },\n            {\n              at: editor.selection,\n              match: (n, path) =>\n                isElement(n) &&\n                getListTypes(editor).includes(n.type) &&\n                path.length >= rangeLength,\n              mode: 'all',\n            }\n          );\n        } else {\n          unwrapList(editor);\n        }\n      } else {\n        const rootPathLength = commonEntry[1].length;\n        const _nodes = getNodeEntries<TElement>(editor, {\n          mode: 'all',\n        });\n        const nodes = Array.from(_nodes).filter(\n          ([, path]) => path.length === rootPathLength + 1\n        );\n\n        nodes.forEach((n) => {\n          if (getListTypes(editor).includes(n[0].type)) {\n            setElements(\n              editor,\n              { type },\n              {\n                at: n[1],\n                match: (_n) =>\n                  isElement(_n) && getListTypes(editor).includes(_n.type),\n                mode: 'all',\n              }\n            );\n          } else {\n            if (!validLiChildrenTypes?.includes(n[0].type)) {\n              setElements(\n                editor,\n                { type: getPluginType(editor, ELEMENT_LIC) },\n                { at: n[1] }\n              );\n            }\n\n            const listItem = {\n              type: getPluginType(editor, ELEMENT_LI),\n              children: [],\n            };\n            wrapNodes<TElement>(editor, listItem, {\n              at: n[1],\n            });\n\n            const list = { type, children: [] };\n            wrapNodes<TElement>(editor, list, { at: n[1] });\n          }\n        });\n      }\n    }\n  });\n","import { PlateEditor, Value } from '@udecode/plate-common';\nimport { moveListItems, MoveListItemsOptions } from './moveListItems';\n\nexport type UnindentListItemsOptions = Omit<MoveListItemsOptions, 'increase'>;\n\nexport const unindentListItems = <V extends Value>(\n  editor: PlateEditor<V>,\n  options: UnindentListItemsOptions = {}\n) => moveListItems(editor, { ...options, increase: false });\n","import {\n  getPluginType,\n  Hotkeys,\n  isCollapsed,\n  KeyboardHandlerReturnType,\n  PlateEditor,\n  select,\n  someNode,\n  unhangRange,\n  Value,\n  WithPlatePlugin,\n} from '@udecode/plate-common';\nimport isHotkey from 'is-hotkey';\nimport { castArray } from 'lodash';\nimport { Range } from 'slate';\nimport { ELEMENT_LI } from './createListPlugin';\nimport { moveListItems, toggleList } from './transforms';\nimport { ListPlugin } from './types';\n\nexport const onKeyDownList = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  {\n    type,\n    options: { hotkey, enableResetOnShiftTab },\n  }: WithPlatePlugin<ListPlugin, V, E>\n): KeyboardHandlerReturnType => (e) => {\n  if (e.defaultPrevented) return;\n\n  const isTab = Hotkeys.isTab(editor, e);\n  const isUntab = Hotkeys.isUntab(editor, e);\n\n  let workRange = editor.selection;\n\n  if (editor.selection && (isTab || isUntab)) {\n    const { selection } = editor;\n\n    // Unhang the expanded selection\n    if (!isCollapsed(editor.selection)) {\n      const { anchor, focus } = Range.isBackward(selection)\n        ? { anchor: { ...selection.focus }, focus: { ...selection.anchor } }\n        : { anchor: { ...selection.anchor }, focus: { ...selection.focus } };\n\n      // This is a workaround for a Slate bug\n      // See: https://github.com/ianstormtaylor/slate/pull/5039\n      const unHungRange = unhangRange(editor, { anchor, focus });\n      if (unHungRange) {\n        workRange = unHungRange;\n        select(editor, unHungRange);\n      }\n    }\n\n    // check if we're in a list context.\n    const listSelected = someNode(editor, {\n      match: { type: getPluginType(editor, ELEMENT_LI) },\n    });\n\n    if (workRange && listSelected) {\n      e.preventDefault();\n      moveListItems(editor, {\n        at: workRange,\n        increase: isTab,\n        enableResetOnShiftTab,\n      });\n      return true;\n    }\n  }\n\n  if (!hotkey) return;\n\n  const hotkeys = castArray(hotkey);\n\n  for (const _hotkey of hotkeys) {\n    if (isHotkey(_hotkey)(e as any)) {\n      toggleList(editor, { type: type! });\n    }\n  }\n};\n","import {\n  deleteMerge,\n  ELEMENT_DEFAULT,\n  getPluginType,\n  isFirstChild,\n  isSelectionAtBlockStart,\n  mockPlugin,\n  PlateEditor,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-common';\nimport {\n  onKeyDownResetNode,\n  ResetNodePlugin,\n  SIMULATE_BACKSPACE,\n} from '@udecode/plate-reset-node';\nimport { getListItemEntry } from './queries/getListItemEntry';\nimport { isListNested } from './queries/isListNested';\nimport { removeFirstListItem } from './transforms/removeFirstListItem';\nimport { removeListItem } from './transforms/removeListItem';\nimport { unwrapList } from './transforms/unwrapList';\nimport { ELEMENT_LI } from './createListPlugin';\n\nexport const deleteBackwardList = <V extends Value>(\n  editor: PlateEditor<V>,\n  unit: 'character' | 'word' | 'line' | 'block'\n) => {\n  const res = getListItemEntry(editor, {});\n\n  let moved: boolean | undefined = false;\n\n  if (res) {\n    const { list, listItem } = res;\n\n    if (\n      isSelectionAtBlockStart(editor, {\n        match: (node) => node.type === getPluginType(editor, ELEMENT_LI),\n      })\n    ) {\n      withoutNormalizing(editor, () => {\n        moved = removeFirstListItem(editor, { list, listItem });\n        if (moved) return true;\n\n        moved = removeListItem(editor, { list, listItem });\n        if (moved) return true;\n\n        if (isFirstChild(listItem[1]) && !isListNested(editor, list[1])) {\n          onKeyDownResetNode(\n            editor as any,\n            mockPlugin<ResetNodePlugin>({\n              options: {\n                rules: [\n                  {\n                    types: [getPluginType(editor, ELEMENT_LI)],\n                    defaultType: getPluginType(editor, ELEMENT_DEFAULT),\n                    hotkey: 'backspace',\n                    predicate: () => isSelectionAtBlockStart(editor),\n                    onReset: (e) => unwrapList(e),\n                  },\n                ],\n              },\n            })\n          )(SIMULATE_BACKSPACE);\n          moved = true;\n          return;\n        }\n\n        deleteMerge(editor, {\n          unit,\n          reverse: true,\n        });\n        moved = true;\n      });\n    }\n  }\n\n  return moved;\n};\n","import {\n  getBlockAbove,\n  getChildren,\n  getEditorString,\n  getNode,\n  getNodeEntries,\n  getNodeEntry,\n  getParentNode,\n  getPluginType,\n  getPointAfter,\n  isSelectionAtBlockEnd,\n  PlateEditor,\n  removeNodes,\n  TElement,\n  TElementEntry,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport { ELEMENT_LI } from './createListPlugin';\nimport { getListItemEntry, getListRoot, hasListChild } from './queries';\nimport {\n  moveListItemsToList,\n  moveListItemUp,\n  removeFirstListItem,\n  removeListItem,\n} from './transforms';\n\nconst selectionIsNotInAListHandler = <V extends Value>(\n  editor: PlateEditor<V>\n): boolean => {\n  const pointAfterSelection = getPointAfter(\n    editor,\n    editor.selection!.focus.path\n  );\n\n  if (pointAfterSelection) {\n    // there is a block after it\n    const nextSiblingListRes = getListItemEntry(editor, {\n      at: pointAfterSelection,\n    });\n\n    if (nextSiblingListRes) {\n      // the next block is a list\n      const { listItem } = nextSiblingListRes;\n      const parentBlockEntity = getBlockAbove(editor, {\n        at: editor.selection!.anchor,\n      });\n\n      if (!getEditorString(editor, parentBlockEntity![1])) {\n        // the selected block is empty\n        removeNodes(editor);\n\n        return true;\n      }\n\n      if (hasListChild(editor, listItem[0])) {\n        // the next block has children, so we have to move the first item up\n        const sublistRes = getListItemEntry(editor, {\n          at: [...listItem[1], 1, 0, 0],\n        });\n\n        moveListItemUp(editor, sublistRes!);\n      }\n    }\n  }\n\n  return false;\n};\n\nconst selectionIsInAListHandler = <V extends Value>(\n  editor: PlateEditor<V>,\n  res: { list: TElementEntry; listItem: TElementEntry }\n): boolean => {\n  const { listItem } = res;\n\n  // if it has no children\n  if (!hasListChild(editor, listItem[0])) {\n    const liType = getPluginType(editor, ELEMENT_LI);\n    const _nodes = getNodeEntries(editor, {\n      at: listItem[1],\n      mode: 'lowest',\n      match: (node, path) => {\n        if (path.length === 0) {\n          return false;\n        }\n\n        const isNodeLi = (node as TElement).type === liType;\n        const isSiblingOfNodeLi =\n          getNode<TElement>(editor, Path.next(path))?.type === liType;\n\n        return isNodeLi && isSiblingOfNodeLi;\n      },\n    });\n    const liWithSiblings = Array.from(_nodes, (entry) => entry[1])[0];\n\n    if (!liWithSiblings) {\n      // there are no more list item in the list\n      const pointAfterListItem = getPointAfter(editor, listItem[1]);\n\n      if (pointAfterListItem) {\n        // there is a block after it\n        const nextSiblingListRes = getListItemEntry(editor, {\n          at: pointAfterListItem,\n        });\n\n        if (nextSiblingListRes) {\n          // it is a list so we merge the lists\n          const listRoot = getListRoot(editor, listItem[1]);\n\n          moveListItemsToList(editor, {\n            fromList: nextSiblingListRes.list,\n            toList: listRoot,\n            deleteFromList: true,\n          });\n\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    const siblingListItem = getNodeEntry<TElement>(\n      editor,\n      Path.next(liWithSiblings)\n    );\n    if (!siblingListItem) return false;\n\n    const siblingList = getParentNode<TElement>(editor, siblingListItem[1]);\n\n    if (\n      siblingList &&\n      removeListItem(editor, {\n        list: siblingList,\n        listItem: siblingListItem,\n        reverse: false,\n      })\n    ) {\n      return true;\n    }\n\n    // if (skipDefaultDelete) return skipDefaultDelete;\n\n    return false;\n  }\n\n  // if it has children\n  const nestedList = getNodeEntry<TElement>(\n    editor,\n    Path.next([...listItem[1], 0])\n  );\n  if (!nestedList) return false;\n\n  const nestedListItem = getChildren<TElement>(nestedList)[0];\n\n  if (\n    removeFirstListItem(editor, {\n      list: nestedList,\n      listItem: nestedListItem,\n    })\n  ) {\n    return true;\n  }\n\n  if (\n    removeListItem(editor, {\n      list: nestedList,\n      listItem: nestedListItem,\n    })\n  ) {\n    return true;\n  }\n\n  return false;\n};\n\nexport const deleteForwardList = <V extends Value>(editor: PlateEditor<V>) => {\n  let skipDefaultDelete = false;\n\n  if (!editor?.selection) {\n    return skipDefaultDelete;\n  }\n\n  if (!isSelectionAtBlockEnd(editor)) {\n    return skipDefaultDelete;\n  }\n\n  withoutNormalizing(editor, () => {\n    const res = getListItemEntry(editor, {});\n\n    if (!res) {\n      skipDefaultDelete = selectionIsNotInAListHandler(editor);\n      return;\n    }\n\n    skipDefaultDelete = selectionIsInAListHandler(editor, res);\n  });\n\n  return skipDefaultDelete;\n};\n","import {\n  createPathRef,\n  deleteMerge,\n  getAboveNode,\n  getEndPoint,\n  getParentNode,\n  getPluginType,\n  getStartPoint,\n  PlateEditor,\n  removeNodes,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-common';\nimport { Range } from 'slate';\nimport { getHighestEmptyList } from './queries/getHighestEmptyList';\nimport { hasListChild } from './queries/hasListChild';\nimport { isAcrossListItems } from './queries/isAcrossListItems';\nimport { ELEMENT_LI } from './createListPlugin';\n\nexport const deleteFragmentList = <V extends Value>(editor: PlateEditor<V>) => {\n  let deleted = false;\n\n  withoutNormalizing(editor, () => {\n    // Selection should be across list items\n    if (!isAcrossListItems(editor)) return;\n\n    /**\n     * Check if the end li can be deleted (if it has no sublist).\n     * Store the path ref to delete it after deleteMerge.\n     */\n    const end = getEndPoint(editor, editor.selection as Range);\n    const liEnd = getAboveNode(editor, {\n      at: end,\n      match: { type: getPluginType(editor, ELEMENT_LI) },\n    });\n    const liEndCanBeDeleted = liEnd && !hasListChild(editor, liEnd[0]);\n    const liEndPathRef = liEndCanBeDeleted\n      ? createPathRef(editor, liEnd![1])\n      : undefined;\n\n    /**\n     * Delete fragment and move end block children to start block\n     */\n    deleteMerge(editor);\n\n    const start = getStartPoint(editor, editor.selection as Range);\n    const liStart = getAboveNode(editor, {\n      at: start,\n      match: { type: getPluginType(editor, ELEMENT_LI) },\n    });\n\n    if (liEndPathRef) {\n      const liEndPath = liEndPathRef.unref()!;\n\n      const listStart = liStart && getParentNode(editor, liStart[1]);\n\n      const deletePath = getHighestEmptyList(editor, {\n        liPath: liEndPath,\n        diffListPath: listStart?.[1],\n      });\n\n      if (deletePath) {\n        removeNodes(editor, { at: deletePath });\n      }\n\n      deleted = true;\n    }\n  });\n\n  return deleted;\n};\n","import {\n  ELEMENT_DEFAULT,\n  getPluginType,\n  isBlockAboveEmpty,\n  mockPlugin,\n  PlateEditor,\n  Value,\n} from '@udecode/plate-common';\nimport {\n  onKeyDownResetNode,\n  ResetNodePlugin,\n  SIMULATE_BACKSPACE,\n} from '@udecode/plate-reset-node';\nimport { getListItemEntry } from './queries/getListItemEntry';\nimport { insertListItem } from './transforms/insertListItem';\nimport { moveListItemUp } from './transforms/moveListItemUp';\nimport { unwrapList } from './transforms/unwrapList';\nimport { ELEMENT_LI } from './createListPlugin';\n\nexport const insertBreakList = <V extends Value>(editor: PlateEditor<V>) => {\n  if (!editor.selection) return;\n\n  const res = getListItemEntry(editor, {});\n  let moved: boolean | undefined;\n\n  // If selection is in a li\n  if (res) {\n    const { list, listItem } = res;\n\n    // If selected li is empty, move it up.\n    if (isBlockAboveEmpty(editor)) {\n      moved = moveListItemUp(editor, {\n        list,\n        listItem,\n      });\n\n      if (moved) return true;\n    }\n  }\n\n  const didReset = onKeyDownResetNode(\n    editor as any,\n    mockPlugin<ResetNodePlugin>({\n      options: {\n        rules: [\n          {\n            types: [getPluginType(editor, ELEMENT_LI)],\n            defaultType: getPluginType(editor, ELEMENT_DEFAULT),\n            predicate: () => !moved && isBlockAboveEmpty(editor),\n            onReset: (_editor) => unwrapList(_editor),\n          },\n        ],\n      },\n    })\n  )(SIMULATE_BACKSPACE as any);\n  if (didReset) return true;\n\n  /**\n   * If selection is in li > p, insert li.\n   */\n  if (!moved) {\n    const inserted = insertListItem(editor);\n    if (inserted) return true;\n  }\n};\n","import {\n  findNode,\n  getCommonNode,\n  getNode,\n  getNodes,\n  getNodeString,\n  getNodeTexts,\n  getPlugin,\n  insertElements,\n  isElement,\n  PlateEditor,\n  removeNodes,\n  TAncestor,\n  TAncestorEntry,\n  TDescendant,\n  TDescendantEntry,\n  TElement,\n  TElementEntry,\n  TText,\n  Value,\n  WithPlatePlugin,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport { ELEMENT_LI } from './createListPlugin';\nimport { getListItemContentType, getListItemType, isListRoot } from './queries';\n\nexport const insertFragmentList = <V extends Value>(editor: PlateEditor<V>) => {\n  const { insertFragment } = editor;\n\n  const listItemPlugin = getPlugin<{}, V>(editor, ELEMENT_LI);\n  const listItemType = getListItemType(editor);\n  const listItemContentType = getListItemContentType(editor);\n\n  const getFirstAncestorOfType = (\n    root: TDescendant,\n    entry: TDescendantEntry,\n    { type }: WithPlatePlugin\n  ): TAncestorEntry => {\n    let ancestor: Path = Path.parent(entry[1]);\n    while (getNode<TElement>(root, ancestor)!.type !== type) {\n      ancestor = Path.parent(ancestor);\n    }\n\n    return [getNode<TAncestor>(root, ancestor)!, ancestor];\n  };\n\n  const findListItemsWithContent = (first: TDescendant): TDescendant[] => {\n    let prev = null;\n    let node = first;\n    while (\n      isListRoot(editor, node) ||\n      (node.type === listItemType &&\n        (node.children as TElement[])[0].type !== listItemContentType)\n    ) {\n      prev = node;\n      [node] = node.children as TDescendant[];\n    }\n\n    return prev ? (prev.children as TDescendant[]) : [node];\n  };\n\n  /**\n   * Removes the \"empty\" leading lis. Empty in this context means lis only with other lis as children.\n   *\n   * @returns If argument is not a list root, returns it, otherwise returns ul[] or li[].\n   */\n  const trimList = (listRoot: TDescendant): TElement[] => {\n    if (!isListRoot(editor, listRoot)) {\n      return [listRoot as TElement];\n    }\n\n    const _texts = getNodeTexts(listRoot);\n    const textEntries = Array.from(_texts);\n\n    const commonAncestorEntry = textEntries.reduce(\n      (commonAncestor, textEntry) =>\n        Path.isAncestor(commonAncestor[1], textEntry[1])\n          ? commonAncestor\n          : (getCommonNode(listRoot, textEntry[1], commonAncestor[1]) as any),\n      // any list item would do, we grab the first one\n      getFirstAncestorOfType(listRoot, textEntries[0], listItemPlugin as any)\n    );\n\n    const [first, ...rest] = isListRoot(\n      editor,\n      commonAncestorEntry[0] as TDescendant\n    )\n      ? (commonAncestorEntry[0] as any).children\n      : [commonAncestorEntry[0]];\n    return [...findListItemsWithContent(first), ...rest];\n  };\n\n  const wrapNodeIntoListItem = (node: TDescendant): TElement => {\n    return node.type === listItemType\n      ? (node as TElement)\n      : ({\n          type: listItemType,\n          children: [node],\n        } as TElement);\n  };\n\n  /**\n   * Checks if the fragment only consists of a single LIC in which case it is considered the user's intention was to copy a text, not a list\n   */\n  const isSingleLic = (fragment: TDescendant[]) => {\n    const isFragmentOnlyListRoot =\n      fragment.length === 1 && isListRoot(editor, fragment[0]);\n\n    return (\n      isFragmentOnlyListRoot &&\n      [...getNodes({ children: fragment } as any)]\n        .filter((entry): entry is TElementEntry => isElement(entry[0]))\n        .filter(([node]) => node.type === listItemContentType).length === 1\n    );\n  };\n\n  const getTextAndListItemNodes = (\n    fragment: TDescendant[],\n    liEntry: TElementEntry,\n    licEntry: TElementEntry\n  ) => {\n    const [, liPath] = liEntry;\n    const [licNode, licPath] = licEntry;\n    const isEmptyNode = !getNodeString(licNode);\n    const [first, ...rest] = fragment\n      .flatMap(trimList)\n      .map(wrapNodeIntoListItem);\n    let textNode: TText;\n    let listItemNodes: TElement[];\n    if (isListRoot(editor, fragment[0])) {\n      if (isSingleLic(fragment)) {\n        textNode = first as any;\n        listItemNodes = rest as TElement[];\n      } else if (isEmptyNode) {\n        // FIXME: is there a more direct way to set this?\n        const li = getNode(editor, liPath);\n        const [, ...currentSublists] = li!.children as TElement[];\n        const [newLic, ...newSublists] = first.children as TElement[];\n        insertElements(editor, newLic, {\n          at: Path.next(licPath),\n          select: true,\n        });\n        removeNodes(editor, {\n          at: licPath,\n        });\n        if (newSublists?.length) {\n          if (currentSublists?.length) {\n            // TODO: any better way to compile the path where the LIs of the newly inserted element will be inserted?\n            const path = [...liPath, 1, 0];\n            insertElements(editor, newSublists[0].children as TElement[], {\n              at: path,\n              select: true,\n            });\n          } else {\n            insertElements(editor, newSublists, {\n              at: Path.next(licPath),\n              select: true,\n            });\n          }\n        }\n\n        textNode = { text: '' };\n        listItemNodes = rest as TElement[];\n      } else {\n        textNode = { text: '' };\n        listItemNodes = [first as TElement, ...(rest as TElement[])];\n      }\n    } else {\n      textNode = first as any;\n      listItemNodes = rest as TElement[];\n    }\n\n    return { textNode, listItemNodes };\n  };\n\n  return (fragment: TDescendant[]) => {\n    let liEntry = findNode<TElement>(editor, {\n      match: { type: listItemType },\n      mode: 'lowest',\n    });\n    // not inserting into a list item, delegate to other plugins\n    if (!liEntry) {\n      return insertFragment(\n        isListRoot(editor, fragment[0]) ? [{ text: '' }, ...fragment] : fragment\n      );\n    }\n\n    // delete selection (if necessary) so that it can check if needs to insert into an empty block\n    insertFragment([{ text: '' }] as any);\n\n    // refetch to find the currently selected LI after the deletion above is performed\n    liEntry = findNode<TElement>(editor, {\n      match: { type: listItemType },\n      mode: 'lowest',\n    });\n\n    const licEntry = findNode<TElement>(editor, {\n      match: { type: listItemContentType },\n      mode: 'lowest',\n    });\n    if (!licEntry) {\n      return insertFragment(\n        isListRoot(editor, fragment[0]) ? [{ text: '' }, ...fragment] : fragment\n      );\n    }\n\n    const { textNode, listItemNodes } = getTextAndListItemNodes(\n      fragment,\n      liEntry!,\n      licEntry\n    );\n\n    insertFragment<TText>([textNode]); // insert text if needed\n\n    const [, liPath] = liEntry!;\n\n    return insertElements(editor, listItemNodes, {\n      at: Path.next(liPath),\n      select: true,\n    });\n  };\n};\n","import {\n  createPathRef,\n  getChildren,\n  getParentNode,\n  getPluginType,\n  insertEmptyElement,\n  isBlock,\n  match,\n  moveNodes,\n  PlateEditor,\n  removeNodes,\n  setElements,\n  TDescendant,\n  TElement,\n  TElementEntry,\n  TNodeEntry,\n  Value,\n} from '@udecode/plate-common';\nimport { Path, PathRef } from 'slate';\nimport { ELEMENT_LIC, ELEMENT_OL, ELEMENT_UL } from '../createListPlugin';\nimport { getListTypes } from '../queries';\nimport { moveListItemUp } from '../transforms';\nimport { ListPlugin } from '../types';\n\n/**\n * Recursively get all the:\n * - block children\n * - inline children except those at excludeDepth\n */\nexport const getDeepInlineChildren = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    children,\n  }: {\n    children: TNodeEntry<TDescendant>[];\n  }\n) => {\n  const inlineChildren: TNodeEntry<TDescendant>[] = [];\n\n  for (const child of children) {\n    if (isBlock(editor, child[0])) {\n      inlineChildren.push(\n        ...getDeepInlineChildren(editor, {\n          children: getChildren(child),\n        })\n      );\n    } else {\n      inlineChildren.push(child);\n    }\n  }\n\n  return inlineChildren;\n};\n\n/**\n * If the list item has no child: insert an empty list item container.\n * Else: move the children that are not valid to the list item container.\n */\nexport const normalizeListItem = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    listItem,\n    validLiChildrenTypes = [],\n  }: { listItem: TElementEntry } & ListPlugin\n) => {\n  let changed = false;\n\n  const allValidLiChildrenTypes = [\n    getPluginType(editor, ELEMENT_UL),\n    getPluginType(editor, ELEMENT_OL),\n    getPluginType(editor, ELEMENT_LIC),\n    ...validLiChildrenTypes,\n  ];\n\n  const [, liPath] = listItem;\n  const liChildren = getChildren<TElement>(listItem);\n\n  // Get invalid (type) li children path refs to be moved\n  const invalidLiChildrenPathRefs = liChildren\n    .filter(([child]) => !allValidLiChildrenTypes.includes(child.type))\n    .map(([, childPath]) => createPathRef(editor, childPath));\n\n  const firstLiChild: TElementEntry | undefined = liChildren[0];\n  const [firstLiChildNode, firstLiChildPath] = firstLiChild ?? [];\n\n  // If li has no child or inline child, insert lic\n  if (!firstLiChild || !isBlock(editor, firstLiChildNode)) {\n    insertEmptyElement(editor, getPluginType(editor, ELEMENT_LIC), {\n      at: liPath.concat([0]),\n    });\n    return true;\n  }\n\n  // If first li child is a block but not lic, set it to lic\n  if (\n    isBlock(editor, firstLiChildNode) &&\n    !match(firstLiChildNode, [], {\n      type: getPluginType(editor, ELEMENT_LIC),\n    })\n  ) {\n    if (\n      match(firstLiChildNode, [], {\n        type: getListTypes(editor),\n      })\n    ) {\n      // the listItem has no lic so we move the children up a level\n      const parent = getParentNode(editor, listItem[1]);\n      const sublist = firstLiChild;\n      const children = getChildren<TElement>(firstLiChild).reverse();\n      children.forEach((c) => {\n        moveListItemUp(editor, {\n          list: sublist,\n          listItem: c,\n        });\n      });\n\n      removeNodes(editor, { at: [...parent![1], 0] });\n\n      return true;\n    }\n\n    // Allow block elements listed as valid li children types to be a first child instead of LIC\n    if (validLiChildrenTypes.includes(firstLiChildNode.type)) {\n      return true;\n    }\n\n    setElements(\n      editor,\n      {\n        type: getPluginType(editor, ELEMENT_LIC),\n      },\n      {\n        at: firstLiChildPath,\n      }\n    );\n\n    changed = true;\n  }\n\n  const licChildren = getChildren(firstLiChild);\n\n  if (licChildren.length) {\n    const blockPathRefs: PathRef[] = [];\n    const inlineChildren: TNodeEntry[] = [];\n\n    // Check that lic has no block children\n    for (const licChild of licChildren) {\n      if (!isBlock(editor, licChild[0])) {\n        break;\n      }\n\n      blockPathRefs.push(createPathRef(editor, licChild[1]));\n\n      inlineChildren.push(\n        ...getDeepInlineChildren(editor, {\n          children: getChildren(licChild),\n        })\n      );\n    }\n\n    const to = Path.next(licChildren[licChildren.length - 1]?.[1]);\n\n    // Move lic nested inline children to its children\n    inlineChildren.reverse().forEach(([, path]) => {\n      moveNodes(editor, {\n        at: path,\n        to,\n      });\n    });\n\n    // Remove lic block children\n    blockPathRefs.forEach((pathRef) => {\n      const path = pathRef.unref();\n\n      path &&\n        removeNodes(editor, {\n          at: path,\n        });\n    });\n\n    if (blockPathRefs.length) {\n      changed = true;\n    }\n  }\n\n  if (changed) return true;\n\n  // Ensure that any text nodes under the list are inside the list item container\n  invalidLiChildrenPathRefs.reverse().forEach((ref) => {\n    const path = ref.unref();\n\n    path &&\n      moveNodes(editor, {\n        at: path,\n        to: firstLiChildPath.concat([0]),\n      });\n  });\n\n  return !!invalidLiChildrenPathRefs.length;\n};\n","import {\n  getNodeEntry,\n  getParentNode,\n  match,\n  moveNodes,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport { getListTypes } from '../queries';\n\n// When pasting from e.g. Google Docs, the structure of nested lists like \"ul -> ul\"\n// should be normalized to \"ul -> li -> lic + ul\".\n// In other words, a nested list as a direct children of a list should be moved into a previous list item sibling\nexport const normalizeNestedList = <V extends Value>(\n  editor: PlateEditor<V>,\n  { nestedListItem }: { nestedListItem: TElementEntry }\n) => {\n  const [, path] = nestedListItem;\n\n  const parentNode = getParentNode(editor, path);\n  const hasParentList =\n    parentNode && match(parentNode[0], [], { type: getListTypes(editor) });\n  if (!hasParentList) {\n    return false;\n  }\n\n  let previousListItemPath: Path;\n  try {\n    previousListItemPath = Path.previous(path);\n  } catch (e) {\n    return false;\n  }\n\n  // Previous sibling is the new parent\n  const previousSiblingItem = getNodeEntry<TElement>(\n    editor,\n    previousListItemPath\n  );\n\n  if (previousSiblingItem) {\n    const [, previousPath] = previousSiblingItem;\n    const newPath = previousPath.concat([1]);\n\n    // Move the current item to the sublist\n    moveNodes(editor, {\n      at: path,\n      to: newPath,\n    });\n\n    return true;\n  }\n};\n","import {\n  ELEMENT_DEFAULT,\n  getChildren,\n  getNode,\n  getParentNode,\n  getPluginType,\n  getPreviousPath,\n  isElement,\n  match,\n  PlateEditor,\n  removeNodes,\n  setElements,\n  TElement,\n  TNodeEntry,\n  Value,\n  wrapNodes,\n} from '@udecode/plate-common';\nimport { Path } from 'slate';\nimport { ELEMENT_LI, ELEMENT_LIC } from '../createListPlugin';\nimport { getListTypes, isListRoot } from '../queries';\nimport { moveListItemsToList } from '../transforms';\nimport { ListPlugin } from '../types';\nimport { normalizeListItem } from './normalizeListItem';\nimport { normalizeNestedList } from './normalizeNestedList';\n\n/**\n * Normalize list node to force the ul>li>p+ul structure.\n */\nexport const normalizeList = <V extends Value>(\n  editor: PlateEditor<V>,\n  { validLiChildrenTypes }: ListPlugin\n) => {\n  const { normalizeNode } = editor;\n  const liType = getPluginType(editor, ELEMENT_LI);\n  const licType = getPluginType(editor, ELEMENT_LIC);\n  const defaultType = getPluginType(editor, ELEMENT_DEFAULT);\n\n  return ([node, path]: TNodeEntry) => {\n    if (!isElement(node)) {\n      return normalizeNode([node, path]);\n    }\n\n    if (isListRoot(editor, node)) {\n      const nonLiChild = getChildren([node, path]).find(\n        ([child]) => child.type !== liType\n      );\n\n      if (nonLiChild) {\n        return wrapNodes<TElement>(\n          editor,\n          { type: liType, children: [] },\n          { at: nonLiChild[1] }\n        );\n      }\n    }\n\n    // remove empty list\n    if (match(node, [], { type: getListTypes(editor) })) {\n      if (\n        !node.children.length ||\n        !node.children.find((item) => item.type === liType)\n      ) {\n        return removeNodes(editor, { at: path });\n      }\n\n      const nextPath = Path.next(path);\n      const nextNode = getNode<TElement>(editor, nextPath);\n\n      // Has a list afterwards with the same type\n      if (nextNode?.type === node.type) {\n        moveListItemsToList(editor, {\n          fromList: [nextNode, nextPath],\n          toList: [node, path],\n          deleteFromList: true,\n        });\n      }\n\n      const prevPath = getPreviousPath(path) as Path;\n      const prevNode = getNode<TElement>(editor, prevPath);\n\n      // Has a list before with the same type\n      if (prevNode?.type === node.type) {\n        editor.normalizeNode([prevNode, prevPath]);\n\n        // early return since this node will no longer exists\n        return;\n      }\n\n      if (normalizeNestedList(editor, { nestedListItem: [node, path] })) {\n        return;\n      }\n    }\n\n    if (node.type === getPluginType(editor, ELEMENT_LI)) {\n      if (\n        normalizeListItem(editor, {\n          listItem: [node, path],\n          validLiChildrenTypes,\n        })\n      ) {\n        return;\n      }\n    }\n\n    // LIC should have LI parent. If not, set LIC to DEFAULT type.\n    if (node.type === licType && licType !== defaultType) {\n      if (getParentNode(editor, path)?.[0].type !== liType) {\n        setElements(editor, { type: defaultType }, { at: path });\n        return;\n      }\n    }\n\n    normalizeNode([node, path]);\n  };\n};\n","import { PlateEditor, Value, WithPlatePlugin } from '@udecode/plate-common';\nimport { deleteBackwardList } from './deleteBackwardList';\nimport { deleteForwardList } from './deleteForwardList';\nimport { deleteFragmentList } from './deleteFragmentList';\nimport { insertBreakList } from './insertBreakList';\nimport { insertFragmentList } from './insertFragmentList';\nimport { normalizeList } from './normalizers';\nimport { ListPlugin } from './types';\n\nexport const withList = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  { options: { validLiChildrenTypes } }: WithPlatePlugin<ListPlugin, V, E>\n) => {\n  const { insertBreak, deleteBackward, deleteForward, deleteFragment } = editor;\n\n  editor.insertBreak = () => {\n    if (insertBreakList(editor)) return;\n\n    insertBreak();\n  };\n\n  editor.deleteBackward = (unit) => {\n    if (deleteBackwardList(editor, unit)) return;\n\n    deleteBackward(unit);\n  };\n\n  editor.deleteForward = (unit) => {\n    if (deleteForwardList(editor)) return;\n\n    deleteForward(unit);\n  };\n\n  editor.deleteFragment = (direction) => {\n    if (deleteFragmentList(editor)) return;\n\n    deleteFragment(direction);\n  };\n\n  editor.insertFragment = insertFragmentList(editor);\n\n  editor.normalizeNode = normalizeList(editor, { validLiChildrenTypes });\n\n  return editor;\n};\n","import {\n  createPluginFactory,\n  KEY_DESERIALIZE_HTML,\n  PlatePlugin,\n  someNode,\n} from '@udecode/plate-common';\nimport { onKeyDownList } from './onKeyDownList';\nimport { ListPlugin } from './types';\nimport { withList } from './withList';\n\nexport const ELEMENT_UL = 'ul';\nexport const ELEMENT_OL = 'ol';\nexport const ELEMENT_LI = 'li';\nexport const ELEMENT_LIC = 'lic';\n\n/**\n * Enables support for bulleted, numbered and to-do lists.\n */\nexport const createListPlugin = createPluginFactory({\n  key: 'list',\n  plugins: [\n    {\n      key: ELEMENT_UL,\n      isElement: true,\n      handlers: {\n        onKeyDown: onKeyDownList,\n      },\n      withOverrides: withList,\n      deserializeHtml: {\n        rules: [\n          {\n            validNodeName: 'UL',\n          },\n        ],\n      },\n    } as PlatePlugin<ListPlugin>,\n    {\n      key: ELEMENT_OL,\n      isElement: true,\n      handlers: {\n        onKeyDown: onKeyDownList,\n      },\n      deserializeHtml: { rules: [{ validNodeName: 'OL' }] },\n    } as PlatePlugin<ListPlugin>,\n    {\n      key: ELEMENT_LI,\n      isElement: true,\n      deserializeHtml: { rules: [{ validNodeName: 'LI' }] },\n      then: (editor, { type }) => ({\n        inject: {\n          pluginsByKey: {\n            [KEY_DESERIALIZE_HTML]: {\n              editor: {\n                insertData: {\n                  preInsert: () => {\n                    return someNode(editor, { match: { type } });\n                  },\n                },\n              },\n            },\n          },\n        },\n      }),\n    },\n    {\n      key: ELEMENT_LIC,\n      isElement: true,\n    },\n  ],\n});\n"],"names":["isArray","isListNested","editor","listPath","listParentNode","getParentNode","type","getPluginType","ELEMENT_LI","getUnorderedListType","ELEMENT_UL","getOrderedListType","ELEMENT_OL","getListTypes","getListItemType","getListItemContentType","ELEMENT_LIC","getHighestEmptyList","diffListPath","liPath","list","getAboveNode","at","match","listNode","Path","equals","children","length","liParent","getListItemEntry","selection","liType","_at","Range","isRange","isCollapsed","focus","path","anchor","node","getNode","listItem","getListRoot","parentList","parentListPath","insertTodoListItem","inheritCheckStateOnLineStartBreak","inheritCheckStateOnLineEndBreak","todoType","ELEMENT_TODO_LI","todoEntry","todo","paragraphPath","success","withoutNormalizing","deleteText","isStart","isStartPoint","isEnd","isBlockTextEmptyAfterSelection","nextParagraphPath","next","insertElements","checked","text","splitNodes","marks","getMarks","select","insertBreakTodoList","options","res","getTodoListItemEntry","inserted","withTodoList","insertBreak","createTodoListPlugin","createPluginFactory","key","isElement","withOverrides","handlers","onKeyDown","onKeyDownToggleElement","hotkey","hasListChild","some","n","isAcrossListItems","isAcrossBlocks","isRangeAcrossBlocks","someNode","isListRoot","includes","moveListItemDown","moved","listItemPath","previousListItemPath","previous","e","previousSiblingItem","getNodeEntry","previousNode","previousPath","sublist","find","newPath","concat","wrapNodes","moveNodes","to","moveListItemsToList","fromList","fromListItem","fromStartIndex","_to","toList","toListIndex","deleteFromList","fromListPath","fromListItemSublist","findDescendant","lastChildPath","getLastChildPath","moveChildren","unwrapList","ancestorListTypeCheck","commonNode","getCommonNode","licEntry","getBlockAbove","setElements","ELEMENT_DEFAULT","unwrapNodes","split","moveListItemUp","move","liNode","toListPath","err","condA","condB","isLastChild","toListNode","liParentPath","movedUpLiPath","removeFirstListItem","moveListItems","increase","undefined","enableResetOnShiftTab","_nodes","getNodeEntries","lics","Array","from","highestLicPaths","highestLicPathRefs","forEach","lic","licPath","parent","isAncestor","highestLiPath","push","createPathRef","licPathRefsToMove","reverse","licPathRef","unref","_moved","indentListItems","insertListItem","licType","listItemEntry","listItemNode","nextListItemPath","collapseSelection","edge","moveListItemSublistItemsToListItemSublist","toListItem","start","fromListItemPath","toListItemPath","fromListItemSublistPath","toListItemSublist","fromListNode","fromListType","toListItemSublistPath","moveListSiblingsAfterCursor","offset","listEntry","isParent","removeListItem","isExpanded","previousLiPath","getPreviousPath","previousLi","tempLiPath","tempLi","tempLiPathRef","deleteMerge","removeNodes","toggleList","pluginKey","validLiChildrenTypes","getPluginOptions","mode","nodes","blockAbove","startPoint","endPoint","edges","commonEntry","startList","findNode","endList","end","rangeLength","Math","min","rootPathLength","filter","_n","unindentListItems","onKeyDownList","defaultPrevented","isTab","Hotkeys","isUntab","workRange","isBackward","unHungRange","unhangRange","listSelected","preventDefault","hotkeys","_castArray","_hotkey","isHotkey","deleteBackwardList","unit","isSelectionAtBlockStart","isFirstChild","onKeyDownResetNode","mockPlugin","rules","types","defaultType","predicate","onReset","SIMULATE_BACKSPACE","selectionIsNotInAListHandler","pointAfterSelection","getPointAfter","nextSiblingListRes","parentBlockEntity","getEditorString","sublistRes","selectionIsInAListHandler","isNodeLi","isSiblingOfNodeLi","liWithSiblings","entry","pointAfterListItem","listRoot","siblingListItem","siblingList","nestedList","nestedListItem","getChildren","deleteForwardList","skipDefaultDelete","isSelectionAtBlockEnd","deleteFragmentList","deleted","getEndPoint","liEnd","liEndCanBeDeleted","liEndPathRef","getStartPoint","liStart","liEndPath","listStart","deletePath","insertBreakList","isBlockAboveEmpty","didReset","_editor","insertFragmentList","insertFragment","listItemPlugin","getPlugin","listItemType","listItemContentType","getFirstAncestorOfType","root","ancestor","findListItemsWithContent","first","prev","trimList","_texts","getNodeTexts","textEntries","commonAncestorEntry","reduce","commonAncestor","textEntry","rest","wrapNodeIntoListItem","isSingleLic","fragment","isFragmentOnlyListRoot","getNodes","getTextAndListItemNodes","liEntry","licNode","isEmptyNode","getNodeString","flatMap","map","textNode","listItemNodes","li","currentSublists","newLic","newSublists","getDeepInlineChildren","inlineChildren","child","isBlock","normalizeListItem","changed","allValidLiChildrenTypes","liChildren","invalidLiChildrenPathRefs","childPath","firstLiChild","firstLiChildNode","firstLiChildPath","insertEmptyElement","c","licChildren","blockPathRefs","licChild","pathRef","ref","normalizeNestedList","parentNode","hasParentList","normalizeList","normalizeNode","nonLiChild","item","nextPath","nextNode","prevPath","prevNode","withList","deleteBackward","deleteForward","deleteFragment","direction","createListPlugin","plugins","deserializeHtml","validNodeName","then","inject","pluginsByKey","KEY_DESERIALIZE_HTML","insertData","preInsert"],"mappings":"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"}
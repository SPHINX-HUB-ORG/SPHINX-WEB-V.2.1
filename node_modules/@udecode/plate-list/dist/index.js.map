{"version":3,"file":"index.js","sources":["../../../../node_modules/lodash/isArray.js","../../../../node_modules/lodash/castArray.js","../../../../node_modules/is-hotkey/lib/index.js","../src/queries/isListNested.ts","../src/queries/getListTypes.ts","../src/queries/getHighestEmptyList.ts","../src/queries/getListItemEntry.ts","../src/queries/getListRoot.ts","../src/queries/hasListChild.ts","../src/queries/isAcrossListItems.ts","../src/queries/isListRoot.ts","../src/transforms/moveListItemDown.ts","../src/transforms/moveListItemsToList.ts","../src/transforms/unwrapList.ts","../src/transforms/moveListItemUp.ts","../src/transforms/removeFirstListItem.ts","../src/transforms/moveListItems.ts","../src/transforms/indentListItems.ts","../src/transforms/insertListItem.ts","../src/transforms/moveListItemSublistItemsToListItemSublist.ts","../src/transforms/moveListSiblingsAfterCursor.ts","../src/transforms/removeListItem.ts","../src/transforms/toggleList.ts","../src/transforms/unindentListItems.ts","../src/onKeyDownList.ts","../src/deleteBackwardList.ts","../src/deleteForwardList.ts","../src/deleteFragmentList.ts","../src/insertBreakList.ts","../src/insertFragmentList.ts","../src/normalizers/normalizeListItem.ts","../src/normalizers/normalizeNestedList.ts","../src/normalizers/normalizeList.ts","../src/withList.ts","../src/createListPlugin.ts","../src/todo-list/createTodoListPlugin.ts"],"sourcesContent":["/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var isArray = require('./isArray');\n\n/**\n * Casts `value` as an array if it's not one.\n *\n * @static\n * @memberOf _\n * @since 4.4.0\n * @category Lang\n * @param {*} value The value to inspect.\n * @returns {Array} Returns the cast array.\n * @example\n *\n * _.castArray(1);\n * // => [1]\n *\n * _.castArray({ 'a': 1 });\n * // => [{ 'a': 1 }]\n *\n * _.castArray('abc');\n * // => ['abc']\n *\n * _.castArray(null);\n * // => [null]\n *\n * _.castArray(undefined);\n * // => [undefined]\n *\n * _.castArray();\n * // => []\n *\n * var array = [1, 2, 3];\n * console.log(_.castArray(array) === array);\n * // => true\n */\nfunction castArray() {\n  if (!arguments.length) {\n    return [];\n  }\n  var value = arguments[0];\n  return isArray(value) ? value : [value];\n}\n\nmodule.exports = castArray;\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n/**\n * Constants.\n */\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar IS_MAC = () => typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);\n\nvar MODIFIERS = {\n  alt: 'altKey',\n  control: 'ctrlKey',\n  meta: 'metaKey',\n  shift: 'shiftKey'\n};\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar ALIASES = () => ({\n  add: '+',\n  break: 'pause',\n  cmd: 'meta',\n  command: 'meta',\n  ctl: 'control',\n  ctrl: 'control',\n  del: 'delete',\n  down: 'arrowdown',\n  esc: 'escape',\n  ins: 'insert',\n  left: 'arrowleft',\n  mod: IS_MAC() ? 'meta' : 'control',\n  opt: 'alt',\n  option: 'alt',\n  return: 'enter',\n  right: 'arrowright',\n  space: ' ',\n  spacebar: ' ',\n  up: 'arrowup',\n  win: 'meta',\n  windows: 'meta'\n});\n\nvar CODES = {\n  backspace: 8,\n  tab: 9,\n  enter: 13,\n  shift: 16,\n  control: 17,\n  alt: 18,\n  pause: 19,\n  capslock: 20,\n  escape: 27,\n  ' ': 32,\n  pageup: 33,\n  pagedown: 34,\n  end: 35,\n  home: 36,\n  arrowleft: 37,\n  arrowup: 38,\n  arrowright: 39,\n  arrowdown: 40,\n  insert: 45,\n  delete: 46,\n  meta: 91,\n  numlock: 144,\n  scrolllock: 145,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  '\\'': 222\n};\n\nfor (var f = 1; f < 20; f++) {\n  CODES['f' + f] = 111 + f;\n}\n\n/**\n * Is hotkey?\n */\n\nfunction isHotkey(hotkey, options, event) {\n  if (options && !('byKey' in options)) {\n    event = options;\n    options = null;\n  }\n\n  if (!Array.isArray(hotkey)) {\n    hotkey = [hotkey];\n  }\n\n  var array = hotkey.map(function (string) {\n    return parseHotkey(string, options);\n  });\n  var check = function check(e) {\n    return array.some(function (object) {\n      return compareHotkey(object, e);\n    });\n  };\n  var ret = event == null ? check : check(event);\n  return ret;\n}\n\nfunction isCodeHotkey(hotkey, event) {\n  return isHotkey(hotkey, event);\n}\n\nfunction isKeyHotkey(hotkey, event) {\n  return isHotkey(hotkey, { byKey: true }, event);\n}\n\n/**\n * Parse.\n */\n\nfunction parseHotkey(hotkey, options) {\n  var byKey = options && options.byKey;\n  var ret = {};\n\n  // Special case to handle the `+` key since we use it as a separator.\n  hotkey = hotkey.replace('++', '+add');\n  var values = hotkey.split('+');\n  var length = values.length;\n\n  // Ensure that all the modifiers are set to false unless the hotkey has them.\n\n  for (var k in MODIFIERS) {\n    ret[MODIFIERS[k]] = false;\n  }\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = values[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var value = _step.value;\n\n      var optional = value.endsWith('?') && value.length > 1;\n\n      if (optional) {\n        value = value.slice(0, -1);\n      }\n\n      var name = toKeyName(value);\n      var modifier = MODIFIERS[name];\n\n      if (length === 1 || !modifier) {\n        if (byKey) {\n          ret.key = name;\n        } else {\n          ret.which = toKeyCode(value);\n        }\n      }\n\n      if (modifier) {\n        ret[modifier] = optional ? null : true;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return ret;\n}\n\n/**\n * Compare.\n */\n\nfunction compareHotkey(object, event) {\n  for (var key in object) {\n    var expected = object[key];\n    var actual = void 0;\n\n    if (expected == null) {\n      continue;\n    }\n\n    if (key === 'key' && event.key != null) {\n      actual = event.key.toLowerCase();\n    } else if (key === 'which') {\n      actual = expected === 91 && event.which === 93 ? 91 : event.which;\n    } else {\n      actual = event[key];\n    }\n\n    if (actual == null && expected === false) {\n      continue;\n    }\n\n    if (actual !== expected) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Utils.\n */\n\nfunction toKeyCode(name) {\n  name = toKeyName(name);\n  var code = CODES[name] || name.toUpperCase().charCodeAt(0);\n  return code;\n}\n\nfunction toKeyName(name) {\n  name = name.toLowerCase();\n  name = ALIASES()[name] || name;\n  return name;\n}\n\n/**\n * Export.\n */\n\nexports.default = isHotkey;\nexports.isHotkey = isHotkey;\nexports.isCodeHotkey = isCodeHotkey;\nexports.isKeyHotkey = isKeyHotkey;\nexports.parseHotkey = parseHotkey;\nexports.compareHotkey = compareHotkey;\nexports.toKeyCode = toKeyCode;\nexports.toKeyName = toKeyName;","import {\n  getParentNode,\n  getPluginType,\n  PlateEditor,\n  TElement,\n  Value,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { ELEMENT_LI } from '../createListPlugin';\n\n/**\n * Is the list nested, i.e. its parent is a list item.\n */\nexport const isListNested = <V extends Value>(\n  editor: PlateEditor<V>,\n  listPath: Path\n) => {\n  const listParentNode = getParentNode<TElement>(editor, listPath)?.[0];\n\n  return listParentNode?.type === getPluginType(editor, ELEMENT_LI);\n};\n","import { getPluginType, PlateEditor, Value } from '@udecode/plate-core';\nimport {\n  ELEMENT_LI,\n  ELEMENT_LIC,\n  ELEMENT_OL,\n  ELEMENT_UL,\n} from '../createListPlugin';\n\nexport const getUnorderedListType = <V extends Value>(\n  editor: PlateEditor<V>\n) => {\n  return getPluginType(editor, ELEMENT_UL);\n};\n\nexport const getOrderedListType = <V extends Value>(editor: PlateEditor<V>) => {\n  return getPluginType(editor, ELEMENT_OL);\n};\n\nexport const getListTypes = <V extends Value>(editor: PlateEditor<V>) => {\n  return [getOrderedListType(editor), getUnorderedListType(editor)];\n};\n\nexport const getListItemType = <V extends Value>(editor: PlateEditor<V>) => {\n  return getPluginType(editor, ELEMENT_LI);\n};\n\nexport const getListItemContentType = <V extends Value>(\n  editor: PlateEditor<V>\n) => {\n  return getPluginType(editor, ELEMENT_LIC);\n};\n","import {\n  getAboveNode,\n  getPluginType,\n  PlateEditor,\n  Value,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { ELEMENT_LI } from '../createListPlugin';\nimport { getListTypes } from './getListTypes';\n\n/**\n * Find the highest end list that can be deleted.\n * Its path should be different to diffListPath.\n * If the highest end list 2+ items, return liPath.\n * Get the parent list until:\n * - the list has less than 2 items.\n * - its path is not equals to diffListPath.\n */\nexport const getHighestEmptyList = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    diffListPath,\n    liPath,\n  }: {\n    liPath: Path;\n    diffListPath?: Path;\n  }\n): Path | undefined => {\n  const list = getAboveNode(editor, {\n    at: liPath,\n    match: { type: getListTypes(editor) },\n  });\n  if (!list) return;\n  const [listNode, listPath] = list;\n\n  if (!diffListPath || !Path.equals(listPath, diffListPath)) {\n    if (listNode.children.length < 2) {\n      const liParent = getAboveNode(editor, {\n        at: listPath,\n        match: { type: getPluginType(editor, ELEMENT_LI) },\n      });\n\n      if (liParent) {\n        return (\n          getHighestEmptyList(editor, { liPath: liParent[1], diffListPath }) ||\n          listPath\n        );\n      }\n    }\n    return liPath;\n  }\n};\n","import {\n  getAboveNode,\n  getNode,\n  getParentNode,\n  getPluginType,\n  isCollapsed,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n} from '@udecode/plate-core';\nimport { Location, Path, Range } from 'slate';\nimport { ELEMENT_LI } from '../createListPlugin';\n\n/**\n * Returns the nearest li and ul / ol wrapping node entries for a given path (default = selection)\n */\nexport const getListItemEntry = <V extends Value>(\n  editor: PlateEditor<V>,\n  { at = editor.selection }: { at?: Location | null } = {}\n): { list: TElementEntry; listItem: TElementEntry } | undefined => {\n  const liType = getPluginType(editor, ELEMENT_LI);\n\n  let _at: Path;\n\n  if (Range.isRange(at) && !isCollapsed(at)) {\n    _at = at.focus.path;\n  } else if (Range.isRange(at)) {\n    _at = at.anchor.path;\n  } else {\n    _at = at as Path;\n  }\n\n  if (_at) {\n    const node = getNode<TElement>(editor, _at);\n    if (node) {\n      const listItem = getAboveNode<TElement>(editor, {\n        at: _at,\n        match: { type: liType },\n      });\n\n      if (listItem) {\n        const list = getParentNode<TElement>(editor, listItem[1])!;\n\n        return { list, listItem };\n      }\n    }\n  }\n};\n","import {\n  getAboveNode,\n  getPluginType,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n} from '@udecode/plate-core';\nimport { Path, Point, Range } from 'slate';\nimport { ELEMENT_OL, ELEMENT_UL } from '../createListPlugin';\n\n/**\n * Searches upward for the root list element\n */\nexport const getListRoot = <V extends Value>(\n  editor: PlateEditor<V>,\n  at: Path | Range | Point | null = editor.selection\n): TElementEntry | undefined => {\n  if (!at) return;\n\n  const parentList = getAboveNode<TElement>(editor, {\n    at,\n    match: {\n      type: [\n        getPluginType(editor, ELEMENT_UL),\n        getPluginType(editor, ELEMENT_OL),\n      ],\n    },\n  });\n\n  if (parentList) {\n    const [, parentListPath] = parentList;\n\n    return getListRoot(editor, parentListPath) ?? parentList;\n  }\n};\n","import { match, PlateEditor, TAncestor, Value } from '@udecode/plate-core';\nimport { getListTypes } from './getListTypes';\n\n/**\n * Is there a list child in the node.\n */\nexport const hasListChild = <V extends Value>(\n  editor: PlateEditor<V>,\n  node: TAncestor\n) => node.children.some((n) => match(n, [], { type: getListTypes(editor) }));\n","import {\n  getPluginType,\n  isCollapsed,\n  isRangeAcrossBlocks,\n  PlateEditor,\n  someNode,\n  Value,\n} from '@udecode/plate-core';\nimport { ELEMENT_LI } from '../createListPlugin';\n\n/**\n * Is selection across blocks with list items\n */\nexport const isAcrossListItems = <V extends Value>(editor: PlateEditor<V>) => {\n  const { selection } = editor;\n\n  if (!selection || isCollapsed(selection)) {\n    return false;\n  }\n\n  const isAcrossBlocks = isRangeAcrossBlocks(editor);\n  if (!isAcrossBlocks) return false;\n\n  return someNode(editor, {\n    match: { type: getPluginType(editor, ELEMENT_LI) },\n  });\n};\n","import {\n  isElement,\n  PlateEditor,\n  TDescendant,\n  Value,\n} from '@udecode/plate-core';\nimport { getListTypes } from './getListTypes';\n\nexport const isListRoot = <V extends Value>(\n  editor: PlateEditor<V>,\n  node: TDescendant\n): boolean => isElement(node) && getListTypes(editor).includes(node.type);\n","import {\n  getNodeEntry,\n  match,\n  moveNodes,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n  withoutNormalizing,\n  wrapNodes,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { getListTypes } from '../queries';\n\nexport interface MoveListItemDownOptions {\n  list: TElementEntry;\n  listItem: TElementEntry;\n}\n\nexport const moveListItemDown = <V extends Value>(\n  editor: PlateEditor<V>,\n  { list, listItem }: MoveListItemDownOptions\n) => {\n  const [listNode] = list;\n  const [, listItemPath] = listItem;\n\n  let previousListItemPath: Path;\n\n  try {\n    previousListItemPath = Path.previous(listItemPath);\n  } catch (e) {\n    return;\n  }\n\n  // Previous sibling is the new parent\n  const previousSiblingItem = getNodeEntry<TElement>(\n    editor,\n    previousListItemPath\n  );\n\n  if (previousSiblingItem) {\n    const [previousNode, previousPath] = previousSiblingItem;\n\n    const sublist = (previousNode.children as TElement[]).find((n) =>\n      match(n, [], { type: getListTypes(editor) })\n    );\n    const newPath = previousPath.concat(\n      sublist ? [1, sublist.children.length] : [1]\n    );\n\n    withoutNormalizing(editor, () => {\n      if (!sublist) {\n        // Create new sublist\n        wrapNodes<TElement>(\n          editor,\n          { type: listNode.type, children: [] },\n          { at: listItemPath }\n        );\n      }\n\n      // Move the current item to the sublist\n      moveNodes(editor, {\n        at: listItemPath,\n        to: newPath,\n      });\n    });\n  }\n};\n","import {\n  deleteText,\n  findDescendant,\n  getLastChildPath,\n  moveChildren,\n  MoveChildrenOptions,\n  PlateEditor,\n  TElementEntry,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { getListTypes } from '../queries/getListTypes';\n\nexport interface MergeListItemIntoListOptions<V extends Value = Value> {\n  /**\n   * List items of the sublist of this node will be moved.\n   */\n  fromListItem?: TElementEntry;\n\n  /**\n   * List items of the list will be moved.\n   */\n  fromList?: TElementEntry;\n\n  /**\n   * List items will be moved in this list.\n   */\n  toList?: TElementEntry;\n\n  fromStartIndex?: MoveChildrenOptions<V>['fromStartIndex'];\n\n  /**\n   * List position where to move the list items.\n   */\n  toListIndex?: number | null;\n\n  to?: Path;\n\n  /**\n   * Delete `fromListItem` sublist if true.\n   * @default true\n   */\n  deleteFromList?: boolean;\n}\n\n/**\n * Move the list items of the sublist of `fromListItem` to `toList` (if `fromListItem` is defined).\n * Move the list items of `fromList` to `toList` (if `fromList` is defined).\n */\nexport const moveListItemsToList = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    fromList,\n    fromListItem,\n    fromStartIndex,\n    to: _to,\n    toList,\n    toListIndex = null,\n    deleteFromList = true,\n  }: MergeListItemIntoListOptions<V>\n) => {\n  let fromListPath: Path | undefined;\n  let moved;\n\n  withoutNormalizing(editor, () => {\n    if (fromListItem) {\n      const fromListItemSublist = findDescendant(editor, {\n        at: fromListItem[1],\n        match: {\n          type: getListTypes(editor),\n        },\n      });\n      if (!fromListItemSublist) return;\n\n      fromListPath = fromListItemSublist?.[1];\n    } else if (fromList) {\n      // eslint-disable-next-line prefer-destructuring\n      fromListPath = fromList[1];\n    } else {\n      return;\n    }\n\n    let to: Path | null = null;\n\n    if (_to) to = _to;\n    if (toList) {\n      if (toListIndex !== null) to = toList[1].concat([toListIndex]);\n      else {\n        const lastChildPath = getLastChildPath(toList);\n        to = Path.next(lastChildPath);\n      }\n    }\n    if (!to) return;\n\n    moved = moveChildren(editor, {\n      at: fromListPath,\n      to,\n      fromStartIndex,\n    });\n\n    // Remove the empty list\n    if (deleteFromList) {\n      deleteText(editor, { at: fromListPath });\n    }\n  });\n\n  return moved;\n};\n","import {\n  ELEMENT_DEFAULT,\n  getAboveNode,\n  getCommonNode,\n  getPluginType,\n  isElement,\n  PlateEditor,\n  setElements,\n  unwrapNodes,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { ELEMENT_LI, ELEMENT_OL, ELEMENT_UL } from '../createListPlugin';\nimport { getListTypes } from '../queries';\n\nexport const unwrapList = <V extends Value>(\n  editor: PlateEditor<V>,\n  { at }: { at?: Path } = {}\n) => {\n  const ancestorListTypeCheck = () => {\n    if (getAboveNode(editor, { match: { type: getListTypes(editor), at } })) {\n      return true;\n    }\n\n    // The selection's common node might be a list type\n    if (!at && editor.selection) {\n      const commonNode = getCommonNode(\n        editor,\n        editor.selection.anchor.path,\n        editor.selection.focus.path\n      );\n      if (\n        isElement(commonNode[0]) &&\n        getListTypes(editor).includes(commonNode[0].type)\n      ) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  withoutNormalizing(editor, () => {\n    do {\n      setElements(editor, {\n        type: getPluginType(editor, ELEMENT_DEFAULT),\n      });\n\n      unwrapNodes(editor, {\n        at,\n        match: { type: getPluginType(editor, ELEMENT_LI) },\n        split: true,\n      });\n\n      unwrapNodes(editor, {\n        at,\n        match: {\n          type: [\n            getPluginType(editor, ELEMENT_UL),\n            getPluginType(editor, ELEMENT_OL),\n          ],\n        },\n        split: true,\n      });\n    } while (ancestorListTypeCheck());\n  });\n};\n","import {\n  getAboveNode,\n  getNode,\n  getPluginType,\n  insertElements,\n  isLastChild,\n  moveNodes,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { ELEMENT_LI } from '../createListPlugin';\nimport { hasListChild } from '../queries/hasListChild';\nimport { moveListItemsToList } from './moveListItemsToList';\nimport { unwrapList } from './unwrapList';\n\nexport interface MoveListItemUpOptions {\n  list: TElementEntry;\n  listItem: TElementEntry;\n}\n\n/**\n * Move a list item up.\n */\nexport const moveListItemUp = <V extends Value>(\n  editor: PlateEditor<V>,\n  { list, listItem }: MoveListItemUpOptions\n) => {\n  const move = () => {\n    const [listNode, listPath] = list;\n    const [liNode, liPath] = listItem;\n\n    const liParent = getAboveNode<TElement>(editor, {\n      at: listPath,\n      match: { type: getPluginType(editor, ELEMENT_LI) },\n    });\n    if (!liParent) {\n      let toListPath;\n      try {\n        toListPath = Path.next(listPath);\n      } catch (err) {\n        return;\n      }\n\n      const condA = hasListChild(editor, liNode);\n      const condB = !isLastChild(list, liPath);\n\n      if (condA || condB) {\n        // Insert a new list next to `list`\n        insertElements(\n          editor,\n          {\n            type: listNode.type,\n            children: [],\n          },\n          { at: toListPath }\n        );\n      }\n\n      if (condA) {\n        const toListNode = getNode<TElement>(editor, toListPath);\n        if (!toListNode) return;\n\n        // Move li sub-lis to the new list\n        moveListItemsToList(editor, {\n          fromListItem: listItem,\n          toList: [toListNode, toListPath],\n        });\n      }\n\n      // If there is siblings li, move them to the new list\n      if (condB) {\n        const toListNode = getNode<TElement>(editor, toListPath);\n        if (!toListNode) return;\n\n        // Move next lis to the new list\n        moveListItemsToList(editor, {\n          fromList: list,\n          fromStartIndex: liPath[liPath.length - 1] + 1,\n          toList: [toListNode, toListPath],\n          deleteFromList: false,\n        });\n      }\n\n      // Finally, unwrap the list\n      unwrapList(editor, { at: liPath.concat(0) });\n\n      return true;\n    }\n    const [, liParentPath] = liParent;\n\n    const toListPath = liPath.concat([1]);\n\n    // If li has next siblings, we need to move them.\n    if (!isLastChild(list, liPath)) {\n      // If li has no sublist, insert one.\n      if (!hasListChild(editor, liNode)) {\n        insertElements(\n          editor,\n          {\n            type: listNode.type,\n            children: [],\n          },\n          { at: toListPath }\n        );\n      }\n\n      const toListNode = getNode<TElement>(editor, toListPath);\n      if (!toListNode) return;\n\n      // Move next siblings to li sublist.\n      moveListItemsToList(editor, {\n        fromListItem: liParent,\n        toList: [toListNode, toListPath],\n        fromStartIndex: liPath[liPath.length - 1] + 1,\n        deleteFromList: false,\n      });\n    }\n\n    const movedUpLiPath = Path.next(liParentPath);\n\n    // Move li one level up: next to the li parent.\n    moveNodes(editor, {\n      at: liPath,\n      to: movedUpLiPath,\n    });\n\n    return true;\n  };\n\n  let moved: boolean | undefined = false;\n\n  withoutNormalizing(editor, () => {\n    moved = move();\n  });\n\n  return moved;\n};\n","import { PlateEditor, TElementEntry, Value } from '@udecode/plate-core';\nimport { isListNested } from '../queries/isListNested';\nimport { moveListItemUp } from './moveListItemUp';\n\n/**\n * If list is not nested and if li is not the first child, move li up.\n */\nexport const removeFirstListItem = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    list,\n    listItem,\n  }: {\n    list: TElementEntry;\n    listItem: TElementEntry;\n  }\n) => {\n  const [, listPath] = list;\n\n  if (!isListNested(editor, listPath)) {\n    moveListItemUp(editor, { list, listItem });\n\n    return true;\n  }\n\n  return false;\n};\n","import {\n  createPathRef,\n  getNodeEntries,\n  GetNodeEntriesOptions,\n  getParentNode,\n  getPluginType,\n  PlateEditor,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-core';\nimport { Path, PathRef } from 'slate';\nimport { ELEMENT_LIC } from '../createListPlugin';\nimport { isListNested } from '../queries/isListNested';\nimport { moveListItemDown } from './moveListItemDown';\nimport { moveListItemUp } from './moveListItemUp';\nimport { removeFirstListItem } from './removeFirstListItem';\n\nexport type MoveListItemsOptions = {\n  increase?: boolean;\n  at?: GetNodeEntriesOptions['at'];\n  enableResetOnShiftTab?: boolean;\n};\n\nexport const moveListItems = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    increase = true,\n    at = editor.selection ?? undefined,\n    enableResetOnShiftTab,\n  }: MoveListItemsOptions = {}\n) => {\n  const _nodes = getNodeEntries(editor, {\n    at,\n    match: {\n      type: getPluginType(editor, ELEMENT_LIC),\n    },\n  });\n\n  // Get the selected lic\n  const lics = Array.from(_nodes);\n\n  if (!lics.length) return;\n\n  const highestLicPaths: Path[] = [];\n  const highestLicPathRefs: PathRef[] = [];\n\n  // Filter out the nested lic, we just need to move the highest ones\n  lics.forEach((lic) => {\n    const licPath = lic[1];\n    const liPath = Path.parent(licPath);\n\n    const isAncestor = highestLicPaths.some((path) => {\n      const highestLiPath = Path.parent(path);\n\n      return Path.isAncestor(highestLiPath, liPath);\n    });\n    if (!isAncestor) {\n      highestLicPaths.push(licPath);\n      highestLicPathRefs.push(createPathRef(editor, licPath));\n    }\n  });\n\n  const licPathRefsToMove = increase\n    ? highestLicPathRefs\n    : highestLicPathRefs.reverse();\n\n  withoutNormalizing(editor, () => {\n    licPathRefsToMove.forEach((licPathRef) => {\n      const licPath = licPathRef.unref();\n      if (!licPath) return;\n\n      const listItem = getParentNode(editor, licPath);\n      if (!listItem) return;\n\n      const parentList = getParentNode(editor, listItem[1]);\n      if (!parentList) return;\n\n      if (increase) {\n        moveListItemDown(editor, {\n          list: parentList as any,\n          listItem: listItem as any,\n        });\n      } else if (isListNested(editor, parentList[1])) {\n        // un-indent a sub-list item\n        moveListItemUp(editor, {\n          list: parentList as any,\n          listItem: listItem as any,\n        });\n      } else if (enableResetOnShiftTab) {\n        // unindenting a top level list item, effectively breaking apart the list.\n        removeFirstListItem(editor, {\n          list: parentList as any,\n          listItem: listItem as any,\n        });\n      }\n    });\n  });\n};\n","import { PlateEditor, Value } from '@udecode/plate-core';\nimport { moveListItems } from './moveListItems';\n\nexport const indentListItems = <V extends Value>(editor: PlateEditor<V>) => {\n  moveListItems(editor, { increase: true });\n};\n","import {\n  collapseSelection,\n  deleteText,\n  getAboveNode,\n  getMarks,\n  getParentNode,\n  getPluginType,\n  insertElements,\n  isBlockTextEmptyAfterSelection,\n  isStartPoint,\n  moveNodes,\n  PlateEditor,\n  select,\n  splitNodes,\n  TElement,\n  Value,\n  withoutNormalizing,\n  wrapNodes,\n} from '@udecode/plate-core';\nimport { Path, Range } from 'slate';\nimport { ELEMENT_LI, ELEMENT_LIC } from '../createListPlugin';\n\n/**\n * Insert list item if selection in li>p.\n * TODO: test\n */\nexport const insertListItem = <V extends Value>(\n  editor: PlateEditor<V>\n): boolean => {\n  const liType = getPluginType(editor, ELEMENT_LI);\n  const licType = getPluginType(editor, ELEMENT_LIC);\n\n  if (!editor.selection) {\n    return false;\n  }\n\n  const licEntry = getAboveNode(editor, { match: { type: licType } });\n  if (!licEntry) return false;\n  const [, paragraphPath] = licEntry;\n\n  const listItemEntry = getParentNode(editor, paragraphPath);\n  if (!listItemEntry) return false;\n  const [listItemNode, listItemPath] = listItemEntry;\n\n  if (listItemNode.type !== liType) return false;\n\n  let success = false;\n\n  withoutNormalizing(editor, () => {\n    if (!Range.isCollapsed(editor.selection!)) {\n      deleteText(editor);\n    }\n\n    const isStart = isStartPoint(\n      editor,\n      editor.selection!.focus,\n      paragraphPath\n    );\n    const isEnd = isBlockTextEmptyAfterSelection(editor);\n\n    const nextParagraphPath = Path.next(paragraphPath);\n    const nextListItemPath = Path.next(listItemPath);\n\n    /**\n     * If start, insert a list item before\n     */\n    if (isStart) {\n      insertElements(\n        editor,\n        {\n          type: liType,\n          children: [{ type: licType, children: [{ text: '' }] }],\n        },\n        { at: listItemPath }\n      );\n\n      success = true;\n\n      return;\n    }\n\n    /**\n     * If not end, split nodes, wrap a list item on the new paragraph and move it to the next list item\n     */\n    if (!isEnd) {\n      withoutNormalizing(editor, () => {\n        splitNodes(editor);\n        wrapNodes<TElement>(\n          editor,\n          {\n            type: liType,\n            children: [],\n          },\n          { at: nextParagraphPath }\n        );\n        moveNodes(editor, {\n          at: nextParagraphPath,\n          to: nextListItemPath,\n        });\n        select(editor, nextListItemPath);\n        collapseSelection(editor, {\n          edge: 'start',\n        });\n      });\n    } else {\n      /**\n       * If end, insert a list item after and select it\n       */\n      const marks = getMarks(editor) || {};\n      insertElements(\n        editor,\n        {\n          type: liType,\n          children: [{ type: licType, children: [{ text: '', ...marks }] }],\n        },\n        { at: nextListItemPath }\n      );\n      select(editor, nextListItemPath);\n    }\n\n    /**\n     * If there is a list in the list item, move it to the next list item\n     */\n    if (listItemNode.children.length > 1) {\n      moveNodes(editor, {\n        at: nextParagraphPath,\n        to: nextListItemPath.concat(1),\n      });\n    }\n\n    success = true;\n  });\n\n  return success;\n};\n","import {\n  deleteText,\n  findDescendant,\n  getLastChildPath,\n  getParentNode,\n  insertElements,\n  moveChildren,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { getListTypes } from '../queries/getListTypes';\n\nexport interface MoveListItemSublistItemsToListItemSublistOptions {\n  /**\n   * The list item to merge.\n   */\n  fromListItem: TElementEntry;\n\n  /**\n   * The list item where to merge.\n   */\n  toListItem: TElementEntry;\n\n  /**\n   * Move to the start of the list instead of the end.\n   */\n  start?: boolean;\n}\n\n/**\n * Move fromListItem sublist list items to the end of `toListItem` sublist.\n * If there is no `toListItem` sublist, insert one.\n */\nexport const moveListItemSublistItemsToListItemSublist = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    fromListItem,\n    toListItem,\n    start,\n  }: MoveListItemSublistItemsToListItemSublistOptions\n) => {\n  const [, fromListItemPath] = fromListItem;\n  const [, toListItemPath] = toListItem;\n  let moved = 0;\n\n  withoutNormalizing(editor, () => {\n    const fromListItemSublist = findDescendant<TElement>(editor, {\n      at: fromListItemPath,\n      match: {\n        type: getListTypes(editor),\n      },\n    });\n    if (!fromListItemSublist) return;\n\n    const [, fromListItemSublistPath] = fromListItemSublist;\n\n    const toListItemSublist = findDescendant<TElement>(editor, {\n      at: toListItemPath,\n      match: {\n        type: getListTypes(editor),\n      },\n    });\n\n    let to: Path;\n\n    if (!toListItemSublist) {\n      const fromList = getParentNode(editor, fromListItemPath);\n      if (!fromList) return;\n      const [fromListNode] = fromList;\n\n      const fromListType = fromListNode.type;\n\n      const toListItemSublistPath = toListItemPath.concat([1]);\n\n      insertElements(\n        editor,\n        { type: fromListType as string, children: [] },\n        { at: toListItemSublistPath }\n      );\n\n      to = toListItemSublistPath.concat([0]);\n    } else if (start) {\n      const [, toListItemSublistPath] = toListItemSublist;\n      to = toListItemSublistPath.concat([0]);\n    } else {\n      to = Path.next(getLastChildPath(toListItemSublist));\n    }\n\n    moved = moveChildren(editor, {\n      at: fromListItemSublistPath,\n      to,\n    });\n\n    // Remove the empty list\n    deleteText(editor, { at: fromListItemSublistPath });\n  });\n\n  return moved;\n};\n","import {\n  getNode,\n  match,\n  moveChildren,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { getListTypes } from '../queries/getListTypes';\n\nexport const moveListSiblingsAfterCursor = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    at,\n    to,\n  }: {\n    at: Path;\n    to: Path;\n  }\n): number => {\n  const offset = at[at.length - 1];\n  at = Path.parent(at);\n  const listNode = getNode<TElement>(editor, at)!;\n  const listEntry: TElementEntry = [listNode, at];\n\n  if (\n    !match(listNode, [], { type: getListTypes(editor) }) ||\n    Path.isParent(at, to) // avoid moving nodes within its own list\n  ) {\n    return 0;\n  }\n\n  return moveChildren(editor, {\n    at: listEntry as any,\n    to,\n    fromStartIndex: offset + 1,\n  });\n};\n","import {\n  createPathRef,\n  deleteMerge,\n  getNodeEntry,\n  getPluginType,\n  getPreviousPath,\n  insertElements,\n  isExpanded,\n  PlateEditor,\n  removeNodes,\n  TElement,\n  TElementEntry,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { ELEMENT_LI, ELEMENT_LIC } from '../createListPlugin';\nimport { hasListChild } from '../queries/hasListChild';\nimport { moveListItemsToList } from './moveListItemsToList';\nimport { moveListItemSublistItemsToListItemSublist } from './moveListItemSublistItemsToListItemSublist';\n\nexport interface RemoveListItemOptions {\n  list: TElementEntry;\n  listItem: TElementEntry;\n  reverse?: boolean;\n}\n\n/**\n * Remove list item and move its sublist to list if any.\n */\nexport const removeListItem = <V extends Value>(\n  editor: PlateEditor<V>,\n  { list, listItem, reverse = true }: RemoveListItemOptions\n) => {\n  const [liNode, liPath] = listItem;\n\n  // Stop if the list item has no sublist\n  if (isExpanded(editor.selection) || !hasListChild(editor, liNode)) {\n    return false;\n  }\n\n  const previousLiPath = getPreviousPath(liPath);\n\n  let success = false;\n\n  withoutNormalizing(editor, () => {\n    /**\n     * If there is a previous li, we need to move sub-lis to the previous li.\n     * As we need to delete first, we will:\n     * 1. insert a temporary li: tempLi\n     * 2. move sub-lis to tempLi\n     * 3. delete\n     * 4. move sub-lis from tempLi to the previous li.\n     * 5. remove tempLi\n     */\n    if (previousLiPath) {\n      const previousLi = getNodeEntry<TElement>(editor, previousLiPath);\n\n      // 1\n      let tempLiPath = Path.next(liPath);\n      insertElements(\n        editor,\n        {\n          type: getPluginType(editor, ELEMENT_LI),\n          children: [\n            {\n              type: getPluginType(editor, ELEMENT_LIC),\n              children: [{ text: '' }],\n            },\n          ],\n        },\n        { at: tempLiPath }\n      );\n\n      const tempLi = getNodeEntry<TElement>(editor, tempLiPath);\n      const tempLiPathRef = createPathRef(editor, tempLi[1]);\n\n      // 2\n      moveListItemSublistItemsToListItemSublist(editor, {\n        fromListItem: listItem,\n        toListItem: tempLi,\n      });\n\n      // 3\n      deleteMerge(editor, {\n        reverse,\n      });\n\n      tempLiPath = tempLiPathRef.unref()!;\n\n      // 4\n      moveListItemSublistItemsToListItemSublist(editor, {\n        fromListItem: [tempLi[0], tempLiPath],\n        toListItem: previousLi,\n      });\n\n      // 5\n      removeNodes(editor, { at: tempLiPath });\n\n      success = true;\n      return;\n    }\n\n    // If it's the first li, move the sublist to the parent list\n    moveListItemsToList(editor, {\n      fromListItem: listItem,\n      toList: list,\n      toListIndex: 1,\n    });\n  });\n\n  return success;\n};\n","import {\n  ELEMENT_DEFAULT,\n  findNode,\n  getCommonNode,\n  getNodeEntries,\n  getPluginType,\n  isCollapsed,\n  isElement,\n  isRangeAcrossBlocks,\n  PlateEditor,\n  setElements,\n  TElement,\n  Value,\n  withoutNormalizing,\n  wrapNodes,\n} from '@udecode/plate-core';\nimport { Range } from 'slate';\nimport { ELEMENT_LI, ELEMENT_LIC } from '../createListPlugin';\nimport { getListItemEntry, getListTypes } from '../queries';\nimport { unwrapList } from './unwrapList';\n\nexport const toggleList = <V extends Value>(\n  editor: PlateEditor<V>,\n  { type }: { type: string }\n) =>\n  withoutNormalizing(editor, () => {\n    if (!editor.selection) {\n      return;\n    }\n\n    if (isCollapsed(editor.selection) || !isRangeAcrossBlocks(editor)) {\n      // selection is collapsed\n      const res = getListItemEntry(editor);\n\n      if (res) {\n        const { list } = res;\n        if (list[0].type !== type) {\n          setElements(\n            editor,\n            { type },\n            {\n              at: editor.selection,\n              match: (n) =>\n                isElement(n) && getListTypes(editor).includes(n.type),\n              mode: 'lowest',\n            }\n          );\n        } else {\n          unwrapList(editor);\n        }\n      } else {\n        const list = { type, children: [] };\n        wrapNodes<TElement>(editor, list);\n\n        const _nodes = getNodeEntries(editor, {\n          match: { type: getPluginType(editor, ELEMENT_DEFAULT) },\n        });\n        const nodes = Array.from(_nodes);\n        setElements(editor, {\n          type: getPluginType(editor, ELEMENT_LIC),\n        });\n\n        const listItem = {\n          type: getPluginType(editor, ELEMENT_LI),\n          children: [],\n        };\n\n        for (const [, path] of nodes) {\n          wrapNodes<TElement>(editor, listItem, {\n            at: path,\n          });\n        }\n      }\n    } else {\n      // selection is a range\n\n      const [startPoint, endPoint] = Range.edges(editor.selection!);\n      const commonEntry = getCommonNode<TElement>(\n        editor,\n        startPoint.path,\n        endPoint.path\n      );\n\n      if (\n        getListTypes(editor).includes(commonEntry[0].type) ||\n        (commonEntry[0] as TElement).type === getPluginType(editor, ELEMENT_LI)\n      ) {\n        if ((commonEntry[0] as TElement).type !== type) {\n          const startList = findNode(editor, {\n            at: Range.start(editor.selection),\n            match: { type: getListTypes(editor) },\n            mode: 'lowest',\n          });\n          const endList = findNode(editor, {\n            at: Range.end(editor.selection),\n            match: { type: getListTypes(editor) },\n            mode: 'lowest',\n          });\n          const rangeLength = Math.min(\n            startList![1].length,\n            endList![1].length\n          );\n          setElements(\n            editor,\n            { type },\n            {\n              at: editor.selection,\n              match: (n, path) =>\n                isElement(n) &&\n                getListTypes(editor).includes(n.type) &&\n                path.length >= rangeLength,\n              mode: 'all',\n            }\n          );\n        } else {\n          unwrapList(editor);\n        }\n      } else {\n        const rootPathLength = commonEntry[1].length;\n        const _nodes = getNodeEntries<TElement>(editor, {\n          mode: 'all',\n        });\n        const nodes = Array.from(_nodes)\n          .filter(([, path]) => path.length === rootPathLength + 1)\n          .reverse();\n\n        nodes.forEach((n) => {\n          if (getListTypes(editor).includes(n[0].type)) {\n            setElements(\n              editor,\n              { type },\n              {\n                at: n[1],\n                match: (_n) =>\n                  isElement(_n) && getListTypes(editor).includes(_n.type),\n                mode: 'all',\n              }\n            );\n          } else {\n            setElements(\n              editor,\n              { type: getPluginType(editor, ELEMENT_LIC) },\n              { at: n[1] }\n            );\n\n            const listItem = {\n              type: getPluginType(editor, ELEMENT_LI),\n              children: [],\n            };\n            wrapNodes<TElement>(editor, listItem, {\n              at: n[1],\n            });\n\n            const list = { type, children: [] };\n            wrapNodes<TElement>(editor, list, { at: n[1] });\n          }\n        });\n      }\n    }\n  });\n","import { PlateEditor, Value } from '@udecode/plate-core';\nimport { moveListItems, MoveListItemsOptions } from './moveListItems';\n\nexport type UnindentListItemsOptions = Omit<MoveListItemsOptions, 'increase'>;\n\nexport const unindentListItems = <V extends Value>(\n  editor: PlateEditor<V>,\n  options: UnindentListItemsOptions = {}\n): void => moveListItems(editor, { ...options, increase: false });\n","import {\n  getPluginType,\n  Hotkeys,\n  isCollapsed,\n  KeyboardHandlerReturnType,\n  PlateEditor,\n  select,\n  someNode,\n  unhangRange,\n  Value,\n  WithPlatePlugin,\n} from '@udecode/plate-core';\nimport isHotkey from 'is-hotkey';\nimport { castArray } from 'lodash';\nimport { Range } from 'slate';\nimport { ELEMENT_LIC } from './createListPlugin';\nimport { moveListItems, toggleList } from './transforms';\nimport { ListPlugin } from './types';\n\nexport const onKeyDownList = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  {\n    type,\n    options: { hotkey, enableResetOnShiftTab },\n  }: WithPlatePlugin<ListPlugin, V, E>\n): KeyboardHandlerReturnType => (e) => {\n  const isTab = Hotkeys.isTab(editor, e);\n  const isUntab = Hotkeys.isUntab(editor, e);\n\n  let workRange = editor.selection;\n\n  if (editor.selection && (isTab || isUntab)) {\n    const { selection } = editor;\n\n    // Unhang the expanded selection\n    if (!isCollapsed(editor.selection)) {\n      const { anchor, focus } = Range.isBackward(selection)\n        ? { anchor: selection.focus, focus: selection.anchor }\n        : { anchor: selection.anchor, focus: selection.focus };\n\n      // This is a workaround for a Slate bug\n      // See: https://github.com/ianstormtaylor/slate/pull/5039\n      anchor.offset = 0;\n      const unHungRange = unhangRange(editor, { anchor, focus });\n      if (unHungRange) {\n        workRange = unHungRange;\n        select(editor, unHungRange);\n      }\n    }\n\n    // check if we're in a list context.\n    const listSelected = someNode(editor, {\n      match: { type: getPluginType(editor, ELEMENT_LIC) },\n    });\n\n    if (workRange && listSelected) {\n      e.preventDefault();\n      moveListItems(editor, {\n        at: workRange,\n        increase: isTab,\n        enableResetOnShiftTab,\n      });\n      return true;\n    }\n  }\n\n  if (!hotkey) return;\n\n  const hotkeys = castArray(hotkey);\n\n  for (const _hotkey of hotkeys) {\n    if (isHotkey(_hotkey)(e as any)) {\n      toggleList(editor, { type: type! });\n    }\n  }\n};\n","import {\n  deleteMerge,\n  ELEMENT_DEFAULT,\n  getPluginType,\n  isFirstChild,\n  isSelectionAtBlockStart,\n  mockPlugin,\n  PlateEditor,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-core';\nimport {\n  onKeyDownResetNode,\n  ResetNodePlugin,\n  SIMULATE_BACKSPACE,\n} from '@udecode/plate-reset-node';\nimport { getListItemEntry } from './queries/getListItemEntry';\nimport { isListNested } from './queries/isListNested';\nimport { removeFirstListItem } from './transforms/removeFirstListItem';\nimport { removeListItem } from './transforms/removeListItem';\nimport { unwrapList } from './transforms/unwrapList';\nimport { ELEMENT_LI } from './createListPlugin';\n\nexport const deleteBackwardList = <V extends Value>(\n  editor: PlateEditor<V>,\n  unit: 'character' | 'word' | 'line' | 'block'\n) => {\n  const res = getListItemEntry(editor, {});\n\n  let moved: boolean | undefined = false;\n\n  if (res) {\n    const { list, listItem } = res;\n\n    if (\n      isSelectionAtBlockStart(editor, {\n        match: (node) => node.type === getPluginType(editor, ELEMENT_LI),\n      })\n    ) {\n      withoutNormalizing(editor, () => {\n        moved = removeFirstListItem(editor, { list, listItem });\n        if (moved) return true;\n\n        moved = removeListItem(editor, { list, listItem });\n        if (moved) return true;\n\n        if (isFirstChild(listItem[1]) && !isListNested(editor, list[1])) {\n          onKeyDownResetNode(\n            editor as any,\n            mockPlugin<ResetNodePlugin>({\n              options: {\n                rules: [\n                  {\n                    types: [getPluginType(editor, ELEMENT_LI)],\n                    defaultType: getPluginType(editor, ELEMENT_DEFAULT),\n                    hotkey: 'backspace',\n                    predicate: () => isSelectionAtBlockStart(editor),\n                    onReset: (e) => unwrapList(e),\n                  },\n                ],\n              },\n            })\n          )(SIMULATE_BACKSPACE);\n          moved = true;\n          return;\n        }\n\n        deleteMerge(editor, {\n          unit,\n          reverse: true,\n        });\n        moved = true;\n      });\n    }\n  }\n\n  return moved;\n};\n","import {\n  getBlockAbove,\n  getChildren,\n  getEditorString,\n  getNode,\n  getNodeEntries,\n  getNodeEntry,\n  getParentNode,\n  getPluginType,\n  getPointAfter,\n  isSelectionAtBlockEnd,\n  PlateEditor,\n  removeNodes,\n  TElement,\n  TElementEntry,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { ELEMENT_LI } from './createListPlugin';\nimport { getListItemEntry, getListRoot, hasListChild } from './queries';\nimport {\n  moveListItemsToList,\n  moveListItemUp,\n  removeFirstListItem,\n  removeListItem,\n} from './transforms';\n\nconst selectionIsNotInAListHandler = <V extends Value>(\n  editor: PlateEditor<V>\n): boolean => {\n  const pointAfterSelection = getPointAfter(\n    editor,\n    editor.selection!.focus.path\n  );\n\n  if (pointAfterSelection) {\n    // there is a block after it\n    const nextSiblingListRes = getListItemEntry(editor, {\n      at: pointAfterSelection,\n    });\n\n    if (nextSiblingListRes) {\n      // the next block is a list\n      const { listItem } = nextSiblingListRes;\n      const parentBlockEntity = getBlockAbove(editor, {\n        at: editor.selection!.anchor,\n      });\n\n      if (!getEditorString(editor, parentBlockEntity![1])) {\n        // the selected block is empty\n        removeNodes(editor);\n\n        return true;\n      }\n\n      if (hasListChild(editor, listItem[0])) {\n        // the next block has children, so we have to move the first item up\n        const sublistRes = getListItemEntry(editor, {\n          at: [...listItem[1], 1, 0, 0],\n        });\n\n        moveListItemUp(editor, sublistRes!);\n      }\n    }\n  }\n\n  return false;\n};\n\nconst selectionIsInAListHandler = <V extends Value>(\n  editor: PlateEditor<V>,\n  res: { list: TElementEntry; listItem: TElementEntry }\n): boolean => {\n  const { listItem } = res;\n\n  // if it has no children\n  if (!hasListChild(editor, listItem[0])) {\n    const liType = getPluginType(editor, ELEMENT_LI);\n    const _nodes = getNodeEntries(editor, {\n      at: listItem[1],\n      mode: 'lowest',\n      match: (node, path) => {\n        if (path.length === 0) {\n          return false;\n        }\n\n        const isNodeLi = (node as TElement).type === liType;\n        const isSiblingOfNodeLi =\n          getNode<TElement>(editor, Path.next(path))?.type === liType;\n\n        return isNodeLi && isSiblingOfNodeLi;\n      },\n    });\n    const liWithSiblings = Array.from(_nodes, (entry) => entry[1])[0];\n\n    if (!liWithSiblings) {\n      // there are no more list item in the list\n      const pointAfterListItem = getPointAfter(editor, listItem[1]);\n\n      if (pointAfterListItem) {\n        // there is a block after it\n        const nextSiblingListRes = getListItemEntry(editor, {\n          at: pointAfterListItem,\n        });\n\n        if (nextSiblingListRes) {\n          // it is a list so we merge the lists\n          const listRoot = getListRoot(editor, listItem[1]);\n\n          moveListItemsToList(editor, {\n            fromList: nextSiblingListRes.list,\n            toList: listRoot,\n            deleteFromList: true,\n          });\n\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    const siblingListItem = getNodeEntry<TElement>(\n      editor,\n      Path.next(liWithSiblings)\n    );\n\n    const siblingList = getParentNode<TElement>(editor, siblingListItem[1]);\n\n    if (\n      siblingList &&\n      removeListItem(editor, {\n        list: siblingList,\n        listItem: siblingListItem,\n        reverse: false,\n      })\n    ) {\n      return true;\n    }\n\n    // if (skipDefaultDelete) return skipDefaultDelete;\n\n    return false;\n  }\n\n  // if it has children\n  const nestedList = getNodeEntry<TElement>(\n    editor,\n    Path.next([...listItem[1], 0])\n  );\n  const nestedListItem = getChildren<TElement>(nestedList)[0];\n\n  if (\n    removeFirstListItem(editor, {\n      list: nestedList,\n      listItem: nestedListItem,\n    })\n  ) {\n    return true;\n  }\n\n  if (\n    removeListItem(editor, {\n      list: nestedList,\n      listItem: nestedListItem,\n    })\n  ) {\n    return true;\n  }\n\n  return false;\n};\n\nexport const deleteForwardList = <V extends Value>(editor: PlateEditor<V>) => {\n  let skipDefaultDelete = false;\n\n  if (!editor?.selection) {\n    return skipDefaultDelete;\n  }\n\n  if (!isSelectionAtBlockEnd(editor)) {\n    return skipDefaultDelete;\n  }\n\n  withoutNormalizing(editor, () => {\n    const res = getListItemEntry(editor, {});\n\n    if (!res) {\n      skipDefaultDelete = selectionIsNotInAListHandler(editor);\n      return;\n    }\n\n    skipDefaultDelete = selectionIsInAListHandler(editor, res);\n  });\n\n  return skipDefaultDelete;\n};\n","import {\n  createPathRef,\n  deleteMerge,\n  getAboveNode,\n  getEndPoint,\n  getParentNode,\n  getPluginType,\n  getStartPoint,\n  PlateEditor,\n  removeNodes,\n  Value,\n  withoutNormalizing,\n} from '@udecode/plate-core';\nimport { Range } from 'slate';\nimport { getHighestEmptyList } from './queries/getHighestEmptyList';\nimport { hasListChild } from './queries/hasListChild';\nimport { isAcrossListItems } from './queries/isAcrossListItems';\nimport { ELEMENT_LI } from './createListPlugin';\n\nexport const deleteFragmentList = <V extends Value>(editor: PlateEditor<V>) => {\n  let deleted = false;\n\n  withoutNormalizing(editor, () => {\n    // Selection should be across list items\n    if (!isAcrossListItems(editor)) return;\n\n    /**\n     * Check if the end li can be deleted (if it has no sublist).\n     * Store the path ref to delete it after deleteMerge.\n     */\n    const end = getEndPoint(editor, editor.selection as Range);\n    const liEnd = getAboveNode(editor, {\n      at: end,\n      match: { type: getPluginType(editor, ELEMENT_LI) },\n    });\n    const liEndCanBeDeleted = liEnd && !hasListChild(editor, liEnd[0]);\n    const liEndPathRef = liEndCanBeDeleted\n      ? createPathRef(editor, liEnd![1])\n      : undefined;\n\n    /**\n     * Delete fragment and move end block children to start block\n     */\n    deleteMerge(editor);\n\n    const start = getStartPoint(editor, editor.selection as Range);\n    const liStart = getAboveNode(editor, {\n      at: start,\n      match: { type: getPluginType(editor, ELEMENT_LI) },\n    });\n\n    if (liEndPathRef) {\n      const liEndPath = liEndPathRef.unref()!;\n\n      const listStart = liStart && getParentNode(editor, liStart[1]);\n\n      const deletePath = getHighestEmptyList(editor, {\n        liPath: liEndPath,\n        diffListPath: listStart?.[1],\n      });\n\n      if (deletePath) {\n        removeNodes(editor, { at: deletePath });\n      }\n\n      deleted = true;\n    }\n  });\n\n  return deleted;\n};\n","import {\n  ELEMENT_DEFAULT,\n  getPluginType,\n  isBlockAboveEmpty,\n  mockPlugin,\n  PlateEditor,\n  Value,\n} from '@udecode/plate-core';\nimport {\n  onKeyDownResetNode,\n  ResetNodePlugin,\n  SIMULATE_BACKSPACE,\n} from '@udecode/plate-reset-node';\nimport { getListItemEntry } from './queries/getListItemEntry';\nimport { insertListItem } from './transforms/insertListItem';\nimport { moveListItemUp } from './transforms/moveListItemUp';\nimport { unwrapList } from './transforms/unwrapList';\nimport { ELEMENT_LI } from './createListPlugin';\n\nexport const insertBreakList = <V extends Value>(editor: PlateEditor<V>) => {\n  if (!editor.selection) return;\n\n  const res = getListItemEntry(editor, {});\n  let moved: boolean | undefined;\n\n  // If selection is in a li\n  if (res) {\n    const { list, listItem } = res;\n\n    // If selected li is empty, move it up.\n    if (isBlockAboveEmpty(editor)) {\n      moved = moveListItemUp(editor, {\n        list,\n        listItem,\n      });\n\n      if (moved) return true;\n    }\n  }\n\n  const didReset = onKeyDownResetNode(\n    editor as any,\n    mockPlugin<ResetNodePlugin>({\n      options: {\n        rules: [\n          {\n            types: [getPluginType(editor, ELEMENT_LI)],\n            defaultType: getPluginType(editor, ELEMENT_DEFAULT),\n            predicate: () => !moved && isBlockAboveEmpty(editor),\n            onReset: (_editor) => unwrapList(_editor),\n          },\n        ],\n      },\n    })\n  )(SIMULATE_BACKSPACE as any);\n  if (didReset) return true;\n\n  /**\n   * If selection is in li > p, insert li.\n   */\n  if (!moved) {\n    const inserted = insertListItem(editor);\n    if (inserted) return true;\n  }\n};\n","import {\n  findNode,\n  getCommonNode,\n  getNode,\n  getNodes,\n  getNodeString,\n  getNodeTexts,\n  getPlugin,\n  insertElements,\n  insertFragment,\n  isElement,\n  PlateEditor,\n  removeNodes,\n  TAncestor,\n  TAncestorEntry,\n  TDescendant,\n  TDescendantEntry,\n  TElement,\n  TElementEntry,\n  TText,\n  Value,\n  WithPlatePlugin,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { ELEMENT_LI } from './createListPlugin';\nimport { getListItemContentType, getListItemType, isListRoot } from './queries';\n\nexport const insertFragmentList = <V extends Value>(editor: PlateEditor<V>) => {\n  const { insertFragment: _insertFragment } = editor;\n\n  const listItemPlugin = getPlugin<{}, V>(editor, ELEMENT_LI);\n  const listItemType = getListItemType(editor);\n  const listItemContentType = getListItemContentType(editor);\n\n  const getFirstAncestorOfType = (\n    root: TDescendant,\n    entry: TDescendantEntry,\n    { type }: WithPlatePlugin\n  ): TAncestorEntry => {\n    let ancestor: Path = Path.parent(entry[1]);\n    while (getNode<TElement>(root, ancestor)!.type !== type) {\n      ancestor = Path.parent(ancestor);\n    }\n\n    return [getNode<TAncestor>(root, ancestor)!, ancestor];\n  };\n\n  const findListItemsWithContent = (first: TDescendant): TDescendant[] => {\n    let prev = null;\n    let node = first;\n    while (\n      isListRoot(editor, node) ||\n      (node.type === listItemType &&\n        (node.children as TElement[])[0].type !== listItemContentType)\n    ) {\n      prev = node;\n      [node] = node.children as TDescendant[];\n    }\n\n    return prev ? (prev.children as TDescendant[]) : [node];\n  };\n\n  /**\n   * Removes the \"empty\" leading lis. Empty in this context means lis only with other lis as children.\n   *\n   * @returns If argument is not a list root, returns it, otherwise returns ul[] or li[].\n   */\n  const trimList = (listRoot: TDescendant): TElement[] => {\n    if (!isListRoot(editor, listRoot)) {\n      return [listRoot as TElement];\n    }\n\n    const _texts = getNodeTexts(listRoot);\n    const textEntries = Array.from(_texts);\n\n    const commonAncestorEntry = textEntries.reduce(\n      (commonAncestor, textEntry) =>\n        Path.isAncestor(commonAncestor[1], textEntry[1])\n          ? commonAncestor\n          : (getCommonNode(listRoot, textEntry[1], commonAncestor[1]) as any),\n      // any list item would do, we grab the first one\n      getFirstAncestorOfType(listRoot, textEntries[0], listItemPlugin as any)\n    );\n\n    const [first, ...rest] = isListRoot(\n      editor,\n      commonAncestorEntry[0] as TDescendant\n    )\n      ? (commonAncestorEntry[0] as any).children\n      : [commonAncestorEntry[0]];\n    return [...findListItemsWithContent(first), ...rest];\n  };\n\n  const wrapNodeIntoListItem = (node: TDescendant): TElement => {\n    return node.type === listItemType\n      ? (node as TElement)\n      : ({\n          type: listItemType,\n          children: [node],\n        } as TElement);\n  };\n\n  /**\n   * Checks if the fragment only consists of a single LIC in which case it is considered the user's intention was to copy a text, not a list\n   */\n  const isSingleLic = (fragment: TDescendant[]) => {\n    const isFragmentOnlyListRoot =\n      fragment.length === 1 && isListRoot(editor, fragment[0]);\n\n    return (\n      isFragmentOnlyListRoot &&\n      [...getNodes({ children: fragment } as any)]\n        .filter((entry): entry is TElementEntry => isElement(entry[0]))\n        .filter(([node]) => node.type === listItemContentType).length === 1\n    );\n  };\n\n  const getTextAndListItemNodes = (\n    fragment: TDescendant[],\n    liEntry: TElementEntry,\n    licEntry: TElementEntry\n  ) => {\n    const [, liPath] = liEntry;\n    const [licNode, licPath] = licEntry;\n    const isEmptyNode = !getNodeString(licNode);\n    const [first, ...rest] = fragment\n      .flatMap(trimList)\n      .map(wrapNodeIntoListItem);\n    let textNode: TText;\n    let listItemNodes: TElement[];\n    if (isListRoot(editor, fragment[0])) {\n      if (isSingleLic(fragment)) {\n        textNode = first as any;\n        listItemNodes = rest as TElement[];\n      } else if (isEmptyNode) {\n        // FIXME: is there a more direct way to set this?\n        const li = getNode(editor, liPath);\n        const [, ...currentSublists] = li!.children as TElement[];\n        const [newLic, ...newSublists] = first.children as TElement[];\n        insertElements(editor, newLic, {\n          at: Path.next(licPath),\n          select: true,\n        });\n        removeNodes(editor, {\n          at: licPath,\n        });\n        if (newSublists?.length) {\n          if (currentSublists?.length) {\n            // TODO: any better way to compile the path where the LIs of the newly inserted element will be inserted?\n            const path = [...liPath, 1, 0];\n            insertElements(editor, newSublists[0].children as TElement[], {\n              at: path,\n              select: true,\n            });\n          } else {\n            insertElements(editor, newSublists, {\n              at: Path.next(licPath),\n              select: true,\n            });\n          }\n        }\n\n        textNode = { text: '' };\n        listItemNodes = rest as TElement[];\n      } else {\n        textNode = { text: '' };\n        listItemNodes = [first as TElement, ...(rest as TElement[])];\n      }\n    } else {\n      textNode = first as any;\n      listItemNodes = rest as TElement[];\n    }\n\n    return { textNode, listItemNodes };\n  };\n\n  return (fragment: TDescendant[]) => {\n    let liEntry = findNode<TElement>(editor, {\n      match: { type: listItemType },\n      mode: 'lowest',\n    });\n    // not inserting into a list item, delegate to other plugins\n    if (!liEntry) {\n      return _insertFragment(\n        isListRoot(editor, fragment[0]) ? [{ text: '' }, ...fragment] : fragment\n      );\n    }\n\n    // delete selection (if necessary) so that it can check if needs to insert into an empty block\n    insertFragment<TText>(editor, [{ text: '' }]);\n\n    // refetch to find the currently selected LI after the deletion above is performed\n    liEntry = findNode<TElement>(editor, {\n      match: { type: listItemType },\n      mode: 'lowest',\n    });\n\n    const licEntry = findNode<TElement>(editor, {\n      match: { type: listItemContentType },\n      mode: 'lowest',\n    });\n    if (!licEntry) {\n      return _insertFragment(\n        isListRoot(editor, fragment[0]) ? [{ text: '' }, ...fragment] : fragment\n      );\n    }\n\n    const { textNode, listItemNodes } = getTextAndListItemNodes(\n      fragment,\n      liEntry!,\n      licEntry\n    );\n\n    insertFragment<TText>(editor, [textNode]); // insert text if needed\n\n    const [, liPath] = liEntry!;\n\n    return insertElements(editor, listItemNodes, {\n      at: Path.next(liPath),\n      select: true,\n    });\n  };\n};\n","import {\n  createPathRef,\n  getChildren,\n  getParentNode,\n  getPluginType,\n  insertEmptyElement,\n  isBlock,\n  match,\n  moveNodes,\n  PlateEditor,\n  removeNodes,\n  setElements,\n  TDescendant,\n  TElement,\n  TElementEntry,\n  TNodeEntry,\n  Value,\n} from '@udecode/plate-core';\nimport { Path, PathRef } from 'slate';\nimport { ELEMENT_LIC, ELEMENT_OL, ELEMENT_UL } from '../createListPlugin';\nimport { getListTypes } from '../queries';\nimport { moveListItemUp } from '../transforms';\nimport { ListPlugin } from '../types';\n\n/**\n * Recursively get all the:\n * - block children\n * - inline children except those at excludeDepth\n */\nexport const getDeepInlineChildren = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    children,\n  }: {\n    children: TNodeEntry<TDescendant>[];\n  }\n) => {\n  const inlineChildren: TNodeEntry<TDescendant>[] = [];\n\n  for (const child of children) {\n    if (isBlock(editor, child[0])) {\n      inlineChildren.push(\n        ...getDeepInlineChildren(editor, {\n          children: getChildren(child),\n        })\n      );\n    } else {\n      inlineChildren.push(child);\n    }\n  }\n\n  return inlineChildren;\n};\n\n/**\n * If the list item has no child: insert an empty list item container.\n * Else: move the children that are not valid to the list item container.\n */\nexport const normalizeListItem = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    listItem,\n    validLiChildrenTypes = [],\n  }: { listItem: TElementEntry } & ListPlugin\n) => {\n  let changed = false;\n\n  const allValidLiChildrenTypes = [\n    getPluginType(editor, ELEMENT_UL),\n    getPluginType(editor, ELEMENT_OL),\n    getPluginType(editor, ELEMENT_LIC),\n    ...validLiChildrenTypes,\n  ];\n\n  const [, liPath] = listItem;\n  const liChildren = getChildren<TElement>(listItem);\n\n  // Get invalid (type) li children path refs to be moved\n  const invalidLiChildrenPathRefs = liChildren\n    .filter(([child]) => !allValidLiChildrenTypes.includes(child.type))\n    .map(([, childPath]) => createPathRef(editor, childPath));\n\n  const firstLiChild: TElementEntry | undefined = liChildren[0];\n  const [firstLiChildNode, firstLiChildPath] = firstLiChild ?? [];\n\n  // If li has no child or inline child, insert lic\n  if (!firstLiChild || !isBlock(editor, firstLiChildNode)) {\n    insertEmptyElement(editor, getPluginType(editor, ELEMENT_LIC), {\n      at: liPath.concat([0]),\n    });\n    return true;\n  }\n\n  // If first li child is a block but not lic, set it to lic\n  if (\n    isBlock(editor, firstLiChildNode) &&\n    !match(firstLiChildNode, [], {\n      type: getPluginType(editor, ELEMENT_LIC),\n    })\n  ) {\n    if (\n      match(firstLiChildNode, [], {\n        type: getListTypes(editor),\n      })\n    ) {\n      // the listItem has no lic so we move the children up a level\n      const parent = getParentNode(editor, listItem[1]);\n      const sublist = firstLiChild;\n      const children = getChildren<TElement>(firstLiChild).reverse();\n      children.forEach((c) => {\n        moveListItemUp(editor, {\n          list: sublist,\n          listItem: c,\n        });\n      });\n\n      removeNodes(editor, { at: [...parent![1], 0] });\n\n      return true;\n    }\n\n    // Allow block elements listed as valid li children types to be a first child instead of LIC\n    if (validLiChildrenTypes.includes(firstLiChildNode.type)) {\n      return true;\n    }\n\n    setElements(\n      editor,\n      {\n        type: getPluginType(editor, ELEMENT_LIC),\n      },\n      {\n        at: firstLiChildPath,\n      }\n    );\n\n    changed = true;\n  }\n\n  const licChildren = getChildren(firstLiChild);\n\n  if (licChildren.length) {\n    const blockPathRefs: PathRef[] = [];\n    const inlineChildren: TNodeEntry[] = [];\n\n    // Check that lic has no block children\n    for (const licChild of licChildren) {\n      if (!isBlock(editor, licChild[0])) {\n        break;\n      }\n\n      blockPathRefs.push(createPathRef(editor, licChild[1]));\n\n      inlineChildren.push(\n        ...getDeepInlineChildren(editor, {\n          children: getChildren(licChild),\n        })\n      );\n    }\n\n    const to = Path.next(licChildren[licChildren.length - 1]?.[1]);\n\n    // Move lic nested inline children to its children\n    inlineChildren.reverse().forEach(([, path]) => {\n      moveNodes(editor, {\n        at: path,\n        to,\n      });\n    });\n\n    // Remove lic block children\n    blockPathRefs.forEach((pathRef) => {\n      const path = pathRef.unref();\n\n      path &&\n        removeNodes(editor, {\n          at: path,\n        });\n    });\n\n    if (blockPathRefs.length) {\n      changed = true;\n    }\n  }\n\n  if (changed) return true;\n\n  // Ensure that any text nodes under the list are inside the list item container\n  invalidLiChildrenPathRefs.reverse().forEach((ref) => {\n    const path = ref.unref();\n\n    path &&\n      moveNodes(editor, {\n        at: path,\n        to: firstLiChildPath.concat([0]),\n      });\n  });\n\n  return !!invalidLiChildrenPathRefs.length;\n};\n","import {\n  getNodeEntry,\n  getParentNode,\n  match,\n  moveNodes,\n  PlateEditor,\n  TElement,\n  TElementEntry,\n  Value,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { getListTypes } from '../queries';\n\n// When pasting from e.g. Google Docs, the structure of nested lists like \"ul -> ul\"\n// should be normalized to \"ul -> li -> lic + ul\".\n// In other words, a nested list as a direct children of a list should be moved into a previous list item sibling\nexport const normalizeNestedList = <V extends Value>(\n  editor: PlateEditor<V>,\n  { nestedListItem }: { nestedListItem: TElementEntry }\n) => {\n  const [, path] = nestedListItem;\n\n  const parentNode = getParentNode(editor, path);\n  const hasParentList =\n    parentNode && match(parentNode[0], [], { type: getListTypes(editor) });\n  if (!hasParentList) {\n    return false;\n  }\n\n  let previousListItemPath: Path;\n  try {\n    previousListItemPath = Path.previous(path);\n  } catch (e) {\n    return false;\n  }\n\n  // Previous sibling is the new parent\n  const previousSiblingItem = getNodeEntry<TElement>(\n    editor,\n    previousListItemPath\n  );\n\n  if (previousSiblingItem) {\n    const [, previousPath] = previousSiblingItem;\n    const newPath = previousPath.concat([1]);\n\n    // Move the current item to the sublist\n    moveNodes(editor, {\n      at: path,\n      to: newPath,\n    });\n\n    return true;\n  }\n};\n","import {\n  ELEMENT_DEFAULT,\n  getChildren,\n  getNode,\n  getParentNode,\n  getPluginType,\n  getPreviousPath,\n  isElement,\n  match,\n  PlateEditor,\n  removeNodes,\n  setElements,\n  TElement,\n  TNodeEntry,\n  Value,\n  wrapNodes,\n} from '@udecode/plate-core';\nimport { Path } from 'slate';\nimport { ELEMENT_LI, ELEMENT_LIC } from '../createListPlugin';\nimport { getListTypes, isListRoot } from '../queries';\nimport { moveListItemsToList } from '../transforms';\nimport { ListPlugin } from '../types';\nimport { normalizeListItem } from './normalizeListItem';\nimport { normalizeNestedList } from './normalizeNestedList';\n\n/**\n * Normalize list node to force the ul>li>p+ul structure.\n */\nexport const normalizeList = <V extends Value>(\n  editor: PlateEditor<V>,\n  { validLiChildrenTypes }: ListPlugin\n) => {\n  const { normalizeNode } = editor;\n  const liType = getPluginType(editor, ELEMENT_LI);\n  const licType = getPluginType(editor, ELEMENT_LIC);\n  const defaultType = getPluginType(editor, ELEMENT_DEFAULT);\n\n  return ([node, path]: TNodeEntry) => {\n    if (!isElement(node)) {\n      return normalizeNode([node, path]);\n    }\n\n    if (isListRoot(editor, node)) {\n      const nonLiChild = getChildren([node, path]).find(\n        ([child]) => child.type !== liType\n      );\n\n      if (nonLiChild) {\n        return wrapNodes<TElement>(\n          editor,\n          { type: liType, children: [] },\n          { at: nonLiChild[1] }\n        );\n      }\n    }\n\n    // remove empty list\n    if (match(node, [], { type: getListTypes(editor) })) {\n      if (\n        !node.children.length ||\n        !node.children.find((item) => item.type === liType)\n      ) {\n        return removeNodes(editor, { at: path });\n      }\n\n      const nextPath = Path.next(path);\n      const nextNode = getNode<TElement>(editor, nextPath);\n\n      // Has a list afterwards with the same type\n      if (nextNode?.type === node.type) {\n        moveListItemsToList(editor, {\n          fromList: [nextNode, nextPath],\n          toList: [node, path],\n          deleteFromList: true,\n        });\n      }\n\n      const prevPath = getPreviousPath(path) as Path;\n      const prevNode = getNode<TElement>(editor, prevPath);\n\n      // Has a list before with the same type\n      if (prevNode?.type === node.type) {\n        editor.normalizeNode([prevNode, prevPath]);\n\n        // early return since this node will no longer exists\n        return;\n      }\n\n      if (normalizeNestedList(editor, { nestedListItem: [node, path] })) {\n        return;\n      }\n    }\n\n    if (node.type === getPluginType(editor, ELEMENT_LI)) {\n      if (\n        normalizeListItem(editor, {\n          listItem: [node, path],\n          validLiChildrenTypes,\n        })\n      ) {\n        return;\n      }\n    }\n\n    // LIC should have LI parent. If not, set LIC to DEFAULT type.\n    if (node.type === licType && licType !== defaultType) {\n      if (getParentNode(editor, path)?.[0].type !== liType) {\n        setElements(editor, { type: defaultType }, { at: path });\n        return;\n      }\n    }\n\n    normalizeNode([node, path]);\n  };\n};\n","import { PlateEditor, Value, WithPlatePlugin } from '@udecode/plate-core';\nimport { deleteBackwardList } from './deleteBackwardList';\nimport { deleteForwardList } from './deleteForwardList';\nimport { deleteFragmentList } from './deleteFragmentList';\nimport { insertBreakList } from './insertBreakList';\nimport { insertFragmentList } from './insertFragmentList';\nimport { normalizeList } from './normalizers';\nimport { ListPlugin } from './types';\n\nexport const withList = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  { options: { validLiChildrenTypes } }: WithPlatePlugin<ListPlugin, V, E>\n) => {\n  const { insertBreak, deleteBackward, deleteForward, deleteFragment } = editor;\n\n  editor.insertBreak = () => {\n    if (insertBreakList(editor)) return;\n\n    insertBreak();\n  };\n\n  editor.deleteBackward = (unit) => {\n    if (deleteBackwardList(editor, unit)) return;\n\n    deleteBackward(unit);\n  };\n\n  editor.deleteForward = (unit) => {\n    if (deleteForwardList(editor)) return;\n\n    deleteForward(unit);\n  };\n\n  editor.deleteFragment = () => {\n    if (deleteFragmentList(editor)) return;\n\n    deleteFragment();\n  };\n\n  editor.insertFragment = insertFragmentList(editor);\n\n  editor.normalizeNode = normalizeList(editor, { validLiChildrenTypes });\n\n  return editor;\n};\n","import {\n  createPluginFactory,\n  KEY_DESERIALIZE_HTML,\n  PlatePlugin,\n  someNode,\n} from '@udecode/plate-core';\nimport { onKeyDownList } from './onKeyDownList';\nimport { ListPlugin } from './types';\nimport { withList } from './withList';\n\nexport const ELEMENT_UL = 'ul';\nexport const ELEMENT_OL = 'ol';\nexport const ELEMENT_LI = 'li';\nexport const ELEMENT_LIC = 'lic';\n\n/**\n * Enables support for bulleted, numbered and to-do lists.\n */\nexport const createListPlugin = createPluginFactory({\n  key: 'list',\n  plugins: [\n    {\n      key: ELEMENT_UL,\n      isElement: true,\n      handlers: {\n        onKeyDown: onKeyDownList,\n      },\n      withOverrides: withList,\n      deserializeHtml: {\n        rules: [\n          {\n            validNodeName: 'UL',\n          },\n        ],\n      },\n    } as PlatePlugin<ListPlugin>,\n    {\n      key: ELEMENT_OL,\n      isElement: true,\n      handlers: {\n        onKeyDown: onKeyDownList,\n      },\n      deserializeHtml: { rules: [{ validNodeName: 'OL' }] },\n    } as PlatePlugin<ListPlugin>,\n    {\n      key: ELEMENT_LI,\n      isElement: true,\n      deserializeHtml: { rules: [{ validNodeName: 'LI' }] },\n      then: (editor, { type }) => ({\n        inject: {\n          pluginsByKey: {\n            [KEY_DESERIALIZE_HTML]: {\n              editor: {\n                insertData: {\n                  preInsert: () => {\n                    return someNode(editor, { match: { type } });\n                  },\n                },\n              },\n            },\n          },\n        },\n      }),\n    },\n    {\n      key: ELEMENT_LIC,\n      isElement: true,\n    },\n  ],\n});\n","import {\n  createPluginFactory,\n  HotkeyPlugin,\n  onKeyDownToggleElement,\n} from '@udecode/plate-core';\n\nexport const ELEMENT_TODO_LI = 'action_item';\n\nexport const createTodoListPlugin = createPluginFactory<HotkeyPlugin>({\n  key: ELEMENT_TODO_LI,\n  isElement: true,\n  handlers: {\n    onKeyDown: onKeyDownToggleElement,\n  },\n  options: {\n    hotkey: ['mod+opt+4', 'mod+shift+4'],\n  },\n});\n"],"names":["isArray","isListNested","editor","listPath","listParentNode","getParentNode","type","getPluginType","ELEMENT_LI","getUnorderedListType","ELEMENT_UL","getOrderedListType","ELEMENT_OL","getListTypes","getListItemType","getListItemContentType","ELEMENT_LIC","getHighestEmptyList","diffListPath","liPath","list","getAboveNode","at","match","listNode","Path","equals","children","length","liParent","getListItemEntry","selection","liType","_at","Range","isRange","isCollapsed","focus","path","anchor","node","getNode","listItem","getListRoot","parentList","parentListPath","hasListChild","some","n","isAcrossListItems","isAcrossBlocks","isRangeAcrossBlocks","someNode","isListRoot","isElement","includes","moveListItemDown","listItemPath","previousListItemPath","previous","e","previousSiblingItem","getNodeEntry","previousNode","previousPath","sublist","find","newPath","concat","withoutNormalizing","wrapNodes","moveNodes","to","moveListItemsToList","fromList","fromListItem","fromStartIndex","_to","toList","toListIndex","deleteFromList","fromListPath","moved","fromListItemSublist","findDescendant","lastChildPath","getLastChildPath","next","moveChildren","deleteText","unwrapList","ancestorListTypeCheck","commonNode","getCommonNode","setElements","ELEMENT_DEFAULT","unwrapNodes","split","moveListItemUp","move","liNode","toListPath","err","condA","condB","isLastChild","insertElements","toListNode","liParentPath","movedUpLiPath","removeFirstListItem","moveListItems","increase","undefined","enableResetOnShiftTab","_nodes","getNodeEntries","lics","Array","from","highestLicPaths","highestLicPathRefs","forEach","lic","licPath","parent","isAncestor","highestLiPath","push","createPathRef","licPathRefsToMove","reverse","licPathRef","unref","indentListItems","insertListItem","licType","licEntry","paragraphPath","listItemEntry","listItemNode","success","isStart","isStartPoint","isEnd","isBlockTextEmptyAfterSelection","nextParagraphPath","nextListItemPath","text","splitNodes","select","collapseSelection","edge","marks","getMarks","moveListItemSublistItemsToListItemSublist","toListItem","start","fromListItemPath","toListItemPath","fromListItemSublistPath","toListItemSublist","fromListNode","fromListType","toListItemSublistPath","moveListSiblingsAfterCursor","offset","listEntry","isParent","removeListItem","isExpanded","previousLiPath","getPreviousPath","previousLi","tempLiPath","tempLi","tempLiPathRef","deleteMerge","removeNodes","toggleList","res","mode","nodes","startPoint","endPoint","edges","commonEntry","startList","findNode","endList","end","rangeLength","Math","min","rootPathLength","filter","_n","unindentListItems","options","onKeyDownList","hotkey","isTab","Hotkeys","isUntab","workRange","isBackward","unHungRange","unhangRange","listSelected","preventDefault","hotkeys","_castArray","_hotkey","isHotkey","deleteBackwardList","unit","isSelectionAtBlockStart","isFirstChild","onKeyDownResetNode","mockPlugin","rules","types","defaultType","predicate","onReset","SIMULATE_BACKSPACE","selectionIsNotInAListHandler","pointAfterSelection","getPointAfter","nextSiblingListRes","parentBlockEntity","getBlockAbove","getEditorString","sublistRes","selectionIsInAListHandler","isNodeLi","isSiblingOfNodeLi","liWithSiblings","entry","pointAfterListItem","listRoot","siblingListItem","siblingList","nestedList","nestedListItem","getChildren","deleteForwardList","skipDefaultDelete","isSelectionAtBlockEnd","deleteFragmentList","deleted","getEndPoint","liEnd","liEndCanBeDeleted","liEndPathRef","getStartPoint","liStart","liEndPath","listStart","deletePath","insertBreakList","isBlockAboveEmpty","didReset","_editor","inserted","insertFragmentList","insertFragment","_insertFragment","listItemPlugin","getPlugin","listItemType","listItemContentType","getFirstAncestorOfType","root","ancestor","findListItemsWithContent","first","prev","trimList","_texts","getNodeTexts","textEntries","commonAncestorEntry","reduce","commonAncestor","textEntry","rest","wrapNodeIntoListItem","isSingleLic","fragment","isFragmentOnlyListRoot","getNodes","getTextAndListItemNodes","liEntry","licNode","isEmptyNode","getNodeString","flatMap","map","textNode","listItemNodes","li","currentSublists","newLic","newSublists","getDeepInlineChildren","inlineChildren","child","isBlock","normalizeListItem","validLiChildrenTypes","changed","allValidLiChildrenTypes","liChildren","invalidLiChildrenPathRefs","childPath","firstLiChild","firstLiChildNode","firstLiChildPath","insertEmptyElement","c","licChildren","blockPathRefs","licChild","pathRef","ref","normalizeNestedList","parentNode","hasParentList","normalizeList","normalizeNode","nonLiChild","item","nextPath","nextNode","prevPath","prevNode","withList","insertBreak","deleteBackward","deleteForward","deleteFragment","createListPlugin","createPluginFactory","key","plugins","handlers","onKeyDown","withOverrides","deserializeHtml","validNodeName","then","inject","pluginsByKey","KEY_DESERIALIZE_HTML","insertData","preInsert","ELEMENT_TODO_LI","createTodoListPlugin","onKeyDownToggleElement"],"mappings":"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"}
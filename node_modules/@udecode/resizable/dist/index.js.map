{"version":3,"file":"index.js","sources":["../src/utils/resizeLengthToRelative.ts","../src/utils/resizeLengthToStatic.ts","../src/utils/resizeLengthClamp.ts","../src/utils/isTouchEvent.ts","../src/components/ResizeHandle.tsx"],"sourcesContent":["import { ResizeLength, ResizeLengthRelative } from '../types';\n\nexport const resizeLengthToRelative = (\n  length: ResizeLength,\n  parentLength: number\n): ResizeLengthRelative => {\n  if (typeof length === 'number') {\n    return `${(length / parentLength) * 100}%`;\n  }\n\n  return length;\n};\n","import { ResizeLength, ResizeLengthStatic } from '../types';\n\nexport const resizeLengthToStatic = (\n  length: ResizeLength,\n  parentLength: number\n): ResizeLengthStatic => {\n  if (typeof length === 'string') {\n    return (parentLength * parseFloat(length)) / 100;\n  }\n\n  return length;\n};\n","import { ResizeLength, ResizeLengthStatic } from '../types';\nimport { resizeLengthToRelative } from './resizeLengthToRelative';\nimport { resizeLengthToStatic } from './resizeLengthToStatic';\n\nexport interface ResizeLengthClampOptions<T = ResizeLength> {\n  min?: T;\n  max?: T;\n}\n\nexport const resizeLengthClampStatic = (\n  length: ResizeLengthStatic,\n  { min, max }: ResizeLengthClampOptions<ResizeLengthStatic>\n): ResizeLengthStatic => {\n  if (min !== undefined) {\n    length = Math.max(length, min);\n  }\n\n  if (max !== undefined) {\n    length = Math.min(length, max);\n  }\n\n  return length;\n};\n\nexport const resizeLengthClamp = <T extends ResizeLength>(\n  length: T,\n  parentLength: number,\n  { min, max }: ResizeLengthClampOptions<ResizeLength>\n): T => {\n  const staticLength = resizeLengthToStatic(length, parentLength);\n\n  const clampedStaticLength = resizeLengthClampStatic(staticLength, {\n    min:\n      min !== undefined ? resizeLengthToStatic(min, parentLength) : undefined,\n    max:\n      max !== undefined ? resizeLengthToStatic(max, parentLength) : undefined,\n  });\n\n  switch (typeof length) {\n    case 'string':\n      return resizeLengthToRelative(clampedStaticLength, parentLength) as T;\n\n    case 'number':\n      return clampedStaticLength as T;\n\n    default:\n      throw new Error('Invalid length type');\n  }\n};\n","export const isTouchEvent = (\n  event: MouseEvent | TouchEvent\n): event is TouchEvent => 'touches' in event;\n","import {\n  MouseEventHandler,\n  TouchEventHandler,\n  useEffect,\n  useState,\n} from 'react';\nimport {\n  createComponentAs,\n  createElementAs,\n  HTMLPropsAs,\n} from '@udecode/plate-common';\nimport { ResizeDirection, ResizeEvent } from '../types';\nimport { isTouchEvent } from '../utils';\n\nexport type ResizeHandleProps = HTMLPropsAs<'div'> & {\n  direction: ResizeDirection;\n  width?: number;\n  startMargin?: number;\n  endMargin?: number;\n  zIndex?: number;\n  onResize?: (event: ResizeEvent) => void;\n  onMouseDown?: MouseEventHandler;\n  onTouchStart?: TouchEventHandler;\n  onHover?: () => void;\n  onHoverEnd?: () => void;\n};\n\nexport const useResizeHandleProps = ({\n  direction,\n  width = 10,\n  startMargin = 0,\n  endMargin = 0,\n  zIndex = 40,\n  onResize,\n  onMouseDown,\n  onTouchStart,\n  onHover,\n  onHoverEnd,\n  style,\n  ...props\n}: ResizeHandleProps) => {\n  const [isResizing, setIsResizing] = useState(false);\n  const [initialPosition, setInitialPosition] = useState(0);\n  const [initialSize, setInitialSize] = useState(0);\n\n  const isHorizontal = direction === 'left' || direction === 'right';\n\n  const handleMouseDown: MouseEventHandler = (event) => {\n    const { clientX, clientY } = event;\n    setInitialPosition(isHorizontal ? clientX : clientY);\n\n    const element = (event.target as HTMLElement).parentElement!;\n    setInitialSize(isHorizontal ? element.offsetWidth : element.offsetHeight);\n\n    setIsResizing(true);\n\n    onMouseDown?.(event);\n  };\n\n  const handleTouchStart: TouchEventHandler = (event) => {\n    const { touches } = event;\n    const touch = touches[0];\n    const { clientX, clientY } = touch;\n    setInitialPosition(isHorizontal ? clientX : clientY);\n\n    const element = (event.target as HTMLElement).parentElement!;\n    setInitialSize(isHorizontal ? element.offsetWidth : element.offsetHeight);\n    setIsResizing(true);\n    onTouchStart?.(event);\n  };\n\n  useEffect(() => {\n    if (!isResizing) return;\n\n    const sendResizeEvent = (\n      event: MouseEvent | TouchEvent,\n      finished: boolean\n    ) => {\n      const { clientX, clientY } = isTouchEvent(event)\n        ? event.touches[0] || event.changedTouches[0]\n        : event;\n\n      const currentPosition = isHorizontal ? clientX : clientY;\n      const delta = currentPosition - initialPosition;\n      onResize?.({ initialSize, delta, finished, direction });\n    };\n\n    const handleMouseMove = (event: MouseEvent | TouchEvent) =>\n      sendResizeEvent(event, false);\n\n    const handleMouseUp = (event: MouseEvent | TouchEvent) => {\n      setIsResizing(false);\n      onHoverEnd?.();\n      sendResizeEvent(event, true);\n    };\n\n    window.addEventListener('mousemove', handleMouseMove);\n    window.addEventListener('mouseup', handleMouseUp);\n    window.addEventListener('touchmove', handleMouseMove);\n    window.addEventListener('touchend', handleMouseUp);\n\n    return () => {\n      window.removeEventListener('mousemove', handleMouseMove);\n      window.removeEventListener('mouseup', handleMouseUp);\n      window.removeEventListener('touchmove', handleMouseMove);\n      window.removeEventListener('touchend', handleMouseUp);\n    };\n  }, [\n    isResizing,\n    initialPosition,\n    initialSize,\n    onResize,\n    isHorizontal,\n    onHoverEnd,\n    direction,\n  ]);\n\n  const handleMouseOver = () => {\n    onHover?.();\n  };\n\n  const handleMouseOut = () => {\n    if (!isResizing) {\n      onHoverEnd?.();\n    }\n  };\n\n  const nearSide = direction;\n  const start = isHorizontal ? 'top' : 'left';\n  const end = isHorizontal ? 'bottom' : 'right';\n  const size = isHorizontal ? 'width' : 'height';\n\n  return {\n    style: {\n      position: 'absolute',\n      [nearSide]: -width / 2,\n      [start]: startMargin,\n      [end]: endMargin,\n      [size]: width,\n      zIndex,\n      cursor: isHorizontal ? 'col-resize' : 'row-resize',\n      ...style,\n    },\n    onMouseDown: handleMouseDown,\n    onTouchStart: handleTouchStart,\n    onMouseOver: handleMouseOver,\n    onMouseOut: handleMouseOut,\n    onTouchMove: handleMouseOver,\n    onTouchEnd: handleMouseOut,\n    ...props,\n  };\n};\n\nexport const ResizeHandle = createComponentAs<ResizeHandleProps>((props) => {\n  const htmlProps = useResizeHandleProps(props);\n  return createElementAs('div', htmlProps);\n});\n"],"names":["resizeLengthToRelative","length","parentLength","resizeLengthToStatic","parseFloat","resizeLengthClampStatic","min","max","undefined","Math","resizeLengthClamp","staticLength","clampedStaticLength","Error","isTouchEvent","event","useResizeHandleProps","direction","width","startMargin","endMargin","zIndex","onResize","onMouseDown","onTouchStart","onHover","onHoverEnd","style","props","isResizing","setIsResizing","useState","initialPosition","setInitialPosition","initialSize","setInitialSize","isHorizontal","handleMouseDown","clientX","clientY","element","target","parentElement","offsetWidth","offsetHeight","handleTouchStart","touches","touch","useEffect","sendResizeEvent","finished","changedTouches","currentPosition","delta","handleMouseMove","handleMouseUp","window","addEventListener","removeEventListener","handleMouseOver","handleMouseOut","nearSide","start","end","size","position","cursor","onMouseOver","onMouseOut","onTouchMove","onTouchEnd","ResizeHandle","createComponentAs","htmlProps","createElementAs"],"mappings":"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"}
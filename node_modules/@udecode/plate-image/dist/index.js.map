{"version":3,"file":"index.js","sources":["../../../../node_modules/is-hotkey/lib/index.js","../src/hooks/useImageElement.ts","../src/hooks/useImageCaptionString.ts","../src/components/ImageCaption.tsx","../src/components/TextareaAutosize.tsx","../src/components/ImageCaptionTextarea.tsx","../src/components/ImageImg.tsx","../src/components/ImageResizable.tsx","../src/components/Image.tsx","../src/transforms/insertImage.ts","../src/withImageUpload.ts","../src/createImagePlugin.ts","../src/utils/isImageUrl.ts","../src/withImageEmbed.ts","../src/withImage.ts"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n/**\n * Constants.\n */\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar IS_MAC = () => typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);\n\nvar MODIFIERS = {\n  alt: 'altKey',\n  control: 'ctrlKey',\n  meta: 'metaKey',\n  shift: 'shiftKey'\n};\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar ALIASES = () => ({\n  add: '+',\n  break: 'pause',\n  cmd: 'meta',\n  command: 'meta',\n  ctl: 'control',\n  ctrl: 'control',\n  del: 'delete',\n  down: 'arrowdown',\n  esc: 'escape',\n  ins: 'insert',\n  left: 'arrowleft',\n  mod: IS_MAC() ? 'meta' : 'control',\n  opt: 'alt',\n  option: 'alt',\n  return: 'enter',\n  right: 'arrowright',\n  space: ' ',\n  spacebar: ' ',\n  up: 'arrowup',\n  win: 'meta',\n  windows: 'meta'\n});\n\nvar CODES = {\n  backspace: 8,\n  tab: 9,\n  enter: 13,\n  shift: 16,\n  control: 17,\n  alt: 18,\n  pause: 19,\n  capslock: 20,\n  escape: 27,\n  ' ': 32,\n  pageup: 33,\n  pagedown: 34,\n  end: 35,\n  home: 36,\n  arrowleft: 37,\n  arrowup: 38,\n  arrowright: 39,\n  arrowdown: 40,\n  insert: 45,\n  delete: 46,\n  meta: 91,\n  numlock: 144,\n  scrolllock: 145,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  '\\'': 222\n};\n\nfor (var f = 1; f < 20; f++) {\n  CODES['f' + f] = 111 + f;\n}\n\n/**\n * Is hotkey?\n */\n\nfunction isHotkey(hotkey, options, event) {\n  if (options && !('byKey' in options)) {\n    event = options;\n    options = null;\n  }\n\n  if (!Array.isArray(hotkey)) {\n    hotkey = [hotkey];\n  }\n\n  var array = hotkey.map(function (string) {\n    return parseHotkey(string, options);\n  });\n  var check = function check(e) {\n    return array.some(function (object) {\n      return compareHotkey(object, e);\n    });\n  };\n  var ret = event == null ? check : check(event);\n  return ret;\n}\n\nfunction isCodeHotkey(hotkey, event) {\n  return isHotkey(hotkey, event);\n}\n\nfunction isKeyHotkey(hotkey, event) {\n  return isHotkey(hotkey, { byKey: true }, event);\n}\n\n/**\n * Parse.\n */\n\nfunction parseHotkey(hotkey, options) {\n  var byKey = options && options.byKey;\n  var ret = {};\n\n  // Special case to handle the `+` key since we use it as a separator.\n  hotkey = hotkey.replace('++', '+add');\n  var values = hotkey.split('+');\n  var length = values.length;\n\n  // Ensure that all the modifiers are set to false unless the hotkey has them.\n\n  for (var k in MODIFIERS) {\n    ret[MODIFIERS[k]] = false;\n  }\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = values[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var value = _step.value;\n\n      var optional = value.endsWith('?') && value.length > 1;\n\n      if (optional) {\n        value = value.slice(0, -1);\n      }\n\n      var name = toKeyName(value);\n      var modifier = MODIFIERS[name];\n\n      if (length === 1 || !modifier) {\n        if (byKey) {\n          ret.key = name;\n        } else {\n          ret.which = toKeyCode(value);\n        }\n      }\n\n      if (modifier) {\n        ret[modifier] = optional ? null : true;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return ret;\n}\n\n/**\n * Compare.\n */\n\nfunction compareHotkey(object, event) {\n  for (var key in object) {\n    var expected = object[key];\n    var actual = void 0;\n\n    if (expected == null) {\n      continue;\n    }\n\n    if (key === 'key' && event.key != null) {\n      actual = event.key.toLowerCase();\n    } else if (key === 'which') {\n      actual = expected === 91 && event.which === 93 ? 91 : event.which;\n    } else {\n      actual = event[key];\n    }\n\n    if (actual == null && expected === false) {\n      continue;\n    }\n\n    if (actual !== expected) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Utils.\n */\n\nfunction toKeyCode(name) {\n  name = toKeyName(name);\n  var code = CODES[name] || name.toUpperCase().charCodeAt(0);\n  return code;\n}\n\nfunction toKeyName(name) {\n  name = name.toLowerCase();\n  name = ALIASES()[name] || name;\n  return name;\n}\n\n/**\n * Export.\n */\n\nexports.default = isHotkey;\nexports.isHotkey = isHotkey;\nexports.isCodeHotkey = isCodeHotkey;\nexports.isKeyHotkey = isKeyHotkey;\nexports.parseHotkey = parseHotkey;\nexports.compareHotkey = compareHotkey;\nexports.toKeyCode = toKeyCode;\nexports.toKeyName = toKeyName;","import { useElement } from '@udecode/plate-core';\nimport { ELEMENT_IMAGE } from '../createImagePlugin';\nimport { TImageElement } from '../types';\n\nexport const useImageElement = () => useElement<TImageElement>(ELEMENT_IMAGE);\n","import { useMemo } from 'react';\nimport { getNodeString } from '@udecode/plate-core';\nimport { useImageElement } from './useImageElement';\n\nexport const useImageCaptionString = () => {\n  const {\n    caption: nodeCaption = [{ children: [{ text: '' }] }],\n  } = useImageElement();\n\n  return useMemo(() => {\n    return getNodeString(nodeCaption[0] as any) || '';\n  }, [nodeCaption]);\n};\n","import {\n  createComponentAs,\n  createElementAs,\n  HTMLPropsAs,\n} from '@udecode/plate-core';\nimport { useReadOnly, useSelected } from 'slate-react';\nimport { useImageCaptionString } from '../hooks/useImageCaptionString';\nimport { useImageStore } from './Image';\n\nexport interface ImageCaptionProps extends HTMLPropsAs<'figcaption'> {\n  readOnly?: boolean;\n}\n\nexport const useImageCaption = ({\n  readOnly,\n  ...props\n}: ImageCaptionProps = {}): HTMLPropsAs<'figcaption'> => {\n  const width = useImageStore().get.width();\n\n  return {\n    style: { width },\n    ...props,\n  };\n};\n\nexport const useImageCaptionState = (props: ImageCaptionProps) => {\n  const captionString = useImageCaptionString();\n\n  const selected = useSelected();\n  const _readOnly = useReadOnly();\n  const readOnly = props.readOnly || _readOnly;\n\n  return {\n    captionString,\n    selected,\n    readOnly,\n  };\n};\n\nexport const ImageCaption = createComponentAs<ImageCaptionProps>((props) => {\n  const htmlProps = useImageCaption(props);\n  const { captionString, selected, readOnly } = useImageCaptionState(props);\n\n  if (!captionString.length && (readOnly || !selected)) {\n    return null;\n  }\n\n  return createElementAs('figcaption', htmlProps);\n});\n","import React, { forwardRef, useLayoutEffect, useState } from 'react';\nimport ReactTextareaAutosize, {\n  TextareaAutosizeProps,\n} from 'react-textarea-autosize';\n\n/**\n * `<textarea />` component for React which grows with content.\n * @see https://github.com/Andarist/react-textarea-autosize\n * @see https://github.com/Andarist/react-textarea-autosize/issues/337\n */\nexport const TextareaAutosize = forwardRef<\n  HTMLTextAreaElement,\n  TextareaAutosizeProps\n>((props, ref) => {\n  const [isRerendered, setIsRerendered] = useState(false);\n\n  useLayoutEffect(() => setIsRerendered(true), []);\n\n  return isRerendered ? <ReactTextareaAutosize {...props} ref={ref} /> : null;\n});\n","import React, {\n  RefAttributes,\n  RefObject,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { TextareaAutosizeProps } from 'react-textarea-autosize';\nimport {\n  AsProps,\n  createComponentAs,\n  findNodePath,\n  focusEditor,\n  getNodeString,\n  getPointAfter,\n  setNodes,\n  TElement,\n  useComposedRef,\n  useEditorRef,\n} from '@udecode/plate-core';\nimport isHotkey from 'is-hotkey';\nimport { Path } from 'slate';\nimport { useReadOnly } from 'slate-react';\nimport { useImageElement } from '../hooks/index';\nimport { TImageElement } from '../types';\nimport { imageGlobalStore } from './Image';\nimport { TextareaAutosize } from './TextareaAutosize';\n\nexport interface ImageCaptionTextareaProps\n  extends TextareaAutosizeProps,\n    RefAttributes<HTMLTextAreaElement>,\n    AsProps<'textarea'> {}\n\n/**\n * Focus textareaRef when focusCaptionPath is set to the image path.\n */\nexport const useImageCaptionTextareaFocus = (\n  textareaRef: RefObject<HTMLTextAreaElement>\n) => {\n  const editor = useEditorRef();\n  const element = useImageElement();\n\n  const focusCaptionPath = imageGlobalStore.use.focusEndCaptionPath();\n\n  useEffect(() => {\n    if (focusCaptionPath && textareaRef.current) {\n      const path = findNodePath(editor, element);\n      if (path && Path.equals(path, focusCaptionPath)) {\n        textareaRef.current.focus();\n        imageGlobalStore.set.focusEndCaptionPath(null);\n      }\n    }\n  }, [editor, element, focusCaptionPath, textareaRef]);\n};\n\nexport const useImageCaptionTextarea = (\n  props: ImageCaptionTextareaProps\n): TextareaAutosizeProps & RefAttributes<HTMLTextAreaElement> => {\n  const element = useImageElement();\n\n  const {\n    caption: nodeCaption = [{ children: [{ text: '' }] }] as [TElement],\n  } = element;\n\n  const [captionValue, setCaptionValue] = useState<\n    TextareaAutosizeProps['value']\n  >(getNodeString(nodeCaption[0]));\n\n  const editor = useEditorRef();\n  const readOnly = useReadOnly();\n\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n  const ref = useComposedRef(textareaRef, props.ref);\n\n  useImageCaptionTextareaFocus(textareaRef);\n\n  const onChange: TextareaAutosizeProps['onChange'] = useCallback(\n    (e) => {\n      const newValue = e.target.value;\n\n      // local state\n      setCaptionValue(newValue);\n\n      const path = findNodePath(editor, element);\n      if (!path) return;\n\n      // saved state\n      setNodes<TImageElement>(\n        editor,\n        { caption: [{ text: newValue }] },\n        { at: path }\n      );\n    },\n    [editor, element]\n  );\n\n  const onKeyDown: TextareaAutosizeProps['onKeyDown'] = (e) => {\n    // select image\n    if (isHotkey('up', e)) {\n      const path = findNodePath(editor, element);\n      if (!path) return;\n\n      e.preventDefault();\n\n      focusEditor(editor, path);\n    }\n\n    // select next block\n    if (isHotkey('down', e)) {\n      const path = findNodePath(editor, element);\n      if (!path) return;\n\n      const nextNodePath = getPointAfter(editor, path);\n      if (!nextNodePath) return;\n\n      e.preventDefault();\n\n      focusEditor(editor, nextNodePath);\n    }\n  };\n\n  return {\n    value: captionValue,\n    readOnly,\n    onChange,\n    onKeyDown,\n    ...props,\n    ref,\n  };\n};\n\nexport const ImageCaptionTextarea = createComponentAs<ImageCaptionTextareaProps>(\n  ({ as, ...props }) => {\n    const htmlProps = useImageCaptionTextarea({ as: as as any, ...props });\n\n    return <TextareaAutosize {...htmlProps} />;\n  }\n);\n","import {\n  createComponentAs,\n  createElementAs,\n  HTMLPropsAs,\n} from '@udecode/plate-core';\nimport { useImageElement } from '../hooks/index';\nimport { useImageCaptionString } from '../hooks/useImageCaptionString';\n\nexport const useImageImg = (props?: HTMLPropsAs<'img'>): HTMLPropsAs<'img'> => {\n  const { url } = useImageElement();\n\n  const captionString = useImageCaptionString();\n\n  return {\n    src: url,\n    alt: captionString,\n    draggable: true,\n    ...props,\n  };\n};\n\nexport const ImageImg = createComponentAs((props) => {\n  const htmlProps = useImageImg(props);\n\n  return createElementAs('img', htmlProps);\n});\n","import React, { useCallback, useEffect } from 'react';\nimport {\n  AsProps,\n  createComponentAs,\n  findNodePath,\n  isDefined,\n  select,\n  setNodes,\n  useEditorRef,\n} from '@udecode/plate-core';\nimport { Resizable, ResizableProps } from 're-resizable';\nimport { useReadOnly } from 'slate-react';\nimport { useImageElement } from '../hooks/index';\nimport { TImageElement } from '../types';\nimport { useImageStore } from './Image';\n\nexport interface ImageResizableProps\n  extends Omit<ResizableProps, 'as'>,\n    AsProps<'div'> {\n  /**\n   * Image alignment.\n   */\n  align?: 'left' | 'center' | 'right';\n\n  readOnly?: boolean;\n}\n\nexport const useImageResizable = ({\n  align = 'center',\n  readOnly,\n  ...props\n}: ImageResizableProps): ResizableProps => {\n  const element = useImageElement();\n  const editor = useEditorRef();\n  const _readOnly = useReadOnly();\n  readOnly = isDefined(readOnly) ? readOnly : _readOnly;\n\n  const { width: nodeWidth = '100%' } = element ?? {};\n\n  const [width, setWidth] = useImageStore().use.width();\n\n  const setNodeWidth = useCallback(\n    (w: number) => {\n      const path = findNodePath(editor, element!);\n      if (!path) return;\n\n      if (w === nodeWidth) {\n        // Focus the node if not resized\n        select(editor, path);\n      } else {\n        setNodes<TImageElement>(editor, { width: w }, { at: path });\n      }\n    },\n    [editor, element, nodeWidth]\n  );\n\n  useEffect(() => {\n    setWidth(nodeWidth);\n  }, [nodeWidth, setWidth]);\n\n  const defaultProps: ResizableProps = {\n    minWidth: 92,\n    size: { width: width!, height: '100%' },\n    maxWidth: '100%',\n    lockAspectRatio: true,\n    resizeRatio: align === 'center' ? 2 : 1,\n    enable: {\n      left: ['center', 'left'].includes(align),\n      right: ['center', 'right'].includes(align),\n    },\n    handleStyles: {\n      left: { left: 0 },\n      right: { right: 0 },\n    },\n    onResize: (e, direction, ref) => {\n      setWidth(ref.offsetWidth);\n    },\n    onResizeStop: (e, direction, ref) => setNodeWidth(ref.offsetWidth),\n  };\n\n  if (readOnly) {\n    return {\n      ...defaultProps,\n      ...props,\n      enable: {\n        left: false,\n        right: false,\n        top: false,\n        bottom: false,\n        topLeft: false,\n        bottomLeft: false,\n        topRight: false,\n        bottomRight: false,\n      },\n    };\n  }\n\n  return { ...defaultProps, ...props };\n};\n\nexport const ImageResizable = createComponentAs<ImageResizableProps>(\n  (props) => {\n    const resizableProps = useImageResizable(props);\n\n    return <Resizable {...resizableProps} />;\n  }\n);\n","import { CSSProperties } from 'react';\nimport {\n  createAtomStore,\n  createComponentAs,\n  createElementAs,\n  createStore,\n  HTMLPropsAs,\n  PlateRenderElementProps,\n  TPath,\n  useComposedRef,\n  Value,\n} from '@udecode/plate-core';\nimport { TImageElement } from '../types';\nimport { ImageCaption } from './ImageCaption';\nimport { ImageCaptionTextarea } from './ImageCaptionTextarea';\nimport { ImageImg } from './ImageImg';\nimport { ImageResizable } from './ImageResizable';\n\nexport const { imageStore, useImageStore } = createAtomStore(\n  {\n    width: 0 as CSSProperties['width'],\n  },\n  { name: 'image' as const, scope: 'img' }\n);\n\nexport const imageGlobalStore = createStore('image')({\n  /**\n   * When defined, focus end of caption textarea of the image with the same path.\n   */\n  focusEndCaptionPath: null as TPath | null,\n\n  /**\n   * When defined, focus start of caption textarea of the image with the same path.\n   */\n  focusStartCaptionPath: null as TPath | null,\n});\n\nexport type ImageProps = PlateRenderElementProps<Value, TImageElement> &\n  HTMLPropsAs<'div'>;\n\nexport const useElementProps = ({\n  attributes,\n  nodeProps,\n  element,\n  editor,\n  ...props\n}: ImageProps): HTMLPropsAs<'div'> => {\n  return {\n    ...attributes,\n    ...props,\n    ...nodeProps,\n    ref: useComposedRef(props.ref, attributes.ref),\n  };\n};\n\nexport const ImageRoot = createComponentAs<ImageProps>((props) => {\n  const htmlProps = useElementProps(props as any);\n\n  return createElementAs('div', htmlProps);\n});\n\nexport const Image = {\n  Root: ImageRoot,\n  Caption: ImageCaption,\n  Img: ImageImg,\n  Resizable: ImageResizable,\n  CaptionTextarea: ImageCaptionTextarea,\n};\n","import {\n  getPluginType,\n  insertNodes,\n  PlateEditor,\n  Value,\n} from '@udecode/plate-core';\nimport { ELEMENT_IMAGE } from '../createImagePlugin';\nimport { TImageElement } from '../types';\n\nexport const insertImage = <V extends Value>(\n  editor: PlateEditor<V>,\n  url: string | ArrayBuffer\n) => {\n  const text = { text: '' };\n  const image: TImageElement = {\n    type: getPluginType(editor, ELEMENT_IMAGE),\n    url: url as any,\n    children: [text],\n  };\n  insertNodes<TImageElement>(editor, image);\n};\n","import {\n  getInjectedPlugins,\n  pipeInsertDataQuery,\n  PlateEditor,\n  Value,\n  WithPlatePlugin,\n} from '@udecode/plate-core';\nimport { insertImage } from './transforms/insertImage';\nimport { ImagePlugin } from './types';\n\n/**\n * Allows for pasting images from clipboard.\n * Not yet: dragging and dropping images, selecting them through a file system dialog.\n */\nexport const withImageUpload = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  plugin: WithPlatePlugin<ImagePlugin, V, E>\n) => {\n  const {\n    options: { uploadImage },\n  } = plugin;\n  const { insertData } = editor;\n\n  editor.insertData = (dataTransfer: DataTransfer) => {\n    const text = dataTransfer.getData('text/plain');\n    const { files } = dataTransfer;\n\n    if (files && files.length > 0) {\n      const injectedPlugins = getInjectedPlugins<{}, V, E>(editor, plugin);\n      if (\n        !pipeInsertDataQuery<{}, V, E>(injectedPlugins, {\n          data: text,\n          dataTransfer,\n        })\n      ) {\n        return insertData(dataTransfer);\n      }\n\n      for (const file of files) {\n        const reader = new FileReader();\n        const [mime] = file.type.split('/');\n\n        if (mime === 'image') {\n          reader.addEventListener('load', async () => {\n            if (!reader.result) {\n              return;\n            }\n            const uploadedUrl = uploadImage\n              ? await uploadImage(reader.result)\n              : reader.result;\n\n            insertImage(editor, uploadedUrl);\n          });\n\n          reader.readAsDataURL(file);\n        }\n      }\n    } else {\n      insertData(dataTransfer);\n    }\n  };\n\n  return editor;\n};\n","import {\n  createPluginFactory,\n  getBlockAbove,\n  getPluginType,\n} from '@udecode/plate-core';\nimport isHotkey from 'is-hotkey';\nimport { imageGlobalStore } from './components/index';\nimport { ImagePlugin } from './types';\nimport { withImageUpload } from './withImageUpload';\n\nexport const ELEMENT_IMAGE = 'img';\n\n/**\n * Enables support for images.\n */\nexport const createImagePlugin = createPluginFactory<ImagePlugin>({\n  key: ELEMENT_IMAGE,\n  isElement: true,\n  isVoid: true,\n  withOverrides: withImageUpload,\n  handlers: {\n    onKeyDown: (editor) => (e) => {\n      // focus caption from image\n      if (isHotkey('down', e)) {\n        const entry = getBlockAbove(editor, {\n          match: { type: getPluginType(editor, ELEMENT_IMAGE) },\n        });\n        if (!entry) return;\n\n        imageGlobalStore.set.focusEndCaptionPath(entry[1]);\n      }\n\n      // TODO: focus caption from line below image\n      // if (isHotkey('up', e)) {\n      // }\n    },\n  },\n  then: (editor, { type }) => ({\n    deserializeHtml: {\n      rules: [\n        {\n          validNodeName: 'IMG',\n        },\n      ],\n      getNode: (el) => ({\n        type,\n        url: el.getAttribute('src'),\n      }),\n    },\n  }),\n});\n","import { isUrl } from '@udecode/plate-core';\n\nconst imageExtensions = [\n  'ase',\n  'art',\n  'bmp',\n  'blp',\n  'cd5',\n  'cit',\n  'cpt',\n  'cr2',\n  'cut',\n  'dds',\n  'dib',\n  'djvu',\n  'egt',\n  'exif',\n  'gif',\n  'gpl',\n  'grf',\n  'icns',\n  'ico',\n  'iff',\n  'jng',\n  'jpeg',\n  'jpg',\n  'jfif',\n  'jp2',\n  'jps',\n  'lbm',\n  'max',\n  'miff',\n  'mng',\n  'msp',\n  'nitf',\n  'ota',\n  'pbm',\n  'pc1',\n  'pc2',\n  'pc3',\n  'pcf',\n  'pcx',\n  'pdn',\n  'pgm',\n  'PI1',\n  'PI2',\n  'PI3',\n  'pict',\n  'pct',\n  'pnm',\n  'pns',\n  'ppm',\n  'psb',\n  'psd',\n  'pdd',\n  'psp',\n  'px',\n  'pxm',\n  'pxr',\n  'qfx',\n  'raw',\n  'rle',\n  'sct',\n  'sgi',\n  'rgb',\n  'int',\n  'bw',\n  'tga',\n  'tiff',\n  'tif',\n  'vtf',\n  'xbm',\n  'xcf',\n  'xpm',\n  '3dv',\n  'amf',\n  'ai',\n  'awg',\n  'cgm',\n  'cdr',\n  'cmx',\n  'dxf',\n  'e2d',\n  'egt',\n  'eps',\n  'fs',\n  'gbr',\n  'odg',\n  'svg',\n  'stl',\n  'vrml',\n  'x3d',\n  'sxd',\n  'v2d',\n  'vnd',\n  'wmf',\n  'emf',\n  'art',\n  'xar',\n  'png',\n  'webp',\n  'jxr',\n  'hdp',\n  'wdp',\n  'cur',\n  'ecw',\n  'iff',\n  'lbm',\n  'liff',\n  'nrrd',\n  'pam',\n  'pcx',\n  'pgf',\n  'sgi',\n  'rgb',\n  'rgba',\n  'bw',\n  'int',\n  'inta',\n  'sid',\n  'ras',\n  'sun',\n  'tga',\n];\n\nexport const isImageUrl = (url: string) => {\n  if (!isUrl(url)) return false;\n\n  const ext = new URL(url).pathname.split('.').pop() as string;\n\n  return imageExtensions.includes(ext);\n};\n","import { PlateEditor, Value, WithPlatePlugin } from '@udecode/plate-core';\nimport { insertImage } from './transforms/insertImage';\nimport { isImageUrl } from './utils/isImageUrl';\nimport { ImagePlugin } from './types';\n\n/**\n * If inserted text is image url, insert image instead.\n */\nexport const withImageEmbed = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  plugin: WithPlatePlugin<ImagePlugin, V, E>\n) => {\n  const { insertData } = editor;\n\n  editor.insertData = (dataTransfer: DataTransfer) => {\n    const text = dataTransfer.getData('text/plain');\n\n    if (isImageUrl(text)) {\n      insertImage(editor, text);\n      return;\n    }\n\n    insertData(dataTransfer);\n  };\n\n  return editor;\n};\n","import { PlateEditor, Value, WithPlatePlugin } from '@udecode/plate-core';\nimport { ImagePlugin } from './types';\nimport { withImageEmbed } from './withImageEmbed';\nimport { withImageUpload } from './withImageUpload';\n\n/**\n * @see withImageUpload\n * @see withImageEmbed\n */\nexport const withImage = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  plugin: WithPlatePlugin<ImagePlugin, V, E>\n) => {\n  const {\n    options: { disableUploadInsert, disableEmbedInsert },\n  } = plugin;\n\n  if (!disableUploadInsert) {\n    editor = withImageUpload(editor, plugin);\n  }\n\n  if (!disableEmbedInsert) {\n    editor = withImageEmbed(editor, plugin);\n  }\n\n  return editor;\n};\n"],"names":["useImageElement","useElement","ELEMENT_IMAGE","useImageCaptionString","caption","nodeCaption","children","text","useMemo","getNodeString","useImageCaption","readOnly","props","width","useImageStore","get","style","useImageCaptionState","captionString","selected","useSelected","_readOnly","useReadOnly","ImageCaption","createComponentAs","htmlProps","length","createElementAs","TextareaAutosize","forwardRef","ref","isRerendered","setIsRerendered","useState","useLayoutEffect","React","ReactTextareaAutosize","useImageCaptionTextareaFocus","textareaRef","editor","useEditorRef","element","focusCaptionPath","imageGlobalStore","use","focusEndCaptionPath","useEffect","current","path","findNodePath","Path","equals","focus","set","useImageCaptionTextarea","captionValue","setCaptionValue","useRef","useComposedRef","onChange","useCallback","e","newValue","target","value","setNodes","at","onKeyDown","isHotkey","preventDefault","focusEditor","nextNodePath","getPointAfter","ImageCaptionTextarea","as","useImageImg","url","src","alt","draggable","ImageImg","useImageResizable","align","isDefined","nodeWidth","setWidth","setNodeWidth","w","select","defaultProps","minWidth","size","height","maxWidth","lockAspectRatio","resizeRatio","enable","left","includes","right","handleStyles","onResize","direction","offsetWidth","onResizeStop","top","bottom","topLeft","bottomLeft","topRight","bottomRight","ImageResizable","resizableProps","Resizable","imageStore","createAtomStore","name","scope","createStore","focusStartCaptionPath","useElementProps","attributes","nodeProps","ImageRoot","Image","Root","Caption","Img","CaptionTextarea","insertImage","image","type","getPluginType","insertNodes","withImageUpload","plugin","options","uploadImage","insertData","dataTransfer","getData","files","injectedPlugins","getInjectedPlugins","pipeInsertDataQuery","data","file","reader","FileReader","mime","split","addEventListener","result","uploadedUrl","readAsDataURL","createImagePlugin","createPluginFactory","key","isElement","isVoid","withOverrides","handlers","entry","getBlockAbove","match","then","deserializeHtml","rules","validNodeName","getNode","el","getAttribute","imageExtensions","isImageUrl","isUrl","ext","URL","pathname","pop","withImageEmbed","withImage","disableUploadInsert","disableEmbedInsert"],"mappings":"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"}
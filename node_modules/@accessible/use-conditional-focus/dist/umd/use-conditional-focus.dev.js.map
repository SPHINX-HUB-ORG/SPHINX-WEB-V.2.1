{"version":3,"file":"use-conditional-focus.dev.js","sources":["../../node_modules/@accessible/tabbable/src/index.ts","../../node_modules/@react-hook/passive-layout-effect/src/index.tsx","../../node_modules/@react-hook/latest/src/index.tsx","../../node_modules/@react-hook/event/src/index.tsx","../../src/index.tsx"],"sourcesContent":["// Credit:\n// https://github.com/davidtheclark/tabbable\nconst candidateSelector =\n  'input,select,textarea,a[href],button,[tabindex],' +\n  'audio[controls],video[controls],' +\n  '[contenteditable]:not([contenteditable=\"false\"])'\n\nexport interface Tabbables {\n  documentOrder: number\n  tabIndex: number\n  node: HTMLElement | HTMLInputElement\n}\n\nconst matches: Element['matches'] =\n  typeof Element === 'undefined'\n    ? () => false\n    : Element.prototype.matches ||\n      // @ts-ignore\n      Element.prototype.msMatchesSelector ||\n      Element.prototype.webkitMatchesSelector\n\nconst tabbable = (el: HTMLElement, includeRootNode = false): HTMLElement[] => {\n  const regularTabbables: HTMLElement[] = []\n  const orderedTabbables: Tabbables[] = []\n\n  let candidates: HTMLElement[] | NodeListOf<HTMLElement> = el.querySelectorAll(\n    candidateSelector\n  )\n\n  if (includeRootNode && matches.call(el, candidateSelector)) {\n    candidates = Array.prototype.slice.apply(candidates) as HTMLElement[]\n    candidates.unshift(el)\n  }\n\n  let i, candidate, candidateTabindex\n  for (i = 0; i < candidates.length; i++) {\n    candidate = candidates[i]\n    if (!isNodeMatchingSelectorTabbable(candidate)) continue\n    candidateTabindex = getTabindex(candidate)\n\n    if (candidateTabindex === 0) {\n      regularTabbables.push(candidate)\n    } else {\n      orderedTabbables.push({\n        documentOrder: i,\n        tabIndex: candidateTabindex,\n        node: candidate,\n      })\n    }\n  }\n\n  return orderedTabbables\n    .sort(sortOrderedTabbables)\n    .map((a) => a.node)\n    .concat(regularTabbables)\n}\n\nconst isNodeMatchingSelectorTabbable = (node: HTMLElement) =>\n  !(\n    !isNodeMatchingSelectorFocusable(node) ||\n    (node.tagName === 'INPUT' &&\n      (node as HTMLInputElement).type === 'radio' &&\n      !isTabbableRadio(node as HTMLInputElement)) ||\n    getTabindex(node) < 0\n  )\n\nconst isNodeMatchingSelectorFocusable = (node: HTMLElement) =>\n  !(\n    (node as HTMLInputElement).disabled ||\n    (isInput(node) && (node as HTMLInputElement).type === 'hidden') ||\n    // offsetParent being null will allow detecting cases where an element\n    // is invisible or inside an invisible element,  as long as the element\n    // does not use position: fixed. For them, their visibility has to be\n    // checked directly as well.\n    node.offsetParent === null ||\n    getComputedStyle(node).visibility === 'hidden'\n  )\n\nconst getTabindex = (node: HTMLElement) => {\n  const tabindexAttr = parseInt(node.getAttribute('tabindex') || '', 10)\n  if (!isNaN(tabindexAttr)) return tabindexAttr\n  // Browsers do not return `tabIndex` correctly for contentEditable nodes;\n  // so if they don't have a tabindex attribute specifically set, assume it's 0.\n  if (node.contentEditable === 'true') return 0\n  return node.tabIndex\n}\n\n// @ts-ignore\nconst sortOrderedTabbables = (a: Tabbables, b: Tabbables) =>\n  a.tabIndex === b.tabIndex\n    ? a.documentOrder - b.documentOrder\n    : a.tabIndex - b.tabIndex\n\nconst isInput = (node: HTMLElement) => node.tagName === 'INPUT'\n\nconst isTabbableRadio = (node: HTMLInputElement) => {\n  if (!node.name) return true\n  // This won't account for the edge case where you have radio groups with the\n  // same in separate forms on the same page.\n  if (node.ownerDocument) {\n    const radioSet = node.ownerDocument.querySelectorAll(\n      'input[type=\"radio\"][name=\"' + node.name + '\"]'\n    )\n\n    for (let i = 0; i < radioSet.length; i++)\n      if ((radioSet[i] as HTMLInputElement).checked) return radioSet[i] === node\n\n    return true\n  }\n\n  return false\n}\n\nexport default tabbable\n","import * as React from 'react'\n\nconst usePassiveLayoutEffect =\n  React[\n    typeof document !== 'undefined' && document.createElement !== void 0\n      ? 'useLayoutEffect'\n      : 'useEffect'\n  ]\n\nexport default usePassiveLayoutEffect\n","import * as React from 'react'\n\nconst useLatest = <T extends any>(current: T) => {\n  const storedValue = React.useRef(current)\n  storedValue.current = current\n  return storedValue\n}\n\nexport default useLatest\n","import * as React from 'react'\nimport useLayoutEffect from '@react-hook/passive-layout-effect'\nimport useLatest from '@react-hook/latest'\n\nfunction useEvent<\n  T extends Window = Window,\n  K extends keyof WindowEventMap = keyof WindowEventMap\n>(\n  target: Window | null,\n  type: K,\n  listener: WindowEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends Document = Document,\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n>(\n  target: Document | null,\n  type: K,\n  listener: DocumentEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends HTMLElement = HTMLElement,\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n>(\n  target: React.RefObject<T> | T | null,\n  type: K,\n  listener: ElementEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent(target: any, type: any, listener: any, cleanup: any): void {\n  const storedListener = useLatest(listener)\n  const storedCleanup = useLatest(cleanup)\n\n  useLayoutEffect(() => {\n    const targetEl = target && 'current' in target ? target.current : target\n    if (!targetEl) return\n\n    let didUnsubscribe = 0\n    function listener(this: any, ...args: any[]) {\n      if (didUnsubscribe) return\n      storedListener.current.apply(this, args)\n    }\n\n    targetEl.addEventListener(type, listener)\n    const cleanup = storedCleanup.current\n\n    return () => {\n      didUnsubscribe = 1\n      targetEl.removeEventListener(type, listener)\n      cleanup && cleanup()\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [target, type])\n}\n\nexport type ElementEventListener<\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n> = (this: HTMLElement, ev: HTMLElementEventMap[K]) => any\n\nexport type DocumentEventListener<\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n> = (this: Document, ev: DocumentEventMap[K]) => any\n\nexport type WindowEventListener<\n  K extends keyof WindowEventMap = keyof WindowEventMap\n> = (this: Document, ev: WindowEventMap[K]) => any\n\nexport default useEvent\n","import * as React from 'react'\nimport tabbable from '@accessible/tabbable'\nimport useEvent from '@react-hook/event'\n\nfunction useConditionalFocus<T extends Window>(\n  target: T | null,\n  shouldFocus?: boolean,\n  options?: UseConditionalFocusOptions\n): void\nfunction useConditionalFocus<T extends Document>(\n  target: T | null,\n  shouldFocus?: boolean,\n  options?: UseConditionalFocusOptions\n): void\nfunction useConditionalFocus<T extends HTMLElement>(\n  target: React.RefObject<T> | T | null,\n  shouldFocus?: boolean,\n  options?: UseConditionalFocusOptions\n): void\nfunction useConditionalFocus(\n  target: any,\n  shouldFocus = false,\n  {includeRoot, preventScroll} = defaultOptions\n) {\n  const didFocus = React.useRef(false)\n  const didFocusAfterEvent = React.useRef(false)\n\n  React.useEffect(() => {\n    const element = target && 'current' in target ? target.current : target\n    if (!element || !shouldFocus || didFocus.current) return\n    const tabbableEls = tabbable(element, includeRoot)\n    if (tabbableEls.length > 0) tabbableEls[0].focus({preventScroll})\n    didFocus.current = true\n  }, [target, includeRoot, preventScroll, shouldFocus])\n\n  React.useEffect(() => {\n    return () => {\n      didFocus.current = false\n      didFocusAfterEvent.current = false\n    }\n  }, [shouldFocus])\n\n  useEvent(target, 'transitionend', () => {\n    const element = target && 'current' in target ? target.current : target\n    if (!element || !shouldFocus || didFocusAfterEvent.current) return\n    const tabbableEls = tabbable(element, includeRoot)\n    if (tabbableEls.length > 0) tabbableEls[0].focus({preventScroll})\n    didFocusAfterEvent.current = true\n  })\n}\n\nconst defaultOptions: UseConditionalFocusOptions = {\n  includeRoot: false,\n  preventScroll: false,\n}\n\nexport type UseConditionalFocusOptions = {\n  includeRoot?: boolean\n  preventScroll?: boolean\n}\n\nexport default useConditionalFocus\n"],"names":["candidateSelector","matches","Element","prototype","msMatchesSelector","webkitMatchesSelector","a","node","tabbable","el","includeRootNode","regularTabbables","orderedTabbables","candidates","querySelectorAll","call","Array","slice","apply","unshift","i","candidate","candidateTabindex","length","isNodeMatchingSelectorTabbable","getTabindex","push","documentOrder","tabIndex","sort","sortOrderedTabbables","map","concat","isNodeMatchingSelectorFocusable","tagName","type","isTabbableRadio","disabled","isInput","offsetParent","getComputedStyle","visibility","tabindexAttr","parseInt","getAttribute","isNaN","contentEditable","b","name","ownerDocument","radioSet","checked","usePassiveLayoutEffect","React","document","createElement","useLatest","current","storedValue","useEvent","target","listener","cleanup","storedListener","storedCleanup","useLayoutEffect","targetEl","didUnsubscribe","args","addEventListener","removeEventListener","useConditionalFocus","shouldFocus","defaultOptions","includeRoot","preventScroll","didFocus","didFocusAfterEvent","element","tabbableEls","focus"],"mappings":"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"}
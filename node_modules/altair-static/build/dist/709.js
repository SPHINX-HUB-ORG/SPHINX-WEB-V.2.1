"use strict";(self.webpackChunkaltair_app=self.webpackChunkaltair_app||[]).push([[709],{71709:(J,O,l)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.GraphQLWsSubscriptionProvider=void 0;const n=l(71251),i=l(52999),p=l(41104);O.GraphQLWsSubscriptionProvider=class extends n.SubscriptionProvider{createClient(){this.client=p.createClient({url:this.subscriptionUrl,connectionParams:this.connectionParams,on:{connected:()=>{var f,e;null==(e=null==(f=this.extraOptions)?void 0:f.onConnected)||e.call(f,void 0,void 0)},error:f=>{var e,r;null==(r=null==(e=this.extraOptions)?void 0:e.onConnected)||r.call(e,f,void 0)}}})}execute(f){if(this.createClient(),!this.client)throw new Error("Could not create subscription client!");return new i.Observable(e=>this.client.subscribe({query:f.query,variables:f.variables,operationName:f.operationName},{next:(...r)=>e.next(...r),error:(...r)=>e.error(...r),complete:()=>e.complete()}))}close(){var f;null==(f=this.client)||f.dispose(),this.client=void 0}}},41104:function(J,O,l){var n=this&&this.__createBinding||(Object.create?function(p,b,h,f){void 0===f&&(f=h),Object.defineProperty(p,f,{enumerable:!0,get:function(){return b[h]}})}:function(p,b,h,f){void 0===f&&(f=h),p[f]=b[h]}),i=this&&this.__exportStar||function(p,b){for(var h in p)"default"!==h&&!Object.prototype.hasOwnProperty.call(b,h)&&n(b,p,h)};Object.defineProperty(O,"__esModule",{value:!0}),i(l(15917),O),i(l(53876),O),i(l(58394),O)},15917:(J,O,l)=>{l.r(O),l.d(O,{GRAPHQL_TRANSPORT_WS_PROTOCOL:()=>i.GRAPHQL_TRANSPORT_WS_PROTOCOL,MessageType:()=>i.MessageType,isMessage:()=>i.isMessage,parseMessage:()=>i.parseMessage,stringifyMessage:()=>i.stringifyMessage,createClient:()=>b});var n=l(8239),i=l(58394),p=l(18458);function b(e){const{url:r,connectionParams:u,lazy:x=!0,onNonLazyError:X=console.error,lazyCloseTimeout:T=0,keepAlive:N=0,disablePong:W,retryAttempts:j=5,retryWait:z=function(){var o=(0,n.Z)(function*(d){let a=1e3;for(let y=0;y<d;y++)a*=2;yield new Promise(y=>setTimeout(y,a+Math.floor(2700*Math.random()+300)))});return function(d){return o.apply(this,arguments)}}(),isFatalConnectionProblem:D=(o=>!h(o)),on:t,webSocketImpl:I,generateID:B=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,g=>{const d=16*Math.random()|0;return("x"==g?d:3&d|8).toString(16)})},jsonMessageReplacer:Q,jsonMessageReviver:H}=e;let K;if(I){if(!function(e){return"function"==typeof e&&"constructor"in e&&"CLOSED"in e&&"CLOSING"in e&&"CONNECTING"in e&&"OPEN"in e}(I))throw new Error("Invalid WebSocket implementation provided");K=I}else"undefined"!=typeof WebSocket?K=WebSocket:"undefined"!=typeof global?K=global.WebSocket||global.MozWebSocket:"undefined"!=typeof window&&(K=window.WebSocket||window.MozWebSocket);if(!K)throw new Error("WebSocket implementation missing");const Z=K,E=(()=>{const o=(()=>{const d={};return{on:(a,y)=>(d[a]=y,()=>{delete d[a]}),emit(a){var y;"id"in a&&(null===(y=d[a.id])||void 0===y||y.call(d,a))}}})(),g={connecting:(null==t?void 0:t.connecting)?[t.connecting]:[],connected:(null==t?void 0:t.connected)?[t.connected]:[],ping:(null==t?void 0:t.ping)?[t.ping]:[],pong:(null==t?void 0:t.pong)?[t.pong]:[],message:(null==t?void 0:t.message)?[o.emit,t.message]:[o.emit],closed:(null==t?void 0:t.closed)?[t.closed]:[],error:(null==t?void 0:t.error)?[t.error]:[]};return{onMessage:o.on,on(d,a){const y=g[d];return y.push(a),()=>{y.splice(y.indexOf(a),1)}},emit(d,...a){for(const y of g[d])y(...a)}}})();let w,S=0,Y=!1,k=0,v=!1;function ee(){return c.apply(this,arguments)}function c(){return(c=(0,n.Z)(function*(){const[o,g]=yield null!=w?w:w=new Promise((y,L)=>(0,n.Z)(function*(){if(Y){if(yield z(k),!S)return w=void 0,L({code:1e3,reason:"All Subscriptions Gone"});k++}E.emit("connecting");const s=new Z("function"==typeof r?yield r():r,i.GRAPHQL_TRANSPORT_WS_PROTOCOL);let G;function U(){isFinite(N)&&N>0&&(clearTimeout(G),G=setTimeout(()=>{s.readyState===Z.OPEN&&(s.send((0,i.stringifyMessage)({type:i.MessageType.Ping})),E.emit("ping",!1,void 0))},N))}s.onerror=P=>{E.emit("error",P)},s.onclose=P=>{w=void 0,clearTimeout(G),E.emit("closed",P),L(P)},s.onopen=(0,n.Z)(function*(){try{s.send((0,i.stringifyMessage)({type:i.MessageType.ConnectionInit,payload:"function"==typeof u?yield u():u},Q)),U()}catch(P){s.close(4400,P instanceof Error?P.message:new Error(P).message)}});let _=!1;s.onmessage=({data:P})=>{try{const m=(0,i.parseMessage)(P,H);if(E.emit("message",m),"ping"===m.type||"pong"===m.type)return E.emit(m.type,!0,m.payload),void("pong"===m.type?U():W||(s.send((0,i.stringifyMessage)(m.payload?{type:i.MessageType.Pong,payload:m.payload}:{type:i.MessageType.Pong})),E.emit("pong",!1,m.payload)));if(_)return;if(m.type!==i.MessageType.ConnectionAck)throw new Error(`First message cannot be of type ${m.type}`);_=!0,E.emit("connected",s,m.payload),Y=!1,k=0,y([s,new Promise((M,$)=>s.addEventListener("close",$))])}catch(m){s.close(4400,m instanceof Error?m.message:new Error(m).message)}}})());o.readyState===Z.CLOSING&&(yield g);let d=()=>{};const a=new Promise(y=>d=y);return[o,d,Promise.race([a.then(()=>{if(!S){const y=()=>o.close(1e3,"Normal Closure");isFinite(T)&&T>0?setTimeout(()=>{!S&&o.readyState===Z.OPEN&&y()},T):y()}}),g])]})).apply(this,arguments)}function q(o){if(h(o)&&[1002,1011,4400,4401,4409,4429].includes(o.code))throw o;if(v)return!1;if(h(o)&&1e3===o.code)return S>0;if(!j||k>=j||D(o))throw o;return Y=!0}return x||(0,n.Z)(function*(){for(S++;;)try{const[,,o]=yield ee();yield o}catch(o){try{if(!q(o))return}catch(g){return null==X?void 0:X(g)}}})(),{on:E.on,subscribe(o,g){const d=B();let a=!1,y=!1,L=()=>{S--,a=!0};return(0,n.Z)(function*(){for(S++;;)try{const[s,G,U]=yield ee();if(a)return G();const _=E.onMessage(d,P=>{switch(P.type){case i.MessageType.Next:return void g.next(P.payload);case i.MessageType.Error:return y=!0,a=!0,g.error(P.payload),void L();case i.MessageType.Complete:return a=!0,void L()}});return s.send((0,i.stringifyMessage)({id:d,type:i.MessageType.Subscribe,payload:o},Q)),L=()=>{!a&&s.readyState===Z.OPEN&&s.send((0,i.stringifyMessage)({id:d,type:i.MessageType.Complete},Q)),S--,a=!0,G()},void(yield U.finally(_))}catch(s){if(!q(s))return}})().catch(g.error).then(()=>{y||g.complete()}),()=>{a||L()}},dispose:()=>(0,n.Z)(function*(){if(v=!0,w){const[o]=yield w;o.close(1e3,"Normal Closure")}})()}}function h(e){return(0,p.Kn)(e)&&"code"in e&&"reason"in e}},58394:(J,O,l)=>{l.r(O),l.d(O,{GRAPHQL_TRANSPORT_WS_PROTOCOL:()=>i,MessageType:()=>p,isMessage:()=>b,parseMessage:()=>h,stringifyMessage:()=>f});var n=l(18458);const i="graphql-transport-ws";var p=(()=>{return(e=p||(p={})).ConnectionInit="connection_init",e.ConnectionAck="connection_ack",e.Ping="ping",e.Pong="pong",e.Subscribe="subscribe",e.Next="next",e.Error="error",e.Complete="complete",p;var e})();function b(e){if((0,n.Kn)(e)){if(!(0,n.ND)(e,"type"))return!1;switch(e.type){case p.ConnectionInit:return!(0,n.nr)(e,"payload")||void 0===e.payload||(0,n.Kn)(e.payload);case p.ConnectionAck:case p.Ping:case p.Pong:return!(0,n.nr)(e,"payload")||void 0===e.payload||(0,n.Kn)(e.payload);case p.Subscribe:return(0,n.ND)(e,"id")&&(0,n.O2)(e,"payload")&&(!(0,n.nr)(e.payload,"operationName")||null==e.payload.operationName||"string"==typeof e.payload.operationName)&&(0,n.ND)(e.payload,"query")&&(!(0,n.nr)(e.payload,"variables")||null==e.payload.variables||(0,n.O2)(e.payload,"variables"))&&(!(0,n.nr)(e.payload,"extensions")||null==e.payload.extensions||(0,n.O2)(e.payload,"extensions"));case p.Next:return(0,n.ND)(e,"id")&&(0,n.O2)(e,"payload");case p.Error:return(0,n.ND)(e,"id")&&(0,n.Ox)(e.payload);case p.Complete:return(0,n.ND)(e,"id");default:return!1}}return!1}function h(e,r){if(b(e))return e;if("string"!=typeof e)throw new Error("Message not parsable");const u=JSON.parse(e,r);if(!b(u))throw new Error("Invalid message");return u}function f(e,r){if(!b(e))throw new Error("Cannot stringify invalid message");return JSON.stringify(e,r)}},53876:(J,O,l)=>{l.r(O),l.d(O,{makeServer:()=>X});var n=l(8239),i=l(51724),p=l(48682),b=l(69251),h=l(89790),f=l(86403),e=l(98001),r=l(58394),u=l(18458);function X(T){const{schema:N,context:W,roots:j,validate:z,execute:D,subscribe:t,connectionInitWaitTimeout:I=3e3,onConnect:B,onDisconnect:Q,onClose:H,onSubscribe:K,onOperation:Z,onNext:E,onError:w,onComplete:S,jsonMessageReviver:Y,jsonMessageReplacer:k}=T;return{opened(v,ee){const c={connectionInitReceived:!1,acknowledged:!1,subscriptions:{},extra:ee};if(v.protocol!==r.GRAPHQL_TRANSPORT_WS_PROTOCOL)return v.close(1002,"Protocol Error"),function(){var o=(0,n.Z)(function*(g,d){yield null==H?void 0:H(c,g,d)});return function(g,d){return o.apply(this,arguments)}}();const q=I>0&&isFinite(I)?setTimeout(()=>{c.connectionInitReceived||v.close(4408,"Connection initialisation timeout")},I):null;return v.onMessage(function(){var o=(0,n.Z)(function*(d){var a,y,L;let s;try{s=(0,r.parseMessage)(d,Y)}catch(_){return v.close(4400,"Invalid message received")}switch(s.type){case r.MessageType.ConnectionInit:{if(c.connectionInitReceived)return v.close(4429,"Too many initialisation requests");c.connectionInitReceived=!0,(0,u.Kn)(s.payload)&&(c.connectionParams=s.payload);const _=yield null==B?void 0:B(c);return!1===_?v.close(4403,"Forbidden"):(yield v.send((0,r.stringifyMessage)((0,u.Kn)(_)?{type:r.MessageType.ConnectionAck,payload:_}:{type:r.MessageType.ConnectionAck},k)),void(c.acknowledged=!0))}case r.MessageType.Ping:return void(yield v.send((0,r.stringifyMessage)(s.payload?{type:r.MessageType.Pong,payload:s.payload}:{type:r.MessageType.Pong})));case r.MessageType.Pong:return;case r.MessageType.Subscribe:{if(!c.acknowledged)return v.close(4401,"Unauthorized");const{id:_,payload:P}=s;if(_ in c.subscriptions)return v.close(4409,`Subscriber for ${_} already exists`);c.subscriptions[_]=null;const m={next:(A=(0,n.Z)(function*(C,R){let V={id:_,type:r.MessageType.Next,payload:C};const re=yield null==E?void 0:E(c,V,R,C);re&&(V=Object.assign(Object.assign({},V),{payload:re})),yield v.send((0,r.stringifyMessage)(V,k))}),function(R,V){return A.apply(this,arguments)}),error:function(){var A=(0,n.Z)(function*(C){let R={id:_,type:r.MessageType.Error,payload:C};const V=yield null==w?void 0:w(c,R,C);V&&(R=Object.assign(Object.assign({},R),{payload:V})),yield v.send((0,r.stringifyMessage)(R,k))});return function(R){return A.apply(this,arguments)}}(),complete:function(){var A=(0,n.Z)(function*(C){const R={id:_,type:r.MessageType.Complete};yield null==S?void 0:S(c,R),C&&(yield v.send((0,r.stringifyMessage)(R,k)))});return function(R){return A.apply(this,arguments)}}()};let M;const $=yield null==K?void 0:K(c,s);if($){if((0,u.Ox)($))return yield m.error($);if(Array.isArray($))throw new Error("Invalid return value from onSubscribe hook, expected an array of GraphQLError objects");M=$}else{if(!N)throw new Error("The GraphQL schema is not provided");const A={operationName:P.operationName,document:(0,i.Qc)(P.query),variableValues:P.variables};M=Object.assign(Object.assign({},A),{schema:"function"==typeof N?yield N(c,s,A):N});const C=(null!=z?z:p.Gu)(M.schema,M.document);if(C.length>0)return yield m.error(C)}const ne=(0,b.getOperationAST)(M.document,M.operationName);if(!ne)return yield m.error([new h._("Unable to identify operation")]);let F;"rootValue"in M||(M.rootValue=null==j?void 0:j[ne.operation]),"contextValue"in M||(M.contextValue="function"==typeof W?yield W(c,s,M):W),F="subscription"===ne.operation?yield(null!=t?t:f.L)(M):yield(null!=D?D:e.ht)(M);const te=yield null==Z?void 0:Z(c,s,M,F);if(te&&(F=te),(0,u.D0)(F))if(_ in c.subscriptions){c.subscriptions[_]=F;try{for(var U,G=function(T){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var W,N=T[Symbol.asyncIterator];return N?N.call(T):(T="function"==typeof __values?__values(T):T[Symbol.iterator](),W={},j("next"),j("throw"),j("return"),W[Symbol.asyncIterator]=function(){return this},W);function j(D){W[D]=T[D]&&function(t){return new Promise(function(I,B){!function(D,t,I,B){Promise.resolve(B).then(function(Q){D({value:Q,done:I})},t)}(I,B,(t=T[D](t)).done,t.value)})}}}(F);!(U=yield G.next()).done;){const A=U.value;yield m.next(A,M)}}catch(A){a={error:A}}finally{try{U&&!U.done&&(y=G.return)&&(yield y.call(G))}finally{if(a)throw a.error}}}else F.return();else _ in c.subscriptions&&(yield m.next(F,M));return yield m.complete(_ in c.subscriptions),void delete c.subscriptions[_]}case r.MessageType.Complete:return yield null===(L=c.subscriptions[s.id])||void 0===L?void 0:L.return(),void delete c.subscriptions[s.id];default:throw new Error(`Unexpected message of type ${s.type} received`)}var A});return function(d){return o.apply(this,arguments)}}()),function(){var o=(0,n.Z)(function*(g,d){q&&clearTimeout(q);for(const a of Object.values(c.subscriptions))yield null==a?void 0:a.return();c.acknowledged&&(yield null==Q?void 0:Q(c,g,d)),yield null==H?void 0:H(c,g,d)});return function(g,d){return o.apply(this,arguments)}}()}}}},18458:(J,O,l)=>{l.d(O,{Kn:()=>i,D0:()=>p,Ox:()=>b,nr:()=>h,O2:()=>f,ND:()=>r});const n=Object.prototype.hasOwnProperty;function i(u){return"object"==typeof u&&null!==u}function p(u){return"function"==typeof Object(u)[Symbol.asyncIterator]}function b(u){return Array.isArray(u)&&u.length>0&&u.every(x=>"message"in x)}function h(u,x){return n.call(u,x)}function f(u,x){return n.call(u,x)&&i(u[x])}function r(u,x){return n.call(u,x)&&"string"==typeof u[x]}}}]);
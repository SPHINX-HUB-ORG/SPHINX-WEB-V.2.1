"use strict";(self.webpackChunkaltair=self.webpackChunkaltair||[]).push([[810],{79810:(ie,J,R)=>{R.r(J),R.d(J,{GraphQLSSESubscriptionProvider:()=>re});var L=R(15861),$=R(69972),B=R(16922);const V="x-graphql-event-stream-token";function H(e){if("next"!==e&&"complete"!==e)throw new Error(`Invalid stream event "${e}"`);return e}function W(e,t){if(t)try{t=JSON.parse(t)}catch{throw new Error("Invalid stream data")}if("next"===e&&!t)throw new Error('Stream data must be an object for "next" events');return t||null}var O=(()=>{return(e=O||(O={}))[e.NewLine=10]="NewLine",e[e.CchunkiageReturn=13]="CchunkiageReturn",e[e.Space=32]="Space",e[e.Colon=58]="Colon",O;var e})();function X(){let e,t,n,f=!1,s={event:"",data:""},y=[];const w=new TextDecoder;return function(b){if(void 0===e)e=b,t=0,n=-1;else{const l=new Uint8Array(e.length+b.length);l.set(e),l.set(b,e.length),e=l}const v=e.length;let h=0;for(;t<v;){f&&(e[t]===O.NewLine&&(h=++t),f=!1);let l=-1;for(;t<v&&-1===l;++t)switch(e[t]){case O.Colon:-1===n&&(n=t-h);break;case O.CchunkiageReturn:f=!0;case O.NewLine:l=t}if(-1===l)break;if(h===l){if(s.event||s.data){if(!s.event)throw new Error("Missing message event");const r=H(s.event),o=W(r,s.data);y.push({event:r,data:o}),s={event:"",data:""}}}else if(n>0){const r=e.subarray(h,l),o=w.decode(r.subarray(0,n)),x=w.decode(r.subarray(n+(r[n+1]===O.Space?2:1)));switch(o){case"event":s.event=x;break;case"data":s.data=s.data?s.data+"\n"+x:x}}h=t,n=-1}if(h===v){e=void 0;const l=[...y];return y=[],l}0!==h&&(e=e.subarray(h),t-=h)}}var K=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),n={},f("next"),f("throw"),f("return"),n[Symbol.asyncIterator]=function(){return this},n);function f(y){n[y]=e[y]&&function(w){return new Promise(function(m,b){!function s(y,w,m,b){Promise.resolve(b).then(function(v){y({value:v,done:m})},w)}(m,b,(w=e[y](w)).done,w.value)})}}},Z=function(e){return this instanceof Z?(this.v=e,this):new Z(e)},Q=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,f=n.apply(e,t||[]),y=[];return s={},w("next"),w("throw"),w("return"),s[Symbol.asyncIterator]=function(){return this},s;function w(r){f[r]&&(s[r]=function(o){return new Promise(function(u,x){y.push([r,o,u,x])>1||m(r,o)})})}function m(r,o){try{!function b(r){r.value instanceof Z?Promise.resolve(r.value.v).then(v,h):l(y[0][2],r)}(f[r](o))}catch(u){l(y[0][3],u)}}function v(r){m("next",r)}function h(r){m("throw",r)}function l(r,o){r(o),y.shift(),y.length&&m(y[0][0],y[0][1])}};class I extends Error{constructor(t){let n,f;!function te(e){return function q(e){return"object"==typeof e&&null!==e}(e)&&"boolean"==typeof e.ok&&"number"==typeof e.status&&"string"==typeof e.statusText}(t)?n=t instanceof Error?t.message:String(t):(f=t,n="Server responded with "+t.status+": "+t.statusText),super(n),this.name=this.constructor.name,this.response=f}}function Y(e){return z.apply(this,arguments)}function z(){return z=(0,L.Z)(function*(e){const{signal:t,url:n,credentials:f,headers:s,body:y,fetchFn:w,onMessage:m}=e,b={},v={};let h;try{h=yield w(n,{signal:t,method:y?"POST":"GET",credentials:f,headers:Object.assign(Object.assign({},s),{accept:"text/event-stream"}),body:y})}catch(o){throw new I(o)}if(!h.ok)throw new I(h);if(!h.body)throw new Error("Missing response body");let r,l=null;return(0,L.Z)(function*(){var o,u,x;try{const E=X();try{for(var p,g=K(ne(h.body));!(p=yield g.next()).done;){const S=p.value;if("string"==typeof S)throw new Error(`Unexpected string chunk "${S}"`);const a=E(S);if(a)for(const c of a){m?.(c);const i=c.data&&"id"in c.data?c.data.id:"";switch(i in v||(v[i]=[]),c.event){case"next":v[i].push(i?c.data.payload:c.data);break;case"complete":v[i].push("complete");break;default:throw new Error(`Unexpected message event "${c.event}"`)}null===(x=b[i])||void 0===x||x.proceed()}}}catch(S){o={error:S}}finally{try{p&&!p.done&&(u=g.return)&&(yield u.call(g))}finally{if(o)throw o.error}}}catch(E){l=/network|stream/i.test(E)?new I(E):E,r?.(l)}finally{Object.values(b).forEach(({proceed:E})=>E())}})(),{url:n,headers:s,waitForThrow:()=>new Promise((o,u)=>{if(l)return u(l);r=u}),getResults(o){var u;return Q(this,arguments,function*(){const{signal:g,operationId:p=""}=o??{};try{for(;;){for(;null!==(u=v[p])&&void 0!==u&&u.length;){const E=v[p].shift();if("complete"===E)return yield Z(void 0);yield yield Z(E)}if(l)throw l;if(g?.aborted)throw new Error("Getting results aborted by the client");yield Z(new Promise(E=>{const S=()=>{g?.removeEventListener("abort",S),delete b[p],E()};g?.addEventListener("abort",S),b[p]={proceed:S}}))}}finally{delete v[p]}})}}}),z.apply(this,arguments)}function ne(e){return"function"==typeof Object(e)[Symbol.asyncIterator]?e[Symbol.asyncIterator]():function(){return Q(this,arguments,function*(){const t=e.getReader();let n;do{n=yield Z(t.read()),void 0!==n.value&&(yield yield Z(n.value))}while(!n.done)})}()}class re extends $.q{createClient(){this.client=function ee(e){const{singleConnection:t=!1,lazy:n=!0,lazyCloseTimeout:f=0,onNonLazyError:s=console.error,generateID:y=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,c=>{const i=16*Math.random()|0;return("x"==c?i:3&i|8).toString(16)})},retryAttempts:w=5,retry:m=function(){var a=(0,L.Z)(function*(i){let D=1e3;for(let d=0;d<i;d++)D*=2;yield new Promise(d=>setTimeout(d,D+Math.floor(2700*Math.random()+300)))});return function c(i){return a.apply(this,arguments)}}(),credentials:b="same-origin",onMessage:v}=e,h=e.fetchFn||fetch,l=e.abortControllerImpl||AbortController,r=(()=>{let a=!1;const c=[];return{get disposed(){return a},onDispose:i=>a?(setTimeout(()=>i(),0),()=>{}):(c.push(i),()=>{c.splice(c.indexOf(i),1)}),dispose(){if(!a){a=!0;for(const i of[...c])i()}}}})();let o,u,x=0,g=null,p=0;function E(){return S.apply(this,arguments)}function S(){return(S=(0,L.Z)(function*(){try{if(r.disposed)throw new Error("Client has been disposed");return yield u??(u=(0,L.Z)(function*(){var a;if(g){if(yield m(p),o.signal.aborted)throw new Error("Connection aborted by the client");p++}o=new l;const c=r.onDispose(()=>o.abort());o.signal.addEventListener("abort",()=>{c(),u=void 0});const i="function"==typeof e.url?yield e.url():e.url;if(o.signal.aborted)throw new Error("Connection aborted by the client");const D="function"==typeof e.headers?yield e.headers():null!==(a=e.headers)&&void 0!==a?a:{};if(o.signal.aborted)throw new Error("Connection aborted by the client");let d;try{d=yield h(i,{signal:o.signal,method:"PUT",credentials:b,headers:D})}catch(C){throw new I(C)}if(201!==d.status)throw new I(d);const G=yield d.text();D[V]=G;const T=yield Y({signal:o.signal,headers:D,credentials:b,url:i,fetchFn:h,onMessage:v});return g=null,p=0,T.waitForThrow().catch(()=>u=void 0),T})())}catch(a){throw u=void 0,a}})).apply(this,arguments)}return t&&!n&&(0,L.Z)(function*(){for(x++;;)try{const{waitForThrow:a}=yield E();yield a()}catch(a){if(r.disposed)return;if(!(a instanceof I)||(u=void 0,!w||p>=w))return s?.(a);g=a}})(),{subscribe(a,c){if(!t){const d=new l,G=r.onDispose(()=>{G(),d.abort()});return(0,L.Z)(function*(){var T,C,U;let P=null,k=0;for(;;)try{if(P){if(yield m(k),d.signal.aborted)throw new Error("Connection aborted by the client");k++}const N="function"==typeof e.url?yield e.url():e.url;if(d.signal.aborted)throw new Error("Connection aborted by the client");const j="function"==typeof e.headers?yield e.headers():null!==(U=e.headers)&&void 0!==U?U:{};if(d.signal.aborted)throw new Error("Connection aborted by the client");const{getResults:A}=yield Y({signal:d.signal,headers:j,credentials:b,url:N,body:JSON.stringify(a),fetchFn:h,onMessage:v});P=null,k=0;try{for(var _,M=(T=void 0,K(A()));!(_=yield M.next()).done;)c.next(_.value)}catch(F){T={error:F}}finally{try{_&&!_.done&&(C=M.return)&&(yield C.call(M))}finally{if(T)throw T.error}}return d.abort()}catch(N){if(d.signal.aborted)return;if(!(N instanceof I)||!w||k>=w)throw N;P=N}})().then(()=>c.complete()).catch(T=>c.error(T)),()=>d.abort()}x++;const i=new l,D=r.onDispose(()=>{D(),i.abort()});return(0,L.Z)(function*(){var d,G;const T=y();a=Object.assign(Object.assign({},a),{extensions:Object.assign(Object.assign({},a.extensions),{operationId:T})});let C=null;for(;;){C=null;try{const{url:k,headers:M,getResults:_}=yield E();let N;try{N=yield h(k,{signal:i.signal,method:"POST",credentials:b,headers:M,body:JSON.stringify(a)})}catch(j){throw new I(j)}if(202!==N.status)throw new I(N);C=function(){var j=(0,L.Z)(function*(){let A;try{const F=new l,oe=r.onDispose(()=>{oe(),F.abort()});A=yield h(k+"?operationId="+T,{signal:F.signal,method:"DELETE",credentials:b,headers:M})}catch(F){throw new I(F)}if(200!==A.status)throw new I(A)});return function(){return j.apply(this,arguments)}}();try{for(var P,U=(d=void 0,K(_({signal:i.signal,operationId:T})));!(P=yield U.next()).done;)c.next(P.value)}catch(j){d={error:j}}finally{try{P&&!P.done&&(G=U.return)&&(yield G.call(U))}finally{if(d)throw d.error}}return C=null,i.abort()}catch(k){if(i.signal.aborted)return yield C?.();if(!(k instanceof I)||(n&&(u=void 0),!w||p>=w))throw k;g=k}finally{i.signal.aborted&&0==--x&&(isFinite(f)&&f>0?setTimeout(()=>{x||o.abort()},f):o.abort())}}})().then(()=>c.complete()).catch(d=>c.error(d)),()=>i.abort()},dispose(){r.dispose()}}}({url:this.subscriptionUrl,headers:this.extraOptions.headers})}execute(t){if(this.createClient(),!this.client)throw new Error("Could not create subscription client!");return new B.y(n=>{this.cleanup=this.client.subscribe({query:t.query,variables:t.variables,operationName:t.operationName},{next:(...f)=>n.next(...f),error:(...f)=>n.error(...f),complete:()=>n.complete()})})}close(){var t=this;return(0,L.Z)(function*(){try{t.cleanup?.(),t.cleanup=void 0,yield t.client?.dispose(),t.client=void 0}catch(n){console.error(n)}})()}}}}]);